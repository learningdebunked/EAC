2025-10-26 00:07:58,220 - EACAgent - INFO - Initializing EAC Agent modules...
2025-10-26 00:07:58,220 - EACAgent.Data.SDOH - WARNING - Using synthetic SDOH data - replace with real data in production
2025-10-26 00:07:58,220 - EACAgent.Data.SDOH - INFO - SDOH Data loaded: 0 census tracts
2025-10-26 00:07:58,220 - EACAgent.Data.Products - WARNING - Using synthetic product data - replace with real data in production
2025-10-26 00:07:58,220 - EACAgent.Data.Products - INFO - Product data loaded: 0 products
2025-10-26 00:07:58,220 - EACAgent.Perception - INFO - Perception Module initialized
2025-10-26 00:07:58,233 - EACAgent.Reasoning - INFO - Reasoning Module initialized with 5 policies
2025-10-26 00:07:58,233 - EACAgent.Data.Products - WARNING - Using synthetic product data - replace with real data in production
2025-10-26 00:07:58,233 - EACAgent.Data.Products - INFO - Product data loaded: 0 products
2025-10-26 00:07:58,233 - EACAgent.Action - INFO - Action Module initialized with 5 policies
2025-10-26 00:07:58,233 - EACAgent.Learning - INFO - Learning Module initialized
2025-10-26 00:07:58,233 - EACAgent.Guardrails - INFO - Guardrail System initialized
2025-10-26 00:07:58,233 - EACAgent - INFO - EAC Agent initialized: EAC-Agent-v1
2025-10-26 00:07:58,262 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,272 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,273 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,274 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,275 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,275 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,276 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,278 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,278 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,279 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,280 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,281 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,282 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,283 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,283 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,284 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,285 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,286 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,287 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,287 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,288 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,289 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,290 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,291 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,292 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,293 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,293 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,294 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,295 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,295 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,296 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,297 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,298 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,299 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,299 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,300 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,301 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,302 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,302 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,303 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,304 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,304 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,305 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,306 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,307 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,308 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,308 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,309 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,310 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,311 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,312 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,312 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,313 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,314 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,314 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,315 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,316 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,317 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,318 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,318 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,319 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,320 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,321 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,322 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,322 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,323 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,324 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,324 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,325 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,326 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,327 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,327 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,328 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,329 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,329 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,330 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,331 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,332 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,333 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,333 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,334 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,335 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,336 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,336 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,337 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,338 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,338 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,339 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,340 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,340 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,341 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,342 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,343 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,343 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,344 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,345 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,346 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,347 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,347 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,348 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,349 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,350 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,351 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,352 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,353 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,353 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,354 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,355 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,355 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,356 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,357 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,358 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,358 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,359 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,360 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,361 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,362 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,362 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,363 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,364 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,364 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,365 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,366 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,366 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,367 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,368 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,369 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,369 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,370 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,371 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,371 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,372 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,373 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,373 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,374 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,375 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,376 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,376 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,377 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,378 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,379 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,379 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,380 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,381 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,381 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,382 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,383 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,383 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,384 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,385 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,386 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,386 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,387 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,388 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,389 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,389 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,390 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,391 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,391 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,392 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,393 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,394 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,394 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,395 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,396 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,397 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,398 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,398 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,399 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,399 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,400 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,401 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,402 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,403 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,403 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,404 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,404 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,405 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,406 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,407 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,408 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,408 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,409 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,410 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,411 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,412 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,412 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,413 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,414 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,414 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,415 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,416 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,416 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,417 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,419 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,419 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,420 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,421 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,422 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,423 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,424 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,424 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,425 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,426 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,427 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,428 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,428 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,429 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,429 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,430 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,431 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,432 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,433 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,433 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,434 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,435 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,435 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,436 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,437 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,438 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,438 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,439 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,440 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,440 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,441 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,442 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,443 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,444 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,444 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,445 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,446 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,446 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,447 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,448 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,449 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,449 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,450 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,451 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,452 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,453 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,454 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,454 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,455 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,456 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,456 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,457 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,458 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,458 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,459 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,460 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,460 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,461 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,462 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,463 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,463 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,464 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,465 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,465 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,466 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,467 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,468 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,469 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,469 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,470 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,471 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,472 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,473 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,473 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,474 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,474 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,475 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,476 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,477 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,478 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,478 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,479 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,480 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,480 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,481 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,482 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,483 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,483 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,484 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,485 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,485 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,486 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,487 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,487 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,488 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,489 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,489 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,490 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,491 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,491 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,492 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,493 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,494 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,494 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,495 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,496 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,497 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,498 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,499 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,499 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,500 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,501 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,501 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,502 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,503 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,504 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,504 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,505 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,506 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,507 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,508 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,508 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,509 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,509 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,510 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,511 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,512 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,512 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,513 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,514 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,514 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,515 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,516 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,517 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,518 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,518 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,519 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,520 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,520 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,521 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,522 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,523 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,523 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,524 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,524 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,525 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,526 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,527 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,527 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,528 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,529 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,530 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,530 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,531 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,532 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,533 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,533 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,534 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,534 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,535 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,536 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,537 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,538 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,539 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,539 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,540 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,541 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,542 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,543 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,543 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,544 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,544 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,545 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,546 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,547 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,547 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,548 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,549 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,549 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,550 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,550 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,551 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,552 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,553 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,554 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,554 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,555 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,556 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,557 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,557 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,558 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,559 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,560 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,560 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,561 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,562 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,563 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,563 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,564 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,564 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,565 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,566 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,567 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,568 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,568 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,569 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,570 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,571 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,572 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,572 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,573 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,574 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,574 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,575 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,576 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,576 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,577 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,578 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,578 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,579 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,579 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,580 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,581 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,582 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,583 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,583 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,584 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,585 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,585 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,586 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,587 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,588 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,588 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,589 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,589 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,590 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,591 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,591 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,593 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,593 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,594 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,594 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,595 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,596 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,597 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,598 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,598 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,599 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,599 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,600 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,601 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,602 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,603 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,603 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,604 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,604 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,605 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,606 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,606 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,607 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,608 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,608 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,609 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,610 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,610 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,611 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,612 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,613 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,613 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,614 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,615 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,615 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,616 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,617 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,618 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,618 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,619 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,620 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,620 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,621 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,622 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,623 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,623 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,624 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,624 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,625 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,626 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,627 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,628 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,628 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,629 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,629 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,630 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,631 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,631 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,632 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,633 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,634 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,634 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,635 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,636 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,637 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,638 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,638 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,639 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,639 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,640 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,641 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,642 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,643 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,643 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,644 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,645 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,645 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,646 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,647 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,648 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,648 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,649 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,649 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,650 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,651 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,652 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,653 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,653 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,654 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,654 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,655 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,656 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,656 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,658 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,665 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,668 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,670 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,671 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,674 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,676 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,678 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,679 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,681 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,682 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,684 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,685 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,687 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,689 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,692 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,693 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,695 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,696 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,698 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,699 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,701 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,703 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,704 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,705 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,706 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,706 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,707 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,708 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,709 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,710 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,710 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,711 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,712 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,715 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,716 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,718 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,721 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,722 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,724 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,724 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,725 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,725 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,726 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,727 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,728 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,729 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,729 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,730 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,731 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,731 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,732 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,733 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,734 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,734 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,735 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,735 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,736 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,737 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,738 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,739 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,739 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,740 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,740 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,741 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,742 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,743 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,744 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,744 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,745 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,745 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,746 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,747 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,748 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,749 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,749 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,750 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,751 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,751 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,752 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,753 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,754 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,754 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,755 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,756 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,756 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,757 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,758 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,759 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,759 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,760 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,760 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,761 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,762 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,763 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,764 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,764 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,765 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,765 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,766 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,767 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,768 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,769 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,769 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,770 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,770 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,771 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,772 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,772 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,773 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,774 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,775 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,775 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,776 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,777 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,777 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,778 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,779 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,779 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,780 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,781 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,781 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,782 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,783 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,784 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,784 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,785 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,786 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,786 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,787 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,788 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,789 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,789 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,790 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,790 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,791 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,792 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,793 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,794 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,794 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,795 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,795 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,796 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,797 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,798 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,798 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,799 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,799 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,800 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,801 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,801 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,802 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,803 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,804 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,804 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,805 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,805 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,806 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,807 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,808 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,809 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,809 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,810 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,811 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,811 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,812 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,813 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,814 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,814 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,815 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,816 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,816 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,817 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,818 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,819 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,819 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,820 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,821 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,822 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,823 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,823 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,824 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,825 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,825 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,826 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,827 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,828 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,828 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,829 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,830 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,830 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,831 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,832 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,832 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,833 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,834 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,835 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,835 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,836 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,836 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,837 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,838 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,838 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,839 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,840 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,840 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,841 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,842 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,842 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,843 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,844 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,845 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,845 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,846 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,847 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,847 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,848 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,849 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,850 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,850 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,851 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,852 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,853 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,853 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,854 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,855 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,855 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,856 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,857 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,857 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,858 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,859 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,859 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,860 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,861 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,861 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,862 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,863 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,864 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,864 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,865 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,866 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,866 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,867 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,868 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,868 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,869 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,870 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,870 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,871 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,872 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,872 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,873 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,874 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,874 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,875 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,876 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,876 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,877 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,878 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,879 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,879 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,880 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,880 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,881 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,882 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,882 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,884 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,884 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,885 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,886 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,887 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,887 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,888 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,889 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,889 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,890 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,891 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,891 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,892 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,893 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,894 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,894 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,895 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,895 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,896 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,897 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,898 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,899 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,899 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,900 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,901 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,901 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,902 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,903 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,903 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,904 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,905 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,905 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,906 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,907 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,907 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,908 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,909 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,909 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,910 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,910 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,911 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,912 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,913 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,913 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,914 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,915 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,915 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,916 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,917 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,917 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,918 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,919 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,919 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,920 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,921 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,921 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,922 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,923 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,923 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,924 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,925 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,925 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,926 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,927 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,928 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,928 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,929 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,930 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,930 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,931 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,932 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,932 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,933 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,934 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,934 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,935 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,936 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,936 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,937 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,938 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,939 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,939 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,940 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,940 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,941 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,942 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,943 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,944 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,944 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,945 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,946 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,946 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,947 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,948 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,949 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,949 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,950 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,950 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,951 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,952 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,952 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,953 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,954 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,954 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,955 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,955 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,956 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,957 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,958 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,959 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,959 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,960 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,961 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,961 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,962 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,963 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,964 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,964 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,965 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,965 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,966 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,967 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,968 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,969 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,969 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,970 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,970 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,971 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,972 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,972 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,973 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,973 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,974 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,975 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,975 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,976 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,977 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,977 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,978 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,979 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,979 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,980 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,981 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,981 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,982 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,983 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,984 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,984 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,985 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,986 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,986 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,987 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,988 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,989 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,989 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,990 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,991 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,991 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,992 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,993 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,993 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,994 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,995 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,995 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,996 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,997 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,997 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,998 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:58,999 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:59,000 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:59,000 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:59,001 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:59,002 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:59,002 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:59,003 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:59,004 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:59,004 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:59,005 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:59,005 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:59,006 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:59,007 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:59,007 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:59,008 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:59,009 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:59,009 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:59,010 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:59,010 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:59,011 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:59,012 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:59,012 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:59,013 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:59,014 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:59,015 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:59,015 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:59,016 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:59,016 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:59,017 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:59,018 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:59,018 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:59,019 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:59,020 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:59,020 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:59,021 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:59,022 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:59,022 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:59,023 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:59,024 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:59,024 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:07:59,025 - EACAgent - ERROR - Error processing checkout: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
Traceback (most recent call last):
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/agent.py", line 110, in process_checkout
    need_states = self.reasoning.infer_needs(context)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 256, in infer_needs
    predictions = self.need_state_model.predict_with_uncertainty(x, n_samples=10)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 77, in predict_with_uncertainty
    pred = self.forward(x)
  File "/Users/kapilsindhu/Documents/OpenSourcProjects/EAC/modules/reasoning.py", line 55, in forward
    shared_features = self.shared(x)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/container.py", line 244, in forward
    input = module(input)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2815, in batch_norm
    _verify_batch_size(input.size())
  File "/Users/kapilsindhu/Library/Python/3.9/lib/python/site-packages/torch/nn/functional.py", line 2781, in _verify_batch_size
    raise ValueError(
ValueError: Expected more than 1 value per channel when training, got input size torch.Size([1, 256])
2025-10-26 00:09:37,027 - EACAgent - INFO - Initializing EAC Agent modules...
2025-10-26 00:09:37,027 - EACAgent.Data.SDOH - WARNING - Using synthetic SDOH data - replace with real data in production
2025-10-26 00:09:37,027 - EACAgent.Data.SDOH - INFO - SDOH Data loaded: 0 census tracts
2025-10-26 00:09:37,027 - EACAgent.Data.Products - WARNING - Using synthetic product data - replace with real data in production
2025-10-26 00:09:37,027 - EACAgent.Data.Products - INFO - Product data loaded: 0 products
2025-10-26 00:09:37,027 - EACAgent.Perception - INFO - Perception Module initialized
2025-10-26 00:09:37,029 - EACAgent.Reasoning - INFO - Reasoning Module initialized with 5 policies
2025-10-26 00:09:37,029 - EACAgent.Data.Products - WARNING - Using synthetic product data - replace with real data in production
2025-10-26 00:09:37,029 - EACAgent.Data.Products - INFO - Product data loaded: 0 products
2025-10-26 00:09:37,029 - EACAgent.Action - INFO - Action Module initialized with 5 policies
2025-10-26 00:09:37,029 - EACAgent.Learning - INFO - Learning Module initialized
2025-10-26 00:09:37,029 - EACAgent.Guardrails - INFO - Guardrail System initialized
2025-10-26 00:09:37,029 - EACAgent - INFO - EAC Agent initialized: EAC-Agent-v1
2025-10-26 00:09:37,072 - EACAgent.Guardrails - WARNING - High price burden ratio: 200.959 > 0.3
2025-10-26 00:09:37,073 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:37,073 - EACAgent - INFO - Checkout processed: user=user_0, policy=snap_wic_substitution, recs=0, latency=32.45ms
2025-10-26 00:09:37,078 - EACAgent.Guardrails - WARNING - High price burden ratio: 152.246 > 0.3
2025-10-26 00:09:37,078 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,087 - EACAgent.Guardrails - WARNING - High price burden ratio: 329.974 > 0.3
2025-10-26 00:09:37,087 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:37,087 - EACAgent - INFO - Checkout processed: user=user_2, policy=snap_wic_substitution, recs=0, latency=8.51ms
2025-10-26 00:09:37,091 - EACAgent.Guardrails - WARNING - High price burden ratio: 430.325 > 0.3
2025-10-26 00:09:37,091 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,102 - EACAgent.Guardrails - WARNING - High price burden ratio: 144.417 > 0.3
2025-10-26 00:09:37,102 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,105 - EACAgent.Guardrails - WARNING - High price burden ratio: 208.132 > 0.3
2025-10-26 00:09:37,105 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,108 - EACAgent.Guardrails - WARNING - High price burden ratio: 174.747 > 0.3
2025-10-26 00:09:37,108 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,114 - EACAgent.Guardrails - WARNING - High price burden ratio: 599.786 > 0.3
2025-10-26 00:09:37,114 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,117 - EACAgent.Guardrails - WARNING - High price burden ratio: 139.401 > 0.3
2025-10-26 00:09:37,117 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,122 - EACAgent.Guardrails - WARNING - High price burden ratio: 231.884 > 0.3
2025-10-26 00:09:37,122 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,129 - EACAgent.Guardrails - WARNING - High price burden ratio: 256.817 > 0.3
2025-10-26 00:09:37,129 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,134 - EACAgent.Guardrails - WARNING - High price burden ratio: 453.646 > 0.3
2025-10-26 00:09:37,134 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,155 - EACAgent.Guardrails - WARNING - High price burden ratio: 211.729 > 0.3
2025-10-26 00:09:37,155 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,161 - EACAgent.Guardrails - WARNING - High price burden ratio: 347.602 > 0.3
2025-10-26 00:09:37,161 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,169 - EACAgent.Guardrails - WARNING - High price burden ratio: 430.237 > 0.3
2025-10-26 00:09:37,169 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:37,169 - EACAgent - INFO - Checkout processed: user=user_14, policy=snap_wic_substitution, recs=1, latency=7.25ms
2025-10-26 00:09:37,173 - EACAgent.Guardrails - WARNING - High price burden ratio: 229.573 > 0.3
2025-10-26 00:09:37,173 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,179 - EACAgent.Guardrails - WARNING - High price burden ratio: 394.621 > 0.3
2025-10-26 00:09:37,180 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,184 - EACAgent.Guardrails - WARNING - High price burden ratio: 182.159 > 0.3
2025-10-26 00:09:37,184 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,216 - EACAgent.Guardrails - WARNING - High price burden ratio: 183.576 > 0.3
2025-10-26 00:09:37,217 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,221 - EACAgent.Guardrails - WARNING - High price burden ratio: 181.130 > 0.3
2025-10-26 00:09:37,222 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,225 - EACAgent.Guardrails - WARNING - High price burden ratio: 225.005 > 0.3
2025-10-26 00:09:37,225 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:37,225 - EACAgent - INFO - Checkout processed: user=user_20, policy=snap_wic_substitution, recs=1, latency=3.21ms
2025-10-26 00:09:37,230 - EACAgent.Guardrails - WARNING - High price burden ratio: 74.369 > 0.3
2025-10-26 00:09:37,230 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,234 - EACAgent.Guardrails - WARNING - High price burden ratio: 294.489 > 0.3
2025-10-26 00:09:37,235 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,238 - EACAgent.Guardrails - WARNING - High price burden ratio: 390.964 > 0.3
2025-10-26 00:09:37,239 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 2 SNAP/WIC recommendations
2025-10-26 00:09:37,239 - EACAgent - INFO - Checkout processed: user=user_23, policy=snap_wic_substitution, recs=2, latency=3.73ms
2025-10-26 00:09:37,241 - EACAgent.Guardrails - WARNING - High price burden ratio: 139.070 > 0.3
2025-10-26 00:09:37,242 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:37,242 - EACAgent - INFO - Checkout processed: user=user_24, policy=snap_wic_substitution, recs=1, latency=2.83ms
2025-10-26 00:09:37,245 - EACAgent.Guardrails - WARNING - High price burden ratio: 216.453 > 0.3
2025-10-26 00:09:37,246 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,250 - EACAgent.Guardrails - WARNING - High price burden ratio: 200.704 > 0.3
2025-10-26 00:09:37,251 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:37,251 - EACAgent - INFO - Checkout processed: user=user_26, policy=snap_wic_substitution, recs=1, latency=5.00ms
2025-10-26 00:09:37,256 - EACAgent.Guardrails - WARNING - High price burden ratio: 137.116 > 0.3
2025-10-26 00:09:37,256 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:37,256 - EACAgent - INFO - Checkout processed: user=user_27, policy=snap_wic_substitution, recs=1, latency=4.94ms
2025-10-26 00:09:37,259 - EACAgent.Guardrails - WARNING - High price burden ratio: 293.324 > 0.3
2025-10-26 00:09:37,259 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,263 - EACAgent.Guardrails - WARNING - High price burden ratio: 270.061 > 0.3
2025-10-26 00:09:37,263 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:37,263 - EACAgent - INFO - Checkout processed: user=user_29, policy=snap_wic_substitution, recs=0, latency=4.12ms
2025-10-26 00:09:37,267 - EACAgent.Guardrails - WARNING - High price burden ratio: 130.894 > 0.3
2025-10-26 00:09:37,268 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,271 - EACAgent.Guardrails - WARNING - High price burden ratio: 224.159 > 0.3
2025-10-26 00:09:37,271 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,328 - EACAgent.Guardrails - WARNING - High price burden ratio: 288.012 > 0.3
2025-10-26 00:09:37,328 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,333 - EACAgent.Guardrails - WARNING - High price burden ratio: 243.898 > 0.3
2025-10-26 00:09:37,333 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,338 - EACAgent.Guardrails - WARNING - High price burden ratio: 425.731 > 0.3
2025-10-26 00:09:37,338 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:37,338 - EACAgent - INFO - Checkout processed: user=user_34, policy=snap_wic_substitution, recs=0, latency=4.94ms
2025-10-26 00:09:37,343 - EACAgent.Guardrails - WARNING - High price burden ratio: 374.907 > 0.3
2025-10-26 00:09:37,343 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:37,343 - EACAgent - INFO - Checkout processed: user=user_35, policy=snap_wic_substitution, recs=0, latency=4.31ms
2025-10-26 00:09:37,347 - EACAgent.Guardrails - WARNING - High price burden ratio: 192.492 > 0.3
2025-10-26 00:09:37,347 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,351 - EACAgent.Guardrails - WARNING - High price burden ratio: 245.793 > 0.3
2025-10-26 00:09:37,352 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 2 SNAP/WIC recommendations
2025-10-26 00:09:37,352 - EACAgent - INFO - Checkout processed: user=user_37, policy=snap_wic_substitution, recs=2, latency=4.63ms
2025-10-26 00:09:37,356 - EACAgent.Guardrails - WARNING - High price burden ratio: 233.088 > 0.3
2025-10-26 00:09:37,356 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,362 - EACAgent.Guardrails - WARNING - High price burden ratio: 453.910 > 0.3
2025-10-26 00:09:37,362 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,368 - EACAgent.Guardrails - WARNING - High price burden ratio: 230.717 > 0.3
2025-10-26 00:09:37,368 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,372 - EACAgent.Guardrails - WARNING - High price burden ratio: 332.568 > 0.3
2025-10-26 00:09:37,373 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:37,373 - EACAgent - INFO - Checkout processed: user=user_41, policy=snap_wic_substitution, recs=1, latency=4.34ms
2025-10-26 00:09:37,378 - EACAgent.Guardrails - WARNING - High price burden ratio: 278.084 > 0.3
2025-10-26 00:09:37,378 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,387 - EACAgent.Guardrails - WARNING - High price burden ratio: 296.207 > 0.3
2025-10-26 00:09:37,387 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:37,387 - EACAgent - INFO - Checkout processed: user=user_43, policy=snap_wic_substitution, recs=0, latency=8.93ms
2025-10-26 00:09:37,397 - EACAgent.Guardrails - WARNING - High price burden ratio: 85.371 > 0.3
2025-10-26 00:09:37,397 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,402 - EACAgent.Guardrails - WARNING - High price burden ratio: 434.402 > 0.3
2025-10-26 00:09:37,402 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:37,402 - EACAgent - INFO - Checkout processed: user=user_45, policy=snap_wic_substitution, recs=0, latency=4.77ms
2025-10-26 00:09:37,407 - EACAgent.Guardrails - WARNING - High price burden ratio: 116.953 > 0.3
2025-10-26 00:09:37,408 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,412 - EACAgent.Guardrails - WARNING - High price burden ratio: 272.597 > 0.3
2025-10-26 00:09:37,412 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,417 - EACAgent.Guardrails - WARNING - High price burden ratio: 135.491 > 0.3
2025-10-26 00:09:37,417 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,420 - EACAgent.Guardrails - WARNING - High price burden ratio: 260.626 > 0.3
2025-10-26 00:09:37,420 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:37,420 - EACAgent - INFO - Checkout processed: user=user_49, policy=snap_wic_substitution, recs=0, latency=3.09ms
2025-10-26 00:09:37,424 - EACAgent.Guardrails - WARNING - High price burden ratio: 324.257 > 0.3
2025-10-26 00:09:37,424 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,429 - EACAgent.Guardrails - WARNING - High price burden ratio: 149.903 > 0.3
2025-10-26 00:09:37,429 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:37,430 - EACAgent - INFO - Checkout processed: user=user_51, policy=snap_wic_substitution, recs=0, latency=4.80ms
2025-10-26 00:09:37,435 - EACAgent.Guardrails - WARNING - High price burden ratio: 257.268 > 0.3
2025-10-26 00:09:37,435 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,439 - EACAgent.Guardrails - WARNING - High price burden ratio: 371.645 > 0.3
2025-10-26 00:09:37,439 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,446 - EACAgent.Guardrails - WARNING - High price burden ratio: 216.967 > 0.3
2025-10-26 00:09:37,446 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,450 - EACAgent.Guardrails - WARNING - High price burden ratio: 236.959 > 0.3
2025-10-26 00:09:37,450 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,454 - EACAgent.Guardrails - WARNING - High price burden ratio: 261.942 > 0.3
2025-10-26 00:09:37,454 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,458 - EACAgent.Guardrails - WARNING - High price burden ratio: 286.787 > 0.3
2025-10-26 00:09:37,458 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,463 - EACAgent.Guardrails - WARNING - High price burden ratio: 127.010 > 0.3
2025-10-26 00:09:37,463 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,467 - EACAgent.Guardrails - WARNING - High price burden ratio: 402.855 > 0.3
2025-10-26 00:09:37,467 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,470 - EACAgent.Guardrails - WARNING - High price burden ratio: 329.800 > 0.3
2025-10-26 00:09:37,470 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,475 - EACAgent.Guardrails - WARNING - High price burden ratio: 225.339 > 0.3
2025-10-26 00:09:37,475 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,480 - EACAgent.Guardrails - WARNING - High price burden ratio: 282.156 > 0.3
2025-10-26 00:09:37,480 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,485 - EACAgent.Guardrails - WARNING - High price burden ratio: 348.087 > 0.3
2025-10-26 00:09:37,486 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:37,486 - EACAgent - INFO - Checkout processed: user=user_63, policy=snap_wic_substitution, recs=1, latency=5.73ms
2025-10-26 00:09:37,491 - EACAgent.Guardrails - WARNING - High price burden ratio: 202.049 > 0.3
2025-10-26 00:09:37,491 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,496 - EACAgent.Guardrails - WARNING - High price burden ratio: 238.976 > 0.3
2025-10-26 00:09:37,496 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,500 - EACAgent.Guardrails - WARNING - High price burden ratio: 424.518 > 0.3
2025-10-26 00:09:37,500 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,504 - EACAgent.Guardrails - WARNING - High price burden ratio: 102.870 > 0.3
2025-10-26 00:09:37,504 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,509 - EACAgent.Guardrails - WARNING - High price burden ratio: 382.598 > 0.3
2025-10-26 00:09:37,509 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,514 - EACAgent.Guardrails - WARNING - High price burden ratio: 156.820 > 0.3
2025-10-26 00:09:37,514 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,518 - EACAgent.Guardrails - WARNING - High price burden ratio: 145.206 > 0.3
2025-10-26 00:09:37,519 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:37,519 - EACAgent - INFO - Checkout processed: user=user_70, policy=snap_wic_substitution, recs=1, latency=4.28ms
2025-10-26 00:09:37,524 - EACAgent.Guardrails - WARNING - High price burden ratio: 150.686 > 0.3
2025-10-26 00:09:37,524 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:37,524 - EACAgent - INFO - Checkout processed: user=user_71, policy=snap_wic_substitution, recs=0, latency=5.39ms
2025-10-26 00:09:37,529 - EACAgent.Guardrails - WARNING - High price burden ratio: 165.299 > 0.3
2025-10-26 00:09:37,529 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:37,529 - EACAgent - INFO - Checkout processed: user=user_72, policy=snap_wic_substitution, recs=1, latency=4.80ms
2025-10-26 00:09:37,533 - EACAgent.Guardrails - WARNING - High price burden ratio: 269.969 > 0.3
2025-10-26 00:09:37,533 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,536 - EACAgent.Guardrails - WARNING - High price burden ratio: 488.758 > 0.3
2025-10-26 00:09:37,536 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 2 SNAP/WIC recommendations
2025-10-26 00:09:37,537 - EACAgent - INFO - Checkout processed: user=user_74, policy=snap_wic_substitution, recs=2, latency=3.05ms
2025-10-26 00:09:37,539 - EACAgent.Guardrails - WARNING - High price burden ratio: 383.042 > 0.3
2025-10-26 00:09:37,539 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,542 - EACAgent.Guardrails - WARNING - High price burden ratio: 170.388 > 0.3
2025-10-26 00:09:37,542 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:37,542 - EACAgent - INFO - Checkout processed: user=user_76, policy=snap_wic_substitution, recs=0, latency=2.56ms
2025-10-26 00:09:37,546 - EACAgent.Guardrails - WARNING - High price burden ratio: 63.759 > 0.3
2025-10-26 00:09:37,546 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,550 - EACAgent.Guardrails - WARNING - High price burden ratio: 195.313 > 0.3
2025-10-26 00:09:37,551 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,554 - EACAgent.Guardrails - WARNING - High price burden ratio: 142.304 > 0.3
2025-10-26 00:09:37,554 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:37,555 - EACAgent - INFO - Checkout processed: user=user_79, policy=snap_wic_substitution, recs=0, latency=3.29ms
2025-10-26 00:09:37,559 - EACAgent.Guardrails - WARNING - High price burden ratio: 495.190 > 0.3
2025-10-26 00:09:37,559 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:37,559 - EACAgent - INFO - Checkout processed: user=user_80, policy=snap_wic_substitution, recs=1, latency=4.14ms
2025-10-26 00:09:37,563 - EACAgent.Guardrails - WARNING - High price burden ratio: 372.120 > 0.3
2025-10-26 00:09:37,563 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,568 - EACAgent.Guardrails - WARNING - High price burden ratio: 181.526 > 0.3
2025-10-26 00:09:37,568 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:37,568 - EACAgent - INFO - Checkout processed: user=user_82, policy=snap_wic_substitution, recs=0, latency=5.25ms
2025-10-26 00:09:37,574 - EACAgent.Guardrails - WARNING - High price burden ratio: 154.835 > 0.3
2025-10-26 00:09:37,574 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,579 - EACAgent.Guardrails - WARNING - High price burden ratio: 231.889 > 0.3
2025-10-26 00:09:37,579 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,582 - EACAgent.Guardrails - WARNING - High price burden ratio: 118.715 > 0.3
2025-10-26 00:09:37,582 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,586 - EACAgent.Guardrails - WARNING - High price burden ratio: 160.189 > 0.3
2025-10-26 00:09:37,586 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:37,586 - EACAgent - INFO - Checkout processed: user=user_86, policy=snap_wic_substitution, recs=0, latency=3.31ms
2025-10-26 00:09:37,589 - EACAgent.Guardrails - WARNING - High price burden ratio: 108.030 > 0.3
2025-10-26 00:09:37,589 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:37,589 - EACAgent - INFO - Checkout processed: user=user_87, policy=snap_wic_substitution, recs=0, latency=2.69ms
2025-10-26 00:09:37,592 - EACAgent.Guardrails - WARNING - High price burden ratio: 212.494 > 0.3
2025-10-26 00:09:37,592 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:37,592 - EACAgent - INFO - Checkout processed: user=user_88, policy=snap_wic_substitution, recs=1, latency=3.24ms
2025-10-26 00:09:37,596 - EACAgent.Guardrails - WARNING - High price burden ratio: 294.471 > 0.3
2025-10-26 00:09:37,596 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:37,596 - EACAgent - INFO - Checkout processed: user=user_89, policy=snap_wic_substitution, recs=0, latency=3.51ms
2025-10-26 00:09:37,600 - EACAgent.Guardrails - WARNING - High price burden ratio: 310.703 > 0.3
2025-10-26 00:09:37,600 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:37,601 - EACAgent - INFO - Checkout processed: user=user_90, policy=snap_wic_substitution, recs=0, latency=4.29ms
2025-10-26 00:09:37,604 - EACAgent.Guardrails - WARNING - High price burden ratio: 179.545 > 0.3
2025-10-26 00:09:37,605 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:37,605 - EACAgent - INFO - Checkout processed: user=user_91, policy=snap_wic_substitution, recs=0, latency=4.03ms
2025-10-26 00:09:37,609 - EACAgent.Guardrails - WARNING - High price burden ratio: 206.749 > 0.3
2025-10-26 00:09:37,609 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:37,610 - EACAgent - INFO - Checkout processed: user=user_92, policy=snap_wic_substitution, recs=0, latency=4.18ms
2025-10-26 00:09:37,617 - EACAgent.Guardrails - WARNING - High price burden ratio: 375.483 > 0.3
2025-10-26 00:09:37,617 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,623 - EACAgent.Guardrails - WARNING - High price burden ratio: 366.955 > 0.3
2025-10-26 00:09:37,623 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,626 - EACAgent.Guardrails - WARNING - High price burden ratio: 245.199 > 0.3
2025-10-26 00:09:37,626 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:37,626 - EACAgent - INFO - Checkout processed: user=user_95, policy=snap_wic_substitution, recs=0, latency=2.76ms
2025-10-26 00:09:37,629 - EACAgent.Guardrails - WARNING - High price burden ratio: 356.833 > 0.3
2025-10-26 00:09:37,629 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,634 - EACAgent.Guardrails - WARNING - High price burden ratio: 253.821 > 0.3
2025-10-26 00:09:37,634 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,638 - EACAgent.Guardrails - WARNING - High price burden ratio: 185.029 > 0.3
2025-10-26 00:09:37,638 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 2 SNAP/WIC recommendations
2025-10-26 00:09:37,638 - EACAgent - INFO - Checkout processed: user=user_98, policy=snap_wic_substitution, recs=2, latency=4.04ms
2025-10-26 00:09:37,642 - EACAgent.Guardrails - WARNING - High price burden ratio: 135.116 > 0.3
2025-10-26 00:09:37,642 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,647 - EACAgent.Guardrails - WARNING - High price burden ratio: 200.959 > 0.3
2025-10-26 00:09:37,647 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:37,647 - EACAgent - INFO - Checkout processed: user=user_0, policy=snap_wic_substitution, recs=0, latency=4.45ms
2025-10-26 00:09:37,653 - EACAgent.Guardrails - WARNING - High price burden ratio: 152.246 > 0.3
2025-10-26 00:09:37,653 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,663 - EACAgent.Guardrails - WARNING - High price burden ratio: 329.974 > 0.3
2025-10-26 00:09:37,663 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:37,664 - EACAgent - INFO - Checkout processed: user=user_2, policy=snap_wic_substitution, recs=0, latency=9.94ms
2025-10-26 00:09:37,668 - EACAgent.Guardrails - WARNING - High price burden ratio: 430.325 > 0.3
2025-10-26 00:09:37,668 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,674 - EACAgent.Guardrails - WARNING - High price burden ratio: 144.417 > 0.3
2025-10-26 00:09:37,674 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,679 - EACAgent.Guardrails - WARNING - High price burden ratio: 208.132 > 0.3
2025-10-26 00:09:37,679 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,683 - EACAgent.Guardrails - WARNING - High price burden ratio: 174.747 > 0.3
2025-10-26 00:09:37,684 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,695 - EACAgent.Guardrails - WARNING - High price burden ratio: 599.786 > 0.3
2025-10-26 00:09:37,695 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,700 - EACAgent.Guardrails - WARNING - High price burden ratio: 139.401 > 0.3
2025-10-26 00:09:37,700 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,704 - EACAgent.Guardrails - WARNING - High price burden ratio: 231.884 > 0.3
2025-10-26 00:09:37,704 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,709 - EACAgent.Guardrails - WARNING - High price burden ratio: 256.817 > 0.3
2025-10-26 00:09:37,709 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,712 - EACAgent.Guardrails - WARNING - High price burden ratio: 453.646 > 0.3
2025-10-26 00:09:37,712 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,717 - EACAgent.Guardrails - WARNING - High price burden ratio: 211.729 > 0.3
2025-10-26 00:09:37,717 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,721 - EACAgent.Guardrails - WARNING - High price burden ratio: 347.602 > 0.3
2025-10-26 00:09:37,721 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,726 - EACAgent.Guardrails - WARNING - High price burden ratio: 430.237 > 0.3
2025-10-26 00:09:37,726 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:37,726 - EACAgent - INFO - Checkout processed: user=user_14, policy=snap_wic_substitution, recs=1, latency=5.30ms
2025-10-26 00:09:37,733 - EACAgent.Guardrails - WARNING - High price burden ratio: 229.573 > 0.3
2025-10-26 00:09:37,733 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,737 - EACAgent.Guardrails - WARNING - High price burden ratio: 394.621 > 0.3
2025-10-26 00:09:37,737 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,742 - EACAgent.Guardrails - WARNING - High price burden ratio: 182.159 > 0.3
2025-10-26 00:09:37,742 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,749 - EACAgent.Guardrails - WARNING - High price burden ratio: 183.576 > 0.3
2025-10-26 00:09:37,749 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,754 - EACAgent.Guardrails - WARNING - High price burden ratio: 181.130 > 0.3
2025-10-26 00:09:37,754 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,758 - EACAgent.Guardrails - WARNING - High price burden ratio: 225.005 > 0.3
2025-10-26 00:09:37,758 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:37,758 - EACAgent - INFO - Checkout processed: user=user_20, policy=snap_wic_substitution, recs=1, latency=4.17ms
2025-10-26 00:09:37,762 - EACAgent.Guardrails - WARNING - High price burden ratio: 74.369 > 0.3
2025-10-26 00:09:37,763 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,767 - EACAgent.Guardrails - WARNING - High price burden ratio: 294.489 > 0.3
2025-10-26 00:09:37,767 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,771 - EACAgent.Guardrails - WARNING - High price burden ratio: 390.964 > 0.3
2025-10-26 00:09:37,771 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 2 SNAP/WIC recommendations
2025-10-26 00:09:37,771 - EACAgent - INFO - Checkout processed: user=user_23, policy=snap_wic_substitution, recs=2, latency=3.97ms
2025-10-26 00:09:37,775 - EACAgent.Guardrails - WARNING - High price burden ratio: 139.070 > 0.3
2025-10-26 00:09:37,775 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:37,775 - EACAgent - INFO - Checkout processed: user=user_24, policy=snap_wic_substitution, recs=1, latency=3.34ms
2025-10-26 00:09:37,779 - EACAgent.Guardrails - WARNING - High price burden ratio: 216.453 > 0.3
2025-10-26 00:09:37,779 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,783 - EACAgent.Guardrails - WARNING - High price burden ratio: 200.704 > 0.3
2025-10-26 00:09:37,783 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:37,783 - EACAgent - INFO - Checkout processed: user=user_26, policy=snap_wic_substitution, recs=1, latency=3.99ms
2025-10-26 00:09:37,786 - EACAgent.Guardrails - WARNING - High price burden ratio: 137.116 > 0.3
2025-10-26 00:09:37,786 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:37,786 - EACAgent - INFO - Checkout processed: user=user_27, policy=snap_wic_substitution, recs=1, latency=2.89ms
2025-10-26 00:09:37,789 - EACAgent.Guardrails - WARNING - High price burden ratio: 293.324 > 0.3
2025-10-26 00:09:37,789 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,795 - EACAgent.Guardrails - WARNING - High price burden ratio: 270.061 > 0.3
2025-10-26 00:09:37,795 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:37,795 - EACAgent - INFO - Checkout processed: user=user_29, policy=snap_wic_substitution, recs=0, latency=6.14ms
2025-10-26 00:09:37,800 - EACAgent.Guardrails - WARNING - High price burden ratio: 130.894 > 0.3
2025-10-26 00:09:37,800 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,804 - EACAgent.Guardrails - WARNING - High price burden ratio: 224.159 > 0.3
2025-10-26 00:09:37,804 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,808 - EACAgent.Guardrails - WARNING - High price burden ratio: 288.012 > 0.3
2025-10-26 00:09:37,808 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,813 - EACAgent.Guardrails - WARNING - High price burden ratio: 243.898 > 0.3
2025-10-26 00:09:37,814 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,817 - EACAgent.Guardrails - WARNING - High price burden ratio: 425.731 > 0.3
2025-10-26 00:09:37,817 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:37,817 - EACAgent - INFO - Checkout processed: user=user_34, policy=snap_wic_substitution, recs=0, latency=3.54ms
2025-10-26 00:09:37,820 - EACAgent.Guardrails - WARNING - High price burden ratio: 374.907 > 0.3
2025-10-26 00:09:37,820 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:37,820 - EACAgent - INFO - Checkout processed: user=user_35, policy=snap_wic_substitution, recs=0, latency=2.81ms
2025-10-26 00:09:37,825 - EACAgent.Guardrails - WARNING - High price burden ratio: 192.492 > 0.3
2025-10-26 00:09:37,825 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,829 - EACAgent.Guardrails - WARNING - High price burden ratio: 245.793 > 0.3
2025-10-26 00:09:37,830 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 2 SNAP/WIC recommendations
2025-10-26 00:09:37,830 - EACAgent - INFO - Checkout processed: user=user_37, policy=snap_wic_substitution, recs=2, latency=4.74ms
2025-10-26 00:09:37,834 - EACAgent.Guardrails - WARNING - High price burden ratio: 233.088 > 0.3
2025-10-26 00:09:37,834 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,838 - EACAgent.Guardrails - WARNING - High price burden ratio: 453.910 > 0.3
2025-10-26 00:09:37,838 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,843 - EACAgent.Guardrails - WARNING - High price burden ratio: 230.717 > 0.3
2025-10-26 00:09:37,843 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,847 - EACAgent.Guardrails - WARNING - High price burden ratio: 332.568 > 0.3
2025-10-26 00:09:37,847 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:37,848 - EACAgent - INFO - Checkout processed: user=user_41, policy=snap_wic_substitution, recs=1, latency=4.37ms
2025-10-26 00:09:37,850 - EACAgent.Guardrails - WARNING - High price burden ratio: 278.084 > 0.3
2025-10-26 00:09:37,850 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,853 - EACAgent.Guardrails - WARNING - High price burden ratio: 296.207 > 0.3
2025-10-26 00:09:37,853 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:37,853 - EACAgent - INFO - Checkout processed: user=user_43, policy=snap_wic_substitution, recs=0, latency=2.46ms
2025-10-26 00:09:37,858 - EACAgent.Guardrails - WARNING - High price burden ratio: 85.371 > 0.3
2025-10-26 00:09:37,858 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,863 - EACAgent.Guardrails - WARNING - High price burden ratio: 434.402 > 0.3
2025-10-26 00:09:37,863 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:37,863 - EACAgent - INFO - Checkout processed: user=user_45, policy=snap_wic_substitution, recs=0, latency=5.04ms
2025-10-26 00:09:37,868 - EACAgent.Guardrails - WARNING - High price burden ratio: 116.953 > 0.3
2025-10-26 00:09:37,868 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,872 - EACAgent.Guardrails - WARNING - High price burden ratio: 272.597 > 0.3
2025-10-26 00:09:37,872 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,878 - EACAgent.Guardrails - WARNING - High price burden ratio: 135.491 > 0.3
2025-10-26 00:09:37,878 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,885 - EACAgent.Guardrails - WARNING - High price burden ratio: 260.626 > 0.3
2025-10-26 00:09:37,885 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:37,885 - EACAgent - INFO - Checkout processed: user=user_49, policy=snap_wic_substitution, recs=0, latency=6.79ms
2025-10-26 00:09:37,888 - EACAgent.Guardrails - WARNING - High price burden ratio: 324.257 > 0.3
2025-10-26 00:09:37,888 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,892 - EACAgent.Guardrails - WARNING - High price burden ratio: 149.903 > 0.3
2025-10-26 00:09:37,893 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:37,893 - EACAgent - INFO - Checkout processed: user=user_51, policy=snap_wic_substitution, recs=0, latency=4.26ms
2025-10-26 00:09:37,899 - EACAgent.Guardrails - WARNING - High price burden ratio: 257.268 > 0.3
2025-10-26 00:09:37,900 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,903 - EACAgent.Guardrails - WARNING - High price burden ratio: 371.645 > 0.3
2025-10-26 00:09:37,903 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,906 - EACAgent.Guardrails - WARNING - High price burden ratio: 216.967 > 0.3
2025-10-26 00:09:37,906 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,913 - EACAgent.Guardrails - WARNING - High price burden ratio: 236.959 > 0.3
2025-10-26 00:09:37,913 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,919 - EACAgent.Guardrails - WARNING - High price burden ratio: 261.942 > 0.3
2025-10-26 00:09:37,919 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,924 - EACAgent.Guardrails - WARNING - High price burden ratio: 286.787 > 0.3
2025-10-26 00:09:37,924 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,930 - EACAgent.Guardrails - WARNING - High price burden ratio: 127.010 > 0.3
2025-10-26 00:09:37,930 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,934 - EACAgent.Guardrails - WARNING - High price burden ratio: 402.855 > 0.3
2025-10-26 00:09:37,935 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,939 - EACAgent.Guardrails - WARNING - High price burden ratio: 329.800 > 0.3
2025-10-26 00:09:37,939 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,945 - EACAgent.Guardrails - WARNING - High price burden ratio: 225.339 > 0.3
2025-10-26 00:09:37,945 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,950 - EACAgent.Guardrails - WARNING - High price burden ratio: 282.156 > 0.3
2025-10-26 00:09:37,950 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,953 - EACAgent.Guardrails - WARNING - High price burden ratio: 348.087 > 0.3
2025-10-26 00:09:37,954 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:37,954 - EACAgent - INFO - Checkout processed: user=user_63, policy=snap_wic_substitution, recs=1, latency=3.51ms
2025-10-26 00:09:37,958 - EACAgent.Guardrails - WARNING - High price burden ratio: 202.049 > 0.3
2025-10-26 00:09:37,958 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,962 - EACAgent.Guardrails - WARNING - High price burden ratio: 238.976 > 0.3
2025-10-26 00:09:37,962 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,966 - EACAgent.Guardrails - WARNING - High price burden ratio: 424.518 > 0.3
2025-10-26 00:09:37,966 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,969 - EACAgent.Guardrails - WARNING - High price burden ratio: 102.870 > 0.3
2025-10-26 00:09:37,969 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,975 - EACAgent.Guardrails - WARNING - High price burden ratio: 382.598 > 0.3
2025-10-26 00:09:37,975 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,980 - EACAgent.Guardrails - WARNING - High price burden ratio: 156.820 > 0.3
2025-10-26 00:09:37,980 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:37,985 - EACAgent.Guardrails - WARNING - High price burden ratio: 145.206 > 0.3
2025-10-26 00:09:37,985 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:37,985 - EACAgent - INFO - Checkout processed: user=user_70, policy=snap_wic_substitution, recs=1, latency=4.72ms
2025-10-26 00:09:37,991 - EACAgent.Guardrails - WARNING - High price burden ratio: 150.686 > 0.3
2025-10-26 00:09:37,991 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:37,991 - EACAgent - INFO - Checkout processed: user=user_71, policy=snap_wic_substitution, recs=0, latency=5.61ms
2025-10-26 00:09:37,996 - EACAgent.Guardrails - WARNING - High price burden ratio: 165.299 > 0.3
2025-10-26 00:09:37,996 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:37,996 - EACAgent - INFO - Checkout processed: user=user_72, policy=snap_wic_substitution, recs=1, latency=4.60ms
2025-10-26 00:09:38,000 - EACAgent.Guardrails - WARNING - High price burden ratio: 269.969 > 0.3
2025-10-26 00:09:38,000 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,004 - EACAgent.Guardrails - WARNING - High price burden ratio: 488.758 > 0.3
2025-10-26 00:09:38,005 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 2 SNAP/WIC recommendations
2025-10-26 00:09:38,005 - EACAgent - INFO - Checkout processed: user=user_74, policy=snap_wic_substitution, recs=2, latency=4.44ms
2025-10-26 00:09:38,009 - EACAgent.Guardrails - WARNING - High price burden ratio: 383.042 > 0.3
2025-10-26 00:09:38,009 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,012 - EACAgent.Guardrails - WARNING - High price burden ratio: 170.388 > 0.3
2025-10-26 00:09:38,012 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:38,012 - EACAgent - INFO - Checkout processed: user=user_76, policy=snap_wic_substitution, recs=0, latency=3.12ms
2025-10-26 00:09:38,017 - EACAgent.Guardrails - WARNING - High price burden ratio: 63.759 > 0.3
2025-10-26 00:09:38,017 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,022 - EACAgent.Guardrails - WARNING - High price burden ratio: 195.313 > 0.3
2025-10-26 00:09:38,022 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,026 - EACAgent.Guardrails - WARNING - High price burden ratio: 142.304 > 0.3
2025-10-26 00:09:38,026 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:38,026 - EACAgent - INFO - Checkout processed: user=user_79, policy=snap_wic_substitution, recs=0, latency=3.09ms
2025-10-26 00:09:38,029 - EACAgent.Guardrails - WARNING - High price burden ratio: 495.190 > 0.3
2025-10-26 00:09:38,029 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:38,029 - EACAgent - INFO - Checkout processed: user=user_80, policy=snap_wic_substitution, recs=1, latency=3.66ms
2025-10-26 00:09:38,034 - EACAgent.Guardrails - WARNING - High price burden ratio: 372.120 > 0.3
2025-10-26 00:09:38,034 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,037 - EACAgent.Guardrails - WARNING - High price burden ratio: 181.526 > 0.3
2025-10-26 00:09:38,037 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:38,037 - EACAgent - INFO - Checkout processed: user=user_82, policy=snap_wic_substitution, recs=0, latency=2.85ms
2025-10-26 00:09:38,041 - EACAgent.Guardrails - WARNING - High price burden ratio: 154.835 > 0.3
2025-10-26 00:09:38,041 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,046 - EACAgent.Guardrails - WARNING - High price burden ratio: 231.889 > 0.3
2025-10-26 00:09:38,046 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,050 - EACAgent.Guardrails - WARNING - High price burden ratio: 118.715 > 0.3
2025-10-26 00:09:38,050 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,054 - EACAgent.Guardrails - WARNING - High price burden ratio: 160.189 > 0.3
2025-10-26 00:09:38,054 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:38,054 - EACAgent - INFO - Checkout processed: user=user_86, policy=snap_wic_substitution, recs=0, latency=3.46ms
2025-10-26 00:09:38,058 - EACAgent.Guardrails - WARNING - High price burden ratio: 108.030 > 0.3
2025-10-26 00:09:38,058 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:38,058 - EACAgent - INFO - Checkout processed: user=user_87, policy=snap_wic_substitution, recs=0, latency=3.96ms
2025-10-26 00:09:38,062 - EACAgent.Guardrails - WARNING - High price burden ratio: 212.494 > 0.3
2025-10-26 00:09:38,062 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:38,062 - EACAgent - INFO - Checkout processed: user=user_88, policy=snap_wic_substitution, recs=1, latency=3.67ms
2025-10-26 00:09:38,069 - EACAgent.Guardrails - WARNING - High price burden ratio: 294.471 > 0.3
2025-10-26 00:09:38,069 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:38,070 - EACAgent - INFO - Checkout processed: user=user_89, policy=snap_wic_substitution, recs=0, latency=6.89ms
2025-10-26 00:09:38,078 - EACAgent.Guardrails - WARNING - High price burden ratio: 310.703 > 0.3
2025-10-26 00:09:38,079 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:38,079 - EACAgent - INFO - Checkout processed: user=user_90, policy=snap_wic_substitution, recs=0, latency=8.82ms
2025-10-26 00:09:38,083 - EACAgent.Guardrails - WARNING - High price burden ratio: 179.545 > 0.3
2025-10-26 00:09:38,083 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:38,083 - EACAgent - INFO - Checkout processed: user=user_91, policy=snap_wic_substitution, recs=0, latency=4.11ms
2025-10-26 00:09:38,086 - EACAgent.Guardrails - WARNING - High price burden ratio: 206.749 > 0.3
2025-10-26 00:09:38,086 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:38,086 - EACAgent - INFO - Checkout processed: user=user_92, policy=snap_wic_substitution, recs=0, latency=2.87ms
2025-10-26 00:09:38,092 - EACAgent.Guardrails - WARNING - High price burden ratio: 375.483 > 0.3
2025-10-26 00:09:38,092 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,097 - EACAgent.Guardrails - WARNING - High price burden ratio: 366.955 > 0.3
2025-10-26 00:09:38,097 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,101 - EACAgent.Guardrails - WARNING - High price burden ratio: 245.199 > 0.3
2025-10-26 00:09:38,101 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:38,101 - EACAgent - INFO - Checkout processed: user=user_95, policy=snap_wic_substitution, recs=0, latency=3.62ms
2025-10-26 00:09:38,106 - EACAgent.Guardrails - WARNING - High price burden ratio: 356.833 > 0.3
2025-10-26 00:09:38,106 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,109 - EACAgent.Guardrails - WARNING - High price burden ratio: 253.821 > 0.3
2025-10-26 00:09:38,109 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,117 - EACAgent.Guardrails - WARNING - High price burden ratio: 185.029 > 0.3
2025-10-26 00:09:38,117 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 2 SNAP/WIC recommendations
2025-10-26 00:09:38,117 - EACAgent - INFO - Checkout processed: user=user_98, policy=snap_wic_substitution, recs=2, latency=7.82ms
2025-10-26 00:09:38,122 - EACAgent.Guardrails - WARNING - High price burden ratio: 135.116 > 0.3
2025-10-26 00:09:38,122 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,126 - EACAgent.Guardrails - WARNING - High price burden ratio: 200.959 > 0.3
2025-10-26 00:09:38,126 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:38,127 - EACAgent - INFO - Checkout processed: user=user_0, policy=snap_wic_substitution, recs=0, latency=3.99ms
2025-10-26 00:09:38,130 - EACAgent.Guardrails - WARNING - High price burden ratio: 152.246 > 0.3
2025-10-26 00:09:38,130 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,134 - EACAgent.Guardrails - WARNING - High price burden ratio: 329.974 > 0.3
2025-10-26 00:09:38,134 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:38,134 - EACAgent - INFO - Checkout processed: user=user_2, policy=snap_wic_substitution, recs=0, latency=4.10ms
2025-10-26 00:09:38,136 - EACAgent.Guardrails - WARNING - High price burden ratio: 430.325 > 0.3
2025-10-26 00:09:38,136 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,141 - EACAgent.Guardrails - WARNING - High price burden ratio: 144.417 > 0.3
2025-10-26 00:09:38,141 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,145 - EACAgent.Guardrails - WARNING - High price burden ratio: 208.132 > 0.3
2025-10-26 00:09:38,145 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,150 - EACAgent.Guardrails - WARNING - High price burden ratio: 174.747 > 0.3
2025-10-26 00:09:38,150 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,152 - EACAgent.Guardrails - WARNING - High price burden ratio: 599.786 > 0.3
2025-10-26 00:09:38,153 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,156 - EACAgent.Guardrails - WARNING - High price burden ratio: 139.401 > 0.3
2025-10-26 00:09:38,156 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,166 - EACAgent.Guardrails - WARNING - High price burden ratio: 231.884 > 0.3
2025-10-26 00:09:38,166 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,171 - EACAgent.Guardrails - WARNING - High price burden ratio: 256.817 > 0.3
2025-10-26 00:09:38,171 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,175 - EACAgent.Guardrails - WARNING - High price burden ratio: 453.646 > 0.3
2025-10-26 00:09:38,175 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,179 - EACAgent.Guardrails - WARNING - High price burden ratio: 211.729 > 0.3
2025-10-26 00:09:38,179 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,184 - EACAgent.Guardrails - WARNING - High price burden ratio: 347.602 > 0.3
2025-10-26 00:09:38,184 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,187 - EACAgent.Guardrails - WARNING - High price burden ratio: 430.237 > 0.3
2025-10-26 00:09:38,187 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:38,187 - EACAgent - INFO - Checkout processed: user=user_14, policy=snap_wic_substitution, recs=1, latency=3.60ms
2025-10-26 00:09:38,192 - EACAgent.Guardrails - WARNING - High price burden ratio: 229.573 > 0.3
2025-10-26 00:09:38,192 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,197 - EACAgent.Guardrails - WARNING - High price burden ratio: 394.621 > 0.3
2025-10-26 00:09:38,197 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,202 - EACAgent.Guardrails - WARNING - High price burden ratio: 182.159 > 0.3
2025-10-26 00:09:38,202 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,207 - EACAgent.Guardrails - WARNING - High price burden ratio: 183.576 > 0.3
2025-10-26 00:09:38,207 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,213 - EACAgent.Guardrails - WARNING - High price burden ratio: 181.130 > 0.3
2025-10-26 00:09:38,213 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,216 - EACAgent.Guardrails - WARNING - High price burden ratio: 225.005 > 0.3
2025-10-26 00:09:38,217 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:38,217 - EACAgent - INFO - Checkout processed: user=user_20, policy=snap_wic_substitution, recs=1, latency=3.24ms
2025-10-26 00:09:38,220 - EACAgent.Guardrails - WARNING - High price burden ratio: 74.369 > 0.3
2025-10-26 00:09:38,220 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,223 - EACAgent.Guardrails - WARNING - High price burden ratio: 294.489 > 0.3
2025-10-26 00:09:38,223 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,225 - EACAgent.Guardrails - WARNING - High price burden ratio: 390.964 > 0.3
2025-10-26 00:09:38,226 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 2 SNAP/WIC recommendations
2025-10-26 00:09:38,226 - EACAgent - INFO - Checkout processed: user=user_23, policy=snap_wic_substitution, recs=2, latency=2.93ms
2025-10-26 00:09:38,229 - EACAgent.Guardrails - WARNING - High price burden ratio: 139.070 > 0.3
2025-10-26 00:09:38,229 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:38,229 - EACAgent - INFO - Checkout processed: user=user_24, policy=snap_wic_substitution, recs=1, latency=3.20ms
2025-10-26 00:09:38,233 - EACAgent.Guardrails - WARNING - High price burden ratio: 216.453 > 0.3
2025-10-26 00:09:38,234 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,238 - EACAgent.Guardrails - WARNING - High price burden ratio: 200.704 > 0.3
2025-10-26 00:09:38,238 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:38,238 - EACAgent - INFO - Checkout processed: user=user_26, policy=snap_wic_substitution, recs=1, latency=4.22ms
2025-10-26 00:09:38,242 - EACAgent.Guardrails - WARNING - High price burden ratio: 137.116 > 0.3
2025-10-26 00:09:38,242 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:38,242 - EACAgent - INFO - Checkout processed: user=user_27, policy=snap_wic_substitution, recs=1, latency=4.01ms
2025-10-26 00:09:38,246 - EACAgent.Guardrails - WARNING - High price burden ratio: 293.324 > 0.3
2025-10-26 00:09:38,247 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,250 - EACAgent.Guardrails - WARNING - High price burden ratio: 270.061 > 0.3
2025-10-26 00:09:38,250 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:38,250 - EACAgent - INFO - Checkout processed: user=user_29, policy=snap_wic_substitution, recs=0, latency=3.06ms
2025-10-26 00:09:38,253 - EACAgent.Guardrails - WARNING - High price burden ratio: 130.894 > 0.3
2025-10-26 00:09:38,253 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,255 - EACAgent.Guardrails - WARNING - High price burden ratio: 224.159 > 0.3
2025-10-26 00:09:38,255 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,259 - EACAgent.Guardrails - WARNING - High price burden ratio: 288.012 > 0.3
2025-10-26 00:09:38,259 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,264 - EACAgent.Guardrails - WARNING - High price burden ratio: 243.898 > 0.3
2025-10-26 00:09:38,264 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,267 - EACAgent.Guardrails - WARNING - High price burden ratio: 425.731 > 0.3
2025-10-26 00:09:38,268 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:38,268 - EACAgent - INFO - Checkout processed: user=user_34, policy=snap_wic_substitution, recs=0, latency=3.79ms
2025-10-26 00:09:38,271 - EACAgent.Guardrails - WARNING - High price burden ratio: 374.907 > 0.3
2025-10-26 00:09:38,271 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:38,271 - EACAgent - INFO - Checkout processed: user=user_35, policy=snap_wic_substitution, recs=0, latency=3.03ms
2025-10-26 00:09:38,274 - EACAgent.Guardrails - WARNING - High price burden ratio: 192.492 > 0.3
2025-10-26 00:09:38,274 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,279 - EACAgent.Guardrails - WARNING - High price burden ratio: 245.793 > 0.3
2025-10-26 00:09:38,279 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 2 SNAP/WIC recommendations
2025-10-26 00:09:38,279 - EACAgent - INFO - Checkout processed: user=user_37, policy=snap_wic_substitution, recs=2, latency=4.79ms
2025-10-26 00:09:38,284 - EACAgent.Guardrails - WARNING - High price burden ratio: 233.088 > 0.3
2025-10-26 00:09:38,284 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,289 - EACAgent.Guardrails - WARNING - High price burden ratio: 453.910 > 0.3
2025-10-26 00:09:38,289 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,295 - EACAgent.Guardrails - WARNING - High price burden ratio: 230.717 > 0.3
2025-10-26 00:09:38,295 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,300 - EACAgent.Guardrails - WARNING - High price burden ratio: 332.568 > 0.3
2025-10-26 00:09:38,300 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:38,300 - EACAgent - INFO - Checkout processed: user=user_41, policy=snap_wic_substitution, recs=1, latency=4.77ms
2025-10-26 00:09:38,304 - EACAgent.Guardrails - WARNING - High price burden ratio: 278.084 > 0.3
2025-10-26 00:09:38,305 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,308 - EACAgent.Guardrails - WARNING - High price burden ratio: 296.207 > 0.3
2025-10-26 00:09:38,308 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:38,309 - EACAgent - INFO - Checkout processed: user=user_43, policy=snap_wic_substitution, recs=0, latency=3.70ms
2025-10-26 00:09:38,313 - EACAgent.Guardrails - WARNING - High price burden ratio: 85.371 > 0.3
2025-10-26 00:09:38,313 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,316 - EACAgent.Guardrails - WARNING - High price burden ratio: 434.402 > 0.3
2025-10-26 00:09:38,316 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:38,316 - EACAgent - INFO - Checkout processed: user=user_45, policy=snap_wic_substitution, recs=0, latency=3.03ms
2025-10-26 00:09:38,319 - EACAgent.Guardrails - WARNING - High price burden ratio: 116.953 > 0.3
2025-10-26 00:09:38,319 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,322 - EACAgent.Guardrails - WARNING - High price burden ratio: 272.597 > 0.3
2025-10-26 00:09:38,322 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,325 - EACAgent.Guardrails - WARNING - High price burden ratio: 135.491 > 0.3
2025-10-26 00:09:38,325 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,329 - EACAgent.Guardrails - WARNING - High price burden ratio: 260.626 > 0.3
2025-10-26 00:09:38,329 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:38,329 - EACAgent - INFO - Checkout processed: user=user_49, policy=snap_wic_substitution, recs=0, latency=3.58ms
2025-10-26 00:09:38,337 - EACAgent.Guardrails - WARNING - High price burden ratio: 324.257 > 0.3
2025-10-26 00:09:38,337 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,341 - EACAgent.Guardrails - WARNING - High price burden ratio: 149.903 > 0.3
2025-10-26 00:09:38,341 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:38,341 - EACAgent - INFO - Checkout processed: user=user_51, policy=snap_wic_substitution, recs=0, latency=4.36ms
2025-10-26 00:09:38,346 - EACAgent.Guardrails - WARNING - High price burden ratio: 257.268 > 0.3
2025-10-26 00:09:38,346 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,350 - EACAgent.Guardrails - WARNING - High price burden ratio: 371.645 > 0.3
2025-10-26 00:09:38,350 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,353 - EACAgent.Guardrails - WARNING - High price burden ratio: 216.967 > 0.3
2025-10-26 00:09:38,353 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,356 - EACAgent.Guardrails - WARNING - High price burden ratio: 236.959 > 0.3
2025-10-26 00:09:38,356 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,358 - EACAgent.Guardrails - WARNING - High price burden ratio: 261.942 > 0.3
2025-10-26 00:09:38,358 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,362 - EACAgent.Guardrails - WARNING - High price burden ratio: 286.787 > 0.3
2025-10-26 00:09:38,362 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,367 - EACAgent.Guardrails - WARNING - High price burden ratio: 127.010 > 0.3
2025-10-26 00:09:38,367 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,372 - EACAgent.Guardrails - WARNING - High price burden ratio: 402.855 > 0.3
2025-10-26 00:09:38,372 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,379 - EACAgent.Guardrails - WARNING - High price burden ratio: 329.800 > 0.3
2025-10-26 00:09:38,379 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,383 - EACAgent.Guardrails - WARNING - High price burden ratio: 225.339 > 0.3
2025-10-26 00:09:38,383 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,386 - EACAgent.Guardrails - WARNING - High price burden ratio: 282.156 > 0.3
2025-10-26 00:09:38,386 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,391 - EACAgent.Guardrails - WARNING - High price burden ratio: 348.087 > 0.3
2025-10-26 00:09:38,391 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:38,391 - EACAgent - INFO - Checkout processed: user=user_63, policy=snap_wic_substitution, recs=1, latency=4.83ms
2025-10-26 00:09:38,395 - EACAgent.Guardrails - WARNING - High price burden ratio: 202.049 > 0.3
2025-10-26 00:09:38,395 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,399 - EACAgent.Guardrails - WARNING - High price burden ratio: 238.976 > 0.3
2025-10-26 00:09:38,399 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,404 - EACAgent.Guardrails - WARNING - High price burden ratio: 424.518 > 0.3
2025-10-26 00:09:38,404 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,408 - EACAgent.Guardrails - WARNING - High price burden ratio: 102.870 > 0.3
2025-10-26 00:09:38,408 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,414 - EACAgent.Guardrails - WARNING - High price burden ratio: 382.598 > 0.3
2025-10-26 00:09:38,414 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,419 - EACAgent.Guardrails - WARNING - High price burden ratio: 156.820 > 0.3
2025-10-26 00:09:38,419 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,422 - EACAgent.Guardrails - WARNING - High price burden ratio: 145.206 > 0.3
2025-10-26 00:09:38,422 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:38,422 - EACAgent - INFO - Checkout processed: user=user_70, policy=snap_wic_substitution, recs=1, latency=3.12ms
2025-10-26 00:09:38,425 - EACAgent.Guardrails - WARNING - High price burden ratio: 150.686 > 0.3
2025-10-26 00:09:38,425 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:38,425 - EACAgent - INFO - Checkout processed: user=user_71, policy=snap_wic_substitution, recs=0, latency=2.92ms
2025-10-26 00:09:38,429 - EACAgent.Guardrails - WARNING - High price burden ratio: 165.299 > 0.3
2025-10-26 00:09:38,429 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:38,430 - EACAgent - INFO - Checkout processed: user=user_72, policy=snap_wic_substitution, recs=1, latency=4.27ms
2025-10-26 00:09:38,434 - EACAgent.Guardrails - WARNING - High price burden ratio: 269.969 > 0.3
2025-10-26 00:09:38,434 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,437 - EACAgent.Guardrails - WARNING - High price burden ratio: 488.758 > 0.3
2025-10-26 00:09:38,437 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 2 SNAP/WIC recommendations
2025-10-26 00:09:38,437 - EACAgent - INFO - Checkout processed: user=user_74, policy=snap_wic_substitution, recs=2, latency=2.72ms
2025-10-26 00:09:38,442 - EACAgent.Guardrails - WARNING - High price burden ratio: 383.042 > 0.3
2025-10-26 00:09:38,442 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,446 - EACAgent.Guardrails - WARNING - High price burden ratio: 170.388 > 0.3
2025-10-26 00:09:38,446 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:38,447 - EACAgent - INFO - Checkout processed: user=user_76, policy=snap_wic_substitution, recs=0, latency=4.49ms
2025-10-26 00:09:38,451 - EACAgent.Guardrails - WARNING - High price burden ratio: 63.759 > 0.3
2025-10-26 00:09:38,451 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,454 - EACAgent.Guardrails - WARNING - High price burden ratio: 195.313 > 0.3
2025-10-26 00:09:38,454 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,457 - EACAgent.Guardrails - WARNING - High price burden ratio: 142.304 > 0.3
2025-10-26 00:09:38,457 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:38,457 - EACAgent - INFO - Checkout processed: user=user_79, policy=snap_wic_substitution, recs=0, latency=3.46ms
2025-10-26 00:09:38,462 - EACAgent.Guardrails - WARNING - High price burden ratio: 495.190 > 0.3
2025-10-26 00:09:38,462 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:38,462 - EACAgent - INFO - Checkout processed: user=user_80, policy=snap_wic_substitution, recs=1, latency=4.59ms
2025-10-26 00:09:38,467 - EACAgent.Guardrails - WARNING - High price burden ratio: 372.120 > 0.3
2025-10-26 00:09:38,467 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,470 - EACAgent.Guardrails - WARNING - High price burden ratio: 181.526 > 0.3
2025-10-26 00:09:38,470 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:38,470 - EACAgent - INFO - Checkout processed: user=user_82, policy=snap_wic_substitution, recs=0, latency=2.85ms
2025-10-26 00:09:38,474 - EACAgent.Guardrails - WARNING - High price burden ratio: 154.835 > 0.3
2025-10-26 00:09:38,474 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,479 - EACAgent.Guardrails - WARNING - High price burden ratio: 231.889 > 0.3
2025-10-26 00:09:38,479 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,483 - EACAgent.Guardrails - WARNING - High price burden ratio: 118.715 > 0.3
2025-10-26 00:09:38,483 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,488 - EACAgent.Guardrails - WARNING - High price burden ratio: 160.189 > 0.3
2025-10-26 00:09:38,488 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:38,489 - EACAgent - INFO - Checkout processed: user=user_86, policy=snap_wic_substitution, recs=0, latency=5.23ms
2025-10-26 00:09:38,493 - EACAgent.Guardrails - WARNING - High price burden ratio: 108.030 > 0.3
2025-10-26 00:09:38,493 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:38,493 - EACAgent - INFO - Checkout processed: user=user_87, policy=snap_wic_substitution, recs=0, latency=4.41ms
2025-10-26 00:09:38,497 - EACAgent.Guardrails - WARNING - High price burden ratio: 212.494 > 0.3
2025-10-26 00:09:38,497 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:38,498 - EACAgent - INFO - Checkout processed: user=user_88, policy=snap_wic_substitution, recs=1, latency=4.22ms
2025-10-26 00:09:38,501 - EACAgent.Guardrails - WARNING - High price burden ratio: 294.471 > 0.3
2025-10-26 00:09:38,501 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:38,501 - EACAgent - INFO - Checkout processed: user=user_89, policy=snap_wic_substitution, recs=0, latency=3.11ms
2025-10-26 00:09:38,504 - EACAgent.Guardrails - WARNING - High price burden ratio: 310.703 > 0.3
2025-10-26 00:09:38,504 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:38,504 - EACAgent - INFO - Checkout processed: user=user_90, policy=snap_wic_substitution, recs=0, latency=2.54ms
2025-10-26 00:09:38,507 - EACAgent.Guardrails - WARNING - High price burden ratio: 179.545 > 0.3
2025-10-26 00:09:38,508 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:38,508 - EACAgent - INFO - Checkout processed: user=user_91, policy=snap_wic_substitution, recs=0, latency=3.59ms
2025-10-26 00:09:38,512 - EACAgent.Guardrails - WARNING - High price burden ratio: 206.749 > 0.3
2025-10-26 00:09:38,512 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:38,512 - EACAgent - INFO - Checkout processed: user=user_92, policy=snap_wic_substitution, recs=0, latency=4.13ms
2025-10-26 00:09:38,516 - EACAgent.Guardrails - WARNING - High price burden ratio: 375.483 > 0.3
2025-10-26 00:09:38,516 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,520 - EACAgent.Guardrails - WARNING - High price burden ratio: 366.955 > 0.3
2025-10-26 00:09:38,520 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,525 - EACAgent.Guardrails - WARNING - High price burden ratio: 245.199 > 0.3
2025-10-26 00:09:38,525 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:38,525 - EACAgent - INFO - Checkout processed: user=user_95, policy=snap_wic_substitution, recs=0, latency=5.44ms
2025-10-26 00:09:38,530 - EACAgent.Guardrails - WARNING - High price burden ratio: 356.833 > 0.3
2025-10-26 00:09:38,530 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,535 - EACAgent.Guardrails - WARNING - High price burden ratio: 253.821 > 0.3
2025-10-26 00:09:38,535 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,539 - EACAgent.Guardrails - WARNING - High price burden ratio: 185.029 > 0.3
2025-10-26 00:09:38,539 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 2 SNAP/WIC recommendations
2025-10-26 00:09:38,539 - EACAgent - INFO - Checkout processed: user=user_98, policy=snap_wic_substitution, recs=2, latency=3.90ms
2025-10-26 00:09:38,546 - EACAgent.Guardrails - WARNING - High price burden ratio: 135.116 > 0.3
2025-10-26 00:09:38,546 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,554 - EACAgent.Guardrails - WARNING - High price burden ratio: 200.959 > 0.3
2025-10-26 00:09:38,554 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:38,554 - EACAgent - INFO - Checkout processed: user=user_0, policy=snap_wic_substitution, recs=0, latency=7.66ms
2025-10-26 00:09:38,563 - EACAgent.Guardrails - WARNING - High price burden ratio: 152.246 > 0.3
2025-10-26 00:09:38,563 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,569 - EACAgent.Guardrails - WARNING - High price burden ratio: 329.974 > 0.3
2025-10-26 00:09:38,570 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:38,570 - EACAgent - INFO - Checkout processed: user=user_2, policy=snap_wic_substitution, recs=0, latency=6.32ms
2025-10-26 00:09:38,575 - EACAgent.Guardrails - WARNING - High price burden ratio: 430.325 > 0.3
2025-10-26 00:09:38,575 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,580 - EACAgent.Guardrails - WARNING - High price burden ratio: 144.417 > 0.3
2025-10-26 00:09:38,580 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,585 - EACAgent.Guardrails - WARNING - High price burden ratio: 208.132 > 0.3
2025-10-26 00:09:38,585 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,589 - EACAgent.Guardrails - WARNING - High price burden ratio: 174.747 > 0.3
2025-10-26 00:09:38,589 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,595 - EACAgent.Guardrails - WARNING - High price burden ratio: 599.786 > 0.3
2025-10-26 00:09:38,596 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,600 - EACAgent.Guardrails - WARNING - High price burden ratio: 139.401 > 0.3
2025-10-26 00:09:38,600 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,604 - EACAgent.Guardrails - WARNING - High price burden ratio: 231.884 > 0.3
2025-10-26 00:09:38,605 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,608 - EACAgent.Guardrails - WARNING - High price burden ratio: 256.817 > 0.3
2025-10-26 00:09:38,608 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,613 - EACAgent.Guardrails - WARNING - High price burden ratio: 453.646 > 0.3
2025-10-26 00:09:38,613 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,616 - EACAgent.Guardrails - WARNING - High price burden ratio: 211.729 > 0.3
2025-10-26 00:09:38,616 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,621 - EACAgent.Guardrails - WARNING - High price burden ratio: 347.602 > 0.3
2025-10-26 00:09:38,621 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,625 - EACAgent.Guardrails - WARNING - High price burden ratio: 430.237 > 0.3
2025-10-26 00:09:38,625 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:38,626 - EACAgent - INFO - Checkout processed: user=user_14, policy=snap_wic_substitution, recs=1, latency=4.12ms
2025-10-26 00:09:38,630 - EACAgent.Guardrails - WARNING - High price burden ratio: 229.573 > 0.3
2025-10-26 00:09:38,630 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,635 - EACAgent.Guardrails - WARNING - High price burden ratio: 394.621 > 0.3
2025-10-26 00:09:38,635 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,641 - EACAgent.Guardrails - WARNING - High price burden ratio: 182.159 > 0.3
2025-10-26 00:09:38,641 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,646 - EACAgent.Guardrails - WARNING - High price burden ratio: 183.576 > 0.3
2025-10-26 00:09:38,647 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,651 - EACAgent.Guardrails - WARNING - High price burden ratio: 181.130 > 0.3
2025-10-26 00:09:38,651 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,658 - EACAgent.Guardrails - WARNING - High price burden ratio: 225.005 > 0.3
2025-10-26 00:09:38,659 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:38,659 - EACAgent - INFO - Checkout processed: user=user_20, policy=snap_wic_substitution, recs=1, latency=7.82ms
2025-10-26 00:09:38,664 - EACAgent.Guardrails - WARNING - High price burden ratio: 74.369 > 0.3
2025-10-26 00:09:38,664 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,669 - EACAgent.Guardrails - WARNING - High price burden ratio: 294.489 > 0.3
2025-10-26 00:09:38,669 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,674 - EACAgent.Guardrails - WARNING - High price burden ratio: 390.964 > 0.3
2025-10-26 00:09:38,674 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 2 SNAP/WIC recommendations
2025-10-26 00:09:38,674 - EACAgent - INFO - Checkout processed: user=user_23, policy=snap_wic_substitution, recs=2, latency=4.76ms
2025-10-26 00:09:38,679 - EACAgent.Guardrails - WARNING - High price burden ratio: 139.070 > 0.3
2025-10-26 00:09:38,679 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:38,679 - EACAgent - INFO - Checkout processed: user=user_24, policy=snap_wic_substitution, recs=1, latency=4.94ms
2025-10-26 00:09:38,683 - EACAgent.Guardrails - WARNING - High price burden ratio: 216.453 > 0.3
2025-10-26 00:09:38,683 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,686 - EACAgent.Guardrails - WARNING - High price burden ratio: 200.704 > 0.3
2025-10-26 00:09:38,687 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:38,687 - EACAgent - INFO - Checkout processed: user=user_26, policy=snap_wic_substitution, recs=1, latency=3.16ms
2025-10-26 00:09:38,689 - EACAgent.Guardrails - WARNING - High price burden ratio: 137.116 > 0.3
2025-10-26 00:09:38,689 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:38,689 - EACAgent - INFO - Checkout processed: user=user_27, policy=snap_wic_substitution, recs=1, latency=2.70ms
2025-10-26 00:09:38,693 - EACAgent.Guardrails - WARNING - High price burden ratio: 293.324 > 0.3
2025-10-26 00:09:38,693 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,700 - EACAgent.Guardrails - WARNING - High price burden ratio: 270.061 > 0.3
2025-10-26 00:09:38,700 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:38,700 - EACAgent - INFO - Checkout processed: user=user_29, policy=snap_wic_substitution, recs=0, latency=6.77ms
2025-10-26 00:09:38,703 - EACAgent.Guardrails - WARNING - High price burden ratio: 130.894 > 0.3
2025-10-26 00:09:38,703 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,708 - EACAgent.Guardrails - WARNING - High price burden ratio: 224.159 > 0.3
2025-10-26 00:09:38,708 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,712 - EACAgent.Guardrails - WARNING - High price burden ratio: 288.012 > 0.3
2025-10-26 00:09:38,712 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,716 - EACAgent.Guardrails - WARNING - High price burden ratio: 243.898 > 0.3
2025-10-26 00:09:38,716 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,719 - EACAgent.Guardrails - WARNING - High price burden ratio: 425.731 > 0.3
2025-10-26 00:09:38,719 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:38,719 - EACAgent - INFO - Checkout processed: user=user_34, policy=snap_wic_substitution, recs=0, latency=2.60ms
2025-10-26 00:09:38,722 - EACAgent.Guardrails - WARNING - High price burden ratio: 374.907 > 0.3
2025-10-26 00:09:38,722 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:38,722 - EACAgent - INFO - Checkout processed: user=user_35, policy=snap_wic_substitution, recs=0, latency=3.05ms
2025-10-26 00:09:38,726 - EACAgent.Guardrails - WARNING - High price burden ratio: 192.492 > 0.3
2025-10-26 00:09:38,727 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,731 - EACAgent.Guardrails - WARNING - High price burden ratio: 245.793 > 0.3
2025-10-26 00:09:38,731 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 2 SNAP/WIC recommendations
2025-10-26 00:09:38,731 - EACAgent - INFO - Checkout processed: user=user_37, policy=snap_wic_substitution, recs=2, latency=4.52ms
2025-10-26 00:09:38,738 - EACAgent.Guardrails - WARNING - High price burden ratio: 233.088 > 0.3
2025-10-26 00:09:38,739 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,743 - EACAgent.Guardrails - WARNING - High price burden ratio: 453.910 > 0.3
2025-10-26 00:09:38,743 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,746 - EACAgent.Guardrails - WARNING - High price burden ratio: 230.717 > 0.3
2025-10-26 00:09:38,746 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,750 - EACAgent.Guardrails - WARNING - High price burden ratio: 332.568 > 0.3
2025-10-26 00:09:38,750 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:38,750 - EACAgent - INFO - Checkout processed: user=user_41, policy=snap_wic_substitution, recs=1, latency=3.70ms
2025-10-26 00:09:38,754 - EACAgent.Guardrails - WARNING - High price burden ratio: 278.084 > 0.3
2025-10-26 00:09:38,754 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,757 - EACAgent.Guardrails - WARNING - High price burden ratio: 296.207 > 0.3
2025-10-26 00:09:38,758 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:38,758 - EACAgent - INFO - Checkout processed: user=user_43, policy=snap_wic_substitution, recs=0, latency=3.77ms
2025-10-26 00:09:38,762 - EACAgent.Guardrails - WARNING - High price burden ratio: 85.371 > 0.3
2025-10-26 00:09:38,763 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,767 - EACAgent.Guardrails - WARNING - High price burden ratio: 434.402 > 0.3
2025-10-26 00:09:38,767 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:38,767 - EACAgent - INFO - Checkout processed: user=user_45, policy=snap_wic_substitution, recs=0, latency=4.55ms
2025-10-26 00:09:38,771 - EACAgent.Guardrails - WARNING - High price burden ratio: 116.953 > 0.3
2025-10-26 00:09:38,771 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,775 - EACAgent.Guardrails - WARNING - High price burden ratio: 272.597 > 0.3
2025-10-26 00:09:38,775 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,779 - EACAgent.Guardrails - WARNING - High price burden ratio: 135.491 > 0.3
2025-10-26 00:09:38,779 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,784 - EACAgent.Guardrails - WARNING - High price burden ratio: 260.626 > 0.3
2025-10-26 00:09:38,784 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:38,784 - EACAgent - INFO - Checkout processed: user=user_49, policy=snap_wic_substitution, recs=0, latency=4.86ms
2025-10-26 00:09:38,789 - EACAgent.Guardrails - WARNING - High price burden ratio: 324.257 > 0.3
2025-10-26 00:09:38,789 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,793 - EACAgent.Guardrails - WARNING - High price burden ratio: 149.903 > 0.3
2025-10-26 00:09:38,793 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:38,793 - EACAgent - INFO - Checkout processed: user=user_51, policy=snap_wic_substitution, recs=0, latency=4.22ms
2025-10-26 00:09:38,797 - EACAgent.Guardrails - WARNING - High price burden ratio: 257.268 > 0.3
2025-10-26 00:09:38,797 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,801 - EACAgent.Guardrails - WARNING - High price burden ratio: 371.645 > 0.3
2025-10-26 00:09:38,801 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,804 - EACAgent.Guardrails - WARNING - High price burden ratio: 216.967 > 0.3
2025-10-26 00:09:38,804 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,808 - EACAgent.Guardrails - WARNING - High price burden ratio: 236.959 > 0.3
2025-10-26 00:09:38,808 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,812 - EACAgent.Guardrails - WARNING - High price burden ratio: 261.942 > 0.3
2025-10-26 00:09:38,812 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,816 - EACAgent.Guardrails - WARNING - High price burden ratio: 286.787 > 0.3
2025-10-26 00:09:38,816 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,821 - EACAgent.Guardrails - WARNING - High price burden ratio: 127.010 > 0.3
2025-10-26 00:09:38,821 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,825 - EACAgent.Guardrails - WARNING - High price burden ratio: 402.855 > 0.3
2025-10-26 00:09:38,825 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,829 - EACAgent.Guardrails - WARNING - High price burden ratio: 329.800 > 0.3
2025-10-26 00:09:38,830 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,836 - EACAgent.Guardrails - WARNING - High price burden ratio: 225.339 > 0.3
2025-10-26 00:09:38,836 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,839 - EACAgent.Guardrails - WARNING - High price burden ratio: 282.156 > 0.3
2025-10-26 00:09:38,839 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,843 - EACAgent.Guardrails - WARNING - High price burden ratio: 348.087 > 0.3
2025-10-26 00:09:38,843 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:38,843 - EACAgent - INFO - Checkout processed: user=user_63, policy=snap_wic_substitution, recs=1, latency=4.25ms
2025-10-26 00:09:38,846 - EACAgent.Guardrails - WARNING - High price burden ratio: 202.049 > 0.3
2025-10-26 00:09:38,846 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,851 - EACAgent.Guardrails - WARNING - High price burden ratio: 238.976 > 0.3
2025-10-26 00:09:38,851 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,855 - EACAgent.Guardrails - WARNING - High price burden ratio: 424.518 > 0.3
2025-10-26 00:09:38,855 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,859 - EACAgent.Guardrails - WARNING - High price burden ratio: 102.870 > 0.3
2025-10-26 00:09:38,859 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,863 - EACAgent.Guardrails - WARNING - High price burden ratio: 382.598 > 0.3
2025-10-26 00:09:38,863 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,867 - EACAgent.Guardrails - WARNING - High price burden ratio: 156.820 > 0.3
2025-10-26 00:09:38,867 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,871 - EACAgent.Guardrails - WARNING - High price burden ratio: 145.206 > 0.3
2025-10-26 00:09:38,872 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:38,872 - EACAgent - INFO - Checkout processed: user=user_70, policy=snap_wic_substitution, recs=1, latency=4.35ms
2025-10-26 00:09:38,875 - EACAgent.Guardrails - WARNING - High price burden ratio: 150.686 > 0.3
2025-10-26 00:09:38,876 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:38,876 - EACAgent - INFO - Checkout processed: user=user_71, policy=snap_wic_substitution, recs=0, latency=3.61ms
2025-10-26 00:09:38,879 - EACAgent.Guardrails - WARNING - High price burden ratio: 165.299 > 0.3
2025-10-26 00:09:38,879 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:38,879 - EACAgent - INFO - Checkout processed: user=user_72, policy=snap_wic_substitution, recs=1, latency=3.61ms
2025-10-26 00:09:38,887 - EACAgent.Guardrails - WARNING - High price burden ratio: 269.969 > 0.3
2025-10-26 00:09:38,887 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,892 - EACAgent.Guardrails - WARNING - High price burden ratio: 488.758 > 0.3
2025-10-26 00:09:38,893 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 2 SNAP/WIC recommendations
2025-10-26 00:09:38,893 - EACAgent - INFO - Checkout processed: user=user_74, policy=snap_wic_substitution, recs=2, latency=5.56ms
2025-10-26 00:09:38,897 - EACAgent.Guardrails - WARNING - High price burden ratio: 383.042 > 0.3
2025-10-26 00:09:38,897 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,901 - EACAgent.Guardrails - WARNING - High price burden ratio: 170.388 > 0.3
2025-10-26 00:09:38,901 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:38,901 - EACAgent - INFO - Checkout processed: user=user_76, policy=snap_wic_substitution, recs=0, latency=3.47ms
2025-10-26 00:09:38,905 - EACAgent.Guardrails - WARNING - High price burden ratio: 63.759 > 0.3
2025-10-26 00:09:38,905 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,910 - EACAgent.Guardrails - WARNING - High price burden ratio: 195.313 > 0.3
2025-10-26 00:09:38,910 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,913 - EACAgent.Guardrails - WARNING - High price burden ratio: 142.304 > 0.3
2025-10-26 00:09:38,913 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:38,913 - EACAgent - INFO - Checkout processed: user=user_79, policy=snap_wic_substitution, recs=0, latency=3.18ms
2025-10-26 00:09:38,918 - EACAgent.Guardrails - WARNING - High price burden ratio: 495.190 > 0.3
2025-10-26 00:09:38,918 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:38,918 - EACAgent - INFO - Checkout processed: user=user_80, policy=snap_wic_substitution, recs=1, latency=4.41ms
2025-10-26 00:09:38,921 - EACAgent.Guardrails - WARNING - High price burden ratio: 372.120 > 0.3
2025-10-26 00:09:38,921 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,925 - EACAgent.Guardrails - WARNING - High price burden ratio: 181.526 > 0.3
2025-10-26 00:09:38,925 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:38,925 - EACAgent - INFO - Checkout processed: user=user_82, policy=snap_wic_substitution, recs=0, latency=3.97ms
2025-10-26 00:09:38,929 - EACAgent.Guardrails - WARNING - High price burden ratio: 154.835 > 0.3
2025-10-26 00:09:38,929 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,933 - EACAgent.Guardrails - WARNING - High price burden ratio: 231.889 > 0.3
2025-10-26 00:09:38,934 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,937 - EACAgent.Guardrails - WARNING - High price burden ratio: 118.715 > 0.3
2025-10-26 00:09:38,937 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,942 - EACAgent.Guardrails - WARNING - High price burden ratio: 160.189 > 0.3
2025-10-26 00:09:38,942 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:38,942 - EACAgent - INFO - Checkout processed: user=user_86, policy=snap_wic_substitution, recs=0, latency=5.11ms
2025-10-26 00:09:38,947 - EACAgent.Guardrails - WARNING - High price burden ratio: 108.030 > 0.3
2025-10-26 00:09:38,947 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:38,947 - EACAgent - INFO - Checkout processed: user=user_87, policy=snap_wic_substitution, recs=0, latency=4.37ms
2025-10-26 00:09:38,950 - EACAgent.Guardrails - WARNING - High price burden ratio: 212.494 > 0.3
2025-10-26 00:09:38,951 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:38,951 - EACAgent - INFO - Checkout processed: user=user_88, policy=snap_wic_substitution, recs=1, latency=3.69ms
2025-10-26 00:09:38,953 - EACAgent.Guardrails - WARNING - High price burden ratio: 294.471 > 0.3
2025-10-26 00:09:38,953 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:38,953 - EACAgent - INFO - Checkout processed: user=user_89, policy=snap_wic_substitution, recs=0, latency=2.47ms
2025-10-26 00:09:38,956 - EACAgent.Guardrails - WARNING - High price burden ratio: 310.703 > 0.3
2025-10-26 00:09:38,956 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:38,956 - EACAgent - INFO - Checkout processed: user=user_90, policy=snap_wic_substitution, recs=0, latency=2.65ms
2025-10-26 00:09:38,959 - EACAgent.Guardrails - WARNING - High price burden ratio: 179.545 > 0.3
2025-10-26 00:09:38,959 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:38,959 - EACAgent - INFO - Checkout processed: user=user_91, policy=snap_wic_substitution, recs=0, latency=2.72ms
2025-10-26 00:09:38,963 - EACAgent.Guardrails - WARNING - High price burden ratio: 206.749 > 0.3
2025-10-26 00:09:38,963 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:38,963 - EACAgent - INFO - Checkout processed: user=user_92, policy=snap_wic_substitution, recs=0, latency=3.75ms
2025-10-26 00:09:38,967 - EACAgent.Guardrails - WARNING - High price burden ratio: 375.483 > 0.3
2025-10-26 00:09:38,968 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,972 - EACAgent.Guardrails - WARNING - High price burden ratio: 366.955 > 0.3
2025-10-26 00:09:38,972 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,976 - EACAgent.Guardrails - WARNING - High price burden ratio: 245.199 > 0.3
2025-10-26 00:09:38,976 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:38,976 - EACAgent - INFO - Checkout processed: user=user_95, policy=snap_wic_substitution, recs=0, latency=3.44ms
2025-10-26 00:09:38,979 - EACAgent.Guardrails - WARNING - High price burden ratio: 356.833 > 0.3
2025-10-26 00:09:38,979 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,983 - EACAgent.Guardrails - WARNING - High price burden ratio: 253.821 > 0.3
2025-10-26 00:09:38,983 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,986 - EACAgent.Guardrails - WARNING - High price burden ratio: 185.029 > 0.3
2025-10-26 00:09:38,986 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 2 SNAP/WIC recommendations
2025-10-26 00:09:38,986 - EACAgent - INFO - Checkout processed: user=user_98, policy=snap_wic_substitution, recs=2, latency=2.62ms
2025-10-26 00:09:38,988 - EACAgent.Guardrails - WARNING - High price burden ratio: 135.116 > 0.3
2025-10-26 00:09:38,988 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:38,992 - EACAgent.Guardrails - WARNING - High price burden ratio: 200.959 > 0.3
2025-10-26 00:09:38,992 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:38,992 - EACAgent - INFO - Checkout processed: user=user_0, policy=snap_wic_substitution, recs=0, latency=3.53ms
2025-10-26 00:09:38,997 - EACAgent.Guardrails - WARNING - High price burden ratio: 152.246 > 0.3
2025-10-26 00:09:38,997 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,003 - EACAgent.Guardrails - WARNING - High price burden ratio: 329.974 > 0.3
2025-10-26 00:09:39,003 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:39,003 - EACAgent - INFO - Checkout processed: user=user_2, policy=snap_wic_substitution, recs=0, latency=5.97ms
2025-10-26 00:09:39,012 - EACAgent.Guardrails - WARNING - High price burden ratio: 430.325 > 0.3
2025-10-26 00:09:39,012 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,016 - EACAgent.Guardrails - WARNING - High price burden ratio: 144.417 > 0.3
2025-10-26 00:09:39,017 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,021 - EACAgent.Guardrails - WARNING - High price burden ratio: 208.132 > 0.3
2025-10-26 00:09:39,021 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,026 - EACAgent.Guardrails - WARNING - High price burden ratio: 174.747 > 0.3
2025-10-26 00:09:39,026 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,029 - EACAgent.Guardrails - WARNING - High price burden ratio: 599.786 > 0.3
2025-10-26 00:09:39,029 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,033 - EACAgent.Guardrails - WARNING - High price burden ratio: 139.401 > 0.3
2025-10-26 00:09:39,033 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,036 - EACAgent.Guardrails - WARNING - High price burden ratio: 231.884 > 0.3
2025-10-26 00:09:39,036 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,039 - EACAgent.Guardrails - WARNING - High price burden ratio: 256.817 > 0.3
2025-10-26 00:09:39,039 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,043 - EACAgent.Guardrails - WARNING - High price burden ratio: 453.646 > 0.3
2025-10-26 00:09:39,043 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,046 - EACAgent.Guardrails - WARNING - High price burden ratio: 211.729 > 0.3
2025-10-26 00:09:39,046 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,050 - EACAgent.Guardrails - WARNING - High price burden ratio: 347.602 > 0.3
2025-10-26 00:09:39,050 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,054 - EACAgent.Guardrails - WARNING - High price burden ratio: 430.237 > 0.3
2025-10-26 00:09:39,054 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:39,054 - EACAgent - INFO - Checkout processed: user=user_14, policy=snap_wic_substitution, recs=1, latency=4.16ms
2025-10-26 00:09:39,059 - EACAgent.Guardrails - WARNING - High price burden ratio: 229.573 > 0.3
2025-10-26 00:09:39,059 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,062 - EACAgent.Guardrails - WARNING - High price burden ratio: 394.621 > 0.3
2025-10-26 00:09:39,062 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,066 - EACAgent.Guardrails - WARNING - High price burden ratio: 182.159 > 0.3
2025-10-26 00:09:39,067 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,070 - EACAgent.Guardrails - WARNING - High price burden ratio: 183.576 > 0.3
2025-10-26 00:09:39,070 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,076 - EACAgent.Guardrails - WARNING - High price burden ratio: 181.130 > 0.3
2025-10-26 00:09:39,076 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,081 - EACAgent.Guardrails - WARNING - High price burden ratio: 225.005 > 0.3
2025-10-26 00:09:39,081 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:39,081 - EACAgent - INFO - Checkout processed: user=user_20, policy=snap_wic_substitution, recs=1, latency=4.50ms
2025-10-26 00:09:39,086 - EACAgent.Guardrails - WARNING - High price burden ratio: 74.369 > 0.3
2025-10-26 00:09:39,086 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,090 - EACAgent.Guardrails - WARNING - High price burden ratio: 294.489 > 0.3
2025-10-26 00:09:39,090 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,096 - EACAgent.Guardrails - WARNING - High price burden ratio: 390.964 > 0.3
2025-10-26 00:09:39,096 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 2 SNAP/WIC recommendations
2025-10-26 00:09:39,096 - EACAgent - INFO - Checkout processed: user=user_23, policy=snap_wic_substitution, recs=2, latency=5.75ms
2025-10-26 00:09:39,104 - EACAgent.Guardrails - WARNING - High price burden ratio: 139.070 > 0.3
2025-10-26 00:09:39,105 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:39,105 - EACAgent - INFO - Checkout processed: user=user_24, policy=snap_wic_substitution, recs=1, latency=7.74ms
2025-10-26 00:09:39,113 - EACAgent.Guardrails - WARNING - High price burden ratio: 216.453 > 0.3
2025-10-26 00:09:39,113 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,118 - EACAgent.Guardrails - WARNING - High price burden ratio: 200.704 > 0.3
2025-10-26 00:09:39,118 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:39,118 - EACAgent - INFO - Checkout processed: user=user_26, policy=snap_wic_substitution, recs=1, latency=4.94ms
2025-10-26 00:09:39,122 - EACAgent.Guardrails - WARNING - High price burden ratio: 137.116 > 0.3
2025-10-26 00:09:39,123 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:39,123 - EACAgent - INFO - Checkout processed: user=user_27, policy=snap_wic_substitution, recs=1, latency=4.02ms
2025-10-26 00:09:39,126 - EACAgent.Guardrails - WARNING - High price burden ratio: 293.324 > 0.3
2025-10-26 00:09:39,126 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,129 - EACAgent.Guardrails - WARNING - High price burden ratio: 270.061 > 0.3
2025-10-26 00:09:39,129 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:39,129 - EACAgent - INFO - Checkout processed: user=user_29, policy=snap_wic_substitution, recs=0, latency=3.11ms
2025-10-26 00:09:39,133 - EACAgent.Guardrails - WARNING - High price burden ratio: 130.894 > 0.3
2025-10-26 00:09:39,133 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,137 - EACAgent.Guardrails - WARNING - High price burden ratio: 224.159 > 0.3
2025-10-26 00:09:39,137 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,142 - EACAgent.Guardrails - WARNING - High price burden ratio: 288.012 > 0.3
2025-10-26 00:09:39,142 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,147 - EACAgent.Guardrails - WARNING - High price burden ratio: 243.898 > 0.3
2025-10-26 00:09:39,147 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,151 - EACAgent.Guardrails - WARNING - High price burden ratio: 425.731 > 0.3
2025-10-26 00:09:39,151 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:39,151 - EACAgent - INFO - Checkout processed: user=user_34, policy=snap_wic_substitution, recs=0, latency=3.93ms
2025-10-26 00:09:39,154 - EACAgent.Guardrails - WARNING - High price burden ratio: 374.907 > 0.3
2025-10-26 00:09:39,155 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:39,155 - EACAgent - INFO - Checkout processed: user=user_35, policy=snap_wic_substitution, recs=0, latency=2.89ms
2025-10-26 00:09:39,158 - EACAgent.Guardrails - WARNING - High price burden ratio: 192.492 > 0.3
2025-10-26 00:09:39,158 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,163 - EACAgent.Guardrails - WARNING - High price burden ratio: 245.793 > 0.3
2025-10-26 00:09:39,163 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 2 SNAP/WIC recommendations
2025-10-26 00:09:39,163 - EACAgent - INFO - Checkout processed: user=user_37, policy=snap_wic_substitution, recs=2, latency=4.61ms
2025-10-26 00:09:39,167 - EACAgent.Guardrails - WARNING - High price burden ratio: 233.088 > 0.3
2025-10-26 00:09:39,167 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,170 - EACAgent.Guardrails - WARNING - High price burden ratio: 453.910 > 0.3
2025-10-26 00:09:39,170 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,174 - EACAgent.Guardrails - WARNING - High price burden ratio: 230.717 > 0.3
2025-10-26 00:09:39,174 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,179 - EACAgent.Guardrails - WARNING - High price burden ratio: 332.568 > 0.3
2025-10-26 00:09:39,179 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:39,179 - EACAgent - INFO - Checkout processed: user=user_41, policy=snap_wic_substitution, recs=1, latency=5.12ms
2025-10-26 00:09:39,184 - EACAgent.Guardrails - WARNING - High price burden ratio: 278.084 > 0.3
2025-10-26 00:09:39,184 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,188 - EACAgent.Guardrails - WARNING - High price burden ratio: 296.207 > 0.3
2025-10-26 00:09:39,188 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:39,188 - EACAgent - INFO - Checkout processed: user=user_43, policy=snap_wic_substitution, recs=0, latency=4.02ms
2025-10-26 00:09:39,192 - EACAgent.Guardrails - WARNING - High price burden ratio: 85.371 > 0.3
2025-10-26 00:09:39,192 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,196 - EACAgent.Guardrails - WARNING - High price burden ratio: 434.402 > 0.3
2025-10-26 00:09:39,196 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:39,196 - EACAgent - INFO - Checkout processed: user=user_45, policy=snap_wic_substitution, recs=0, latency=3.98ms
2025-10-26 00:09:39,200 - EACAgent.Guardrails - WARNING - High price burden ratio: 116.953 > 0.3
2025-10-26 00:09:39,200 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,202 - EACAgent.Guardrails - WARNING - High price burden ratio: 272.597 > 0.3
2025-10-26 00:09:39,203 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,206 - EACAgent.Guardrails - WARNING - High price burden ratio: 135.491 > 0.3
2025-10-26 00:09:39,206 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,210 - EACAgent.Guardrails - WARNING - High price burden ratio: 260.626 > 0.3
2025-10-26 00:09:39,210 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:39,210 - EACAgent - INFO - Checkout processed: user=user_49, policy=snap_wic_substitution, recs=0, latency=4.25ms
2025-10-26 00:09:39,213 - EACAgent.Guardrails - WARNING - High price burden ratio: 324.257 > 0.3
2025-10-26 00:09:39,213 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,216 - EACAgent.Guardrails - WARNING - High price burden ratio: 149.903 > 0.3
2025-10-26 00:09:39,217 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:39,217 - EACAgent - INFO - Checkout processed: user=user_51, policy=snap_wic_substitution, recs=0, latency=3.26ms
2025-10-26 00:09:39,219 - EACAgent.Guardrails - WARNING - High price burden ratio: 257.268 > 0.3
2025-10-26 00:09:39,219 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,222 - EACAgent.Guardrails - WARNING - High price burden ratio: 371.645 > 0.3
2025-10-26 00:09:39,222 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,225 - EACAgent.Guardrails - WARNING - High price burden ratio: 216.967 > 0.3
2025-10-26 00:09:39,225 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,229 - EACAgent.Guardrails - WARNING - High price burden ratio: 236.959 > 0.3
2025-10-26 00:09:39,229 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,233 - EACAgent.Guardrails - WARNING - High price burden ratio: 261.942 > 0.3
2025-10-26 00:09:39,233 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,236 - EACAgent.Guardrails - WARNING - High price burden ratio: 286.787 > 0.3
2025-10-26 00:09:39,236 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,238 - EACAgent.Guardrails - WARNING - High price burden ratio: 127.010 > 0.3
2025-10-26 00:09:39,238 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,242 - EACAgent.Guardrails - WARNING - High price burden ratio: 402.855 > 0.3
2025-10-26 00:09:39,242 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,246 - EACAgent.Guardrails - WARNING - High price burden ratio: 329.800 > 0.3
2025-10-26 00:09:39,246 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,249 - EACAgent.Guardrails - WARNING - High price burden ratio: 225.339 > 0.3
2025-10-26 00:09:39,249 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,252 - EACAgent.Guardrails - WARNING - High price burden ratio: 282.156 > 0.3
2025-10-26 00:09:39,252 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,255 - EACAgent.Guardrails - WARNING - High price burden ratio: 348.087 > 0.3
2025-10-26 00:09:39,255 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:39,255 - EACAgent - INFO - Checkout processed: user=user_63, policy=snap_wic_substitution, recs=1, latency=2.80ms
2025-10-26 00:09:39,258 - EACAgent.Guardrails - WARNING - High price burden ratio: 202.049 > 0.3
2025-10-26 00:09:39,258 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,262 - EACAgent.Guardrails - WARNING - High price burden ratio: 238.976 > 0.3
2025-10-26 00:09:39,263 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,267 - EACAgent.Guardrails - WARNING - High price burden ratio: 424.518 > 0.3
2025-10-26 00:09:39,267 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,271 - EACAgent.Guardrails - WARNING - High price burden ratio: 102.870 > 0.3
2025-10-26 00:09:39,271 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,275 - EACAgent.Guardrails - WARNING - High price burden ratio: 382.598 > 0.3
2025-10-26 00:09:39,275 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,280 - EACAgent.Guardrails - WARNING - High price burden ratio: 156.820 > 0.3
2025-10-26 00:09:39,280 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,284 - EACAgent.Guardrails - WARNING - High price burden ratio: 145.206 > 0.3
2025-10-26 00:09:39,284 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:39,284 - EACAgent - INFO - Checkout processed: user=user_70, policy=snap_wic_substitution, recs=1, latency=4.02ms
2025-10-26 00:09:39,288 - EACAgent.Guardrails - WARNING - High price burden ratio: 150.686 > 0.3
2025-10-26 00:09:39,289 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:39,289 - EACAgent - INFO - Checkout processed: user=user_71, policy=snap_wic_substitution, recs=0, latency=4.36ms
2025-10-26 00:09:39,292 - EACAgent.Guardrails - WARNING - High price burden ratio: 165.299 > 0.3
2025-10-26 00:09:39,293 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:39,293 - EACAgent - INFO - Checkout processed: user=user_72, policy=snap_wic_substitution, recs=1, latency=3.59ms
2025-10-26 00:09:39,296 - EACAgent.Guardrails - WARNING - High price burden ratio: 269.969 > 0.3
2025-10-26 00:09:39,296 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,299 - EACAgent.Guardrails - WARNING - High price burden ratio: 488.758 > 0.3
2025-10-26 00:09:39,300 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 2 SNAP/WIC recommendations
2025-10-26 00:09:39,300 - EACAgent - INFO - Checkout processed: user=user_74, policy=snap_wic_substitution, recs=2, latency=3.78ms
2025-10-26 00:09:39,303 - EACAgent.Guardrails - WARNING - High price burden ratio: 383.042 > 0.3
2025-10-26 00:09:39,303 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,306 - EACAgent.Guardrails - WARNING - High price burden ratio: 170.388 > 0.3
2025-10-26 00:09:39,306 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:39,306 - EACAgent - INFO - Checkout processed: user=user_76, policy=snap_wic_substitution, recs=0, latency=2.83ms
2025-10-26 00:09:39,313 - EACAgent.Guardrails - WARNING - High price burden ratio: 63.759 > 0.3
2025-10-26 00:09:39,313 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,319 - EACAgent.Guardrails - WARNING - High price burden ratio: 195.313 > 0.3
2025-10-26 00:09:39,319 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,325 - EACAgent.Guardrails - WARNING - High price burden ratio: 142.304 > 0.3
2025-10-26 00:09:39,325 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:39,325 - EACAgent - INFO - Checkout processed: user=user_79, policy=snap_wic_substitution, recs=0, latency=5.33ms
2025-10-26 00:09:39,329 - EACAgent.Guardrails - WARNING - High price burden ratio: 495.190 > 0.3
2025-10-26 00:09:39,330 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:39,330 - EACAgent - INFO - Checkout processed: user=user_80, policy=snap_wic_substitution, recs=1, latency=4.41ms
2025-10-26 00:09:39,334 - EACAgent.Guardrails - WARNING - High price burden ratio: 372.120 > 0.3
2025-10-26 00:09:39,334 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,338 - EACAgent.Guardrails - WARNING - High price burden ratio: 181.526 > 0.3
2025-10-26 00:09:39,339 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:39,339 - EACAgent - INFO - Checkout processed: user=user_82, policy=snap_wic_substitution, recs=0, latency=4.55ms
2025-10-26 00:09:39,342 - EACAgent.Guardrails - WARNING - High price burden ratio: 154.835 > 0.3
2025-10-26 00:09:39,342 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,347 - EACAgent.Guardrails - WARNING - High price burden ratio: 231.889 > 0.3
2025-10-26 00:09:39,347 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,351 - EACAgent.Guardrails - WARNING - High price burden ratio: 118.715 > 0.3
2025-10-26 00:09:39,352 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,355 - EACAgent.Guardrails - WARNING - High price burden ratio: 160.189 > 0.3
2025-10-26 00:09:39,355 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:39,355 - EACAgent - INFO - Checkout processed: user=user_86, policy=snap_wic_substitution, recs=0, latency=3.01ms
2025-10-26 00:09:39,359 - EACAgent.Guardrails - WARNING - High price burden ratio: 108.030 > 0.3
2025-10-26 00:09:39,359 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:39,359 - EACAgent - INFO - Checkout processed: user=user_87, policy=snap_wic_substitution, recs=0, latency=3.96ms
2025-10-26 00:09:39,362 - EACAgent.Guardrails - WARNING - High price burden ratio: 212.494 > 0.3
2025-10-26 00:09:39,363 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:39,363 - EACAgent - INFO - Checkout processed: user=user_88, policy=snap_wic_substitution, recs=1, latency=3.51ms
2025-10-26 00:09:39,366 - EACAgent.Guardrails - WARNING - High price burden ratio: 294.471 > 0.3
2025-10-26 00:09:39,367 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:39,367 - EACAgent - INFO - Checkout processed: user=user_89, policy=snap_wic_substitution, recs=0, latency=3.79ms
2025-10-26 00:09:39,369 - EACAgent.Guardrails - WARNING - High price burden ratio: 310.703 > 0.3
2025-10-26 00:09:39,369 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:39,369 - EACAgent - INFO - Checkout processed: user=user_90, policy=snap_wic_substitution, recs=0, latency=2.70ms
2025-10-26 00:09:39,372 - EACAgent.Guardrails - WARNING - High price burden ratio: 179.545 > 0.3
2025-10-26 00:09:39,372 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:39,372 - EACAgent - INFO - Checkout processed: user=user_91, policy=snap_wic_substitution, recs=0, latency=2.43ms
2025-10-26 00:09:39,375 - EACAgent.Guardrails - WARNING - High price burden ratio: 206.749 > 0.3
2025-10-26 00:09:39,375 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:39,375 - EACAgent - INFO - Checkout processed: user=user_92, policy=snap_wic_substitution, recs=0, latency=3.21ms
2025-10-26 00:09:39,380 - EACAgent.Guardrails - WARNING - High price burden ratio: 375.483 > 0.3
2025-10-26 00:09:39,380 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,387 - EACAgent.Guardrails - WARNING - High price burden ratio: 366.955 > 0.3
2025-10-26 00:09:39,387 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,391 - EACAgent.Guardrails - WARNING - High price burden ratio: 245.199 > 0.3
2025-10-26 00:09:39,391 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:39,391 - EACAgent - INFO - Checkout processed: user=user_95, policy=snap_wic_substitution, recs=0, latency=4.21ms
2025-10-26 00:09:39,396 - EACAgent.Guardrails - WARNING - High price burden ratio: 356.833 > 0.3
2025-10-26 00:09:39,396 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,400 - EACAgent.Guardrails - WARNING - High price burden ratio: 253.821 > 0.3
2025-10-26 00:09:39,400 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,404 - EACAgent.Guardrails - WARNING - High price burden ratio: 185.029 > 0.3
2025-10-26 00:09:39,405 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 2 SNAP/WIC recommendations
2025-10-26 00:09:39,405 - EACAgent - INFO - Checkout processed: user=user_98, policy=snap_wic_substitution, recs=2, latency=4.45ms
2025-10-26 00:09:39,408 - EACAgent.Guardrails - WARNING - High price burden ratio: 135.116 > 0.3
2025-10-26 00:09:39,408 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,413 - EACAgent.Guardrails - WARNING - High price burden ratio: 200.959 > 0.3
2025-10-26 00:09:39,413 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:39,413 - EACAgent - INFO - Checkout processed: user=user_0, policy=snap_wic_substitution, recs=0, latency=4.45ms
2025-10-26 00:09:39,420 - EACAgent.Guardrails - WARNING - High price burden ratio: 152.246 > 0.3
2025-10-26 00:09:39,420 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,433 - EACAgent.Guardrails - WARNING - High price burden ratio: 329.974 > 0.3
2025-10-26 00:09:39,433 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:39,433 - EACAgent - INFO - Checkout processed: user=user_2, policy=snap_wic_substitution, recs=0, latency=12.77ms
2025-10-26 00:09:39,436 - EACAgent.Guardrails - WARNING - High price burden ratio: 430.325 > 0.3
2025-10-26 00:09:39,436 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,439 - EACAgent.Guardrails - WARNING - High price burden ratio: 144.417 > 0.3
2025-10-26 00:09:39,439 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,445 - EACAgent.Guardrails - WARNING - High price burden ratio: 208.132 > 0.3
2025-10-26 00:09:39,445 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,450 - EACAgent.Guardrails - WARNING - High price burden ratio: 174.747 > 0.3
2025-10-26 00:09:39,450 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,454 - EACAgent.Guardrails - WARNING - High price burden ratio: 599.786 > 0.3
2025-10-26 00:09:39,454 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,458 - EACAgent.Guardrails - WARNING - High price burden ratio: 139.401 > 0.3
2025-10-26 00:09:39,459 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,466 - EACAgent.Guardrails - WARNING - High price burden ratio: 231.884 > 0.3
2025-10-26 00:09:39,466 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,469 - EACAgent.Guardrails - WARNING - High price burden ratio: 256.817 > 0.3
2025-10-26 00:09:39,469 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,471 - EACAgent.Guardrails - WARNING - High price burden ratio: 453.646 > 0.3
2025-10-26 00:09:39,471 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,475 - EACAgent.Guardrails - WARNING - High price burden ratio: 211.729 > 0.3
2025-10-26 00:09:39,475 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,479 - EACAgent.Guardrails - WARNING - High price burden ratio: 347.602 > 0.3
2025-10-26 00:09:39,479 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,483 - EACAgent.Guardrails - WARNING - High price burden ratio: 430.237 > 0.3
2025-10-26 00:09:39,483 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:39,484 - EACAgent - INFO - Checkout processed: user=user_14, policy=snap_wic_substitution, recs=1, latency=3.98ms
2025-10-26 00:09:39,488 - EACAgent.Guardrails - WARNING - High price burden ratio: 229.573 > 0.3
2025-10-26 00:09:39,488 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,492 - EACAgent.Guardrails - WARNING - High price burden ratio: 394.621 > 0.3
2025-10-26 00:09:39,492 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,496 - EACAgent.Guardrails - WARNING - High price burden ratio: 182.159 > 0.3
2025-10-26 00:09:39,496 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,500 - EACAgent.Guardrails - WARNING - High price burden ratio: 183.576 > 0.3
2025-10-26 00:09:39,500 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,505 - EACAgent.Guardrails - WARNING - High price burden ratio: 181.130 > 0.3
2025-10-26 00:09:39,505 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,509 - EACAgent.Guardrails - WARNING - High price burden ratio: 225.005 > 0.3
2025-10-26 00:09:39,509 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:39,509 - EACAgent - INFO - Checkout processed: user=user_20, policy=snap_wic_substitution, recs=1, latency=4.02ms
2025-10-26 00:09:39,513 - EACAgent.Guardrails - WARNING - High price burden ratio: 74.369 > 0.3
2025-10-26 00:09:39,513 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,519 - EACAgent.Guardrails - WARNING - High price burden ratio: 294.489 > 0.3
2025-10-26 00:09:39,519 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,522 - EACAgent.Guardrails - WARNING - High price burden ratio: 390.964 > 0.3
2025-10-26 00:09:39,522 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 2 SNAP/WIC recommendations
2025-10-26 00:09:39,522 - EACAgent - INFO - Checkout processed: user=user_23, policy=snap_wic_substitution, recs=2, latency=2.70ms
2025-10-26 00:09:39,529 - EACAgent.Guardrails - WARNING - High price burden ratio: 139.070 > 0.3
2025-10-26 00:09:39,529 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:39,529 - EACAgent - INFO - Checkout processed: user=user_24, policy=snap_wic_substitution, recs=1, latency=6.37ms
2025-10-26 00:09:39,533 - EACAgent.Guardrails - WARNING - High price burden ratio: 216.453 > 0.3
2025-10-26 00:09:39,533 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,537 - EACAgent.Guardrails - WARNING - High price burden ratio: 200.704 > 0.3
2025-10-26 00:09:39,537 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:39,537 - EACAgent - INFO - Checkout processed: user=user_26, policy=snap_wic_substitution, recs=1, latency=4.10ms
2025-10-26 00:09:39,541 - EACAgent.Guardrails - WARNING - High price burden ratio: 137.116 > 0.3
2025-10-26 00:09:39,541 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:39,541 - EACAgent - INFO - Checkout processed: user=user_27, policy=snap_wic_substitution, recs=1, latency=3.77ms
2025-10-26 00:09:39,545 - EACAgent.Guardrails - WARNING - High price burden ratio: 293.324 > 0.3
2025-10-26 00:09:39,545 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,549 - EACAgent.Guardrails - WARNING - High price burden ratio: 270.061 > 0.3
2025-10-26 00:09:39,550 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:39,550 - EACAgent - INFO - Checkout processed: user=user_29, policy=snap_wic_substitution, recs=0, latency=4.38ms
2025-10-26 00:09:39,554 - EACAgent.Guardrails - WARNING - High price burden ratio: 130.894 > 0.3
2025-10-26 00:09:39,554 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,558 - EACAgent.Guardrails - WARNING - High price burden ratio: 224.159 > 0.3
2025-10-26 00:09:39,558 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,562 - EACAgent.Guardrails - WARNING - High price burden ratio: 288.012 > 0.3
2025-10-26 00:09:39,562 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,566 - EACAgent.Guardrails - WARNING - High price burden ratio: 243.898 > 0.3
2025-10-26 00:09:39,566 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,569 - EACAgent.Guardrails - WARNING - High price burden ratio: 425.731 > 0.3
2025-10-26 00:09:39,569 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:39,569 - EACAgent - INFO - Checkout processed: user=user_34, policy=snap_wic_substitution, recs=0, latency=2.61ms
2025-10-26 00:09:39,574 - EACAgent.Guardrails - WARNING - High price burden ratio: 374.907 > 0.3
2025-10-26 00:09:39,574 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:39,575 - EACAgent - INFO - Checkout processed: user=user_35, policy=snap_wic_substitution, recs=0, latency=5.21ms
2025-10-26 00:09:39,579 - EACAgent.Guardrails - WARNING - High price burden ratio: 192.492 > 0.3
2025-10-26 00:09:39,579 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,583 - EACAgent.Guardrails - WARNING - High price burden ratio: 245.793 > 0.3
2025-10-26 00:09:39,583 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 2 SNAP/WIC recommendations
2025-10-26 00:09:39,584 - EACAgent - INFO - Checkout processed: user=user_37, policy=snap_wic_substitution, recs=2, latency=4.27ms
2025-10-26 00:09:39,586 - EACAgent.Guardrails - WARNING - High price burden ratio: 233.088 > 0.3
2025-10-26 00:09:39,586 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,590 - EACAgent.Guardrails - WARNING - High price burden ratio: 453.910 > 0.3
2025-10-26 00:09:39,591 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,595 - EACAgent.Guardrails - WARNING - High price burden ratio: 230.717 > 0.3
2025-10-26 00:09:39,595 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,597 - EACAgent.Guardrails - WARNING - High price burden ratio: 332.568 > 0.3
2025-10-26 00:09:39,597 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:39,598 - EACAgent - INFO - Checkout processed: user=user_41, policy=snap_wic_substitution, recs=1, latency=2.46ms
2025-10-26 00:09:39,600 - EACAgent.Guardrails - WARNING - High price burden ratio: 278.084 > 0.3
2025-10-26 00:09:39,600 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,604 - EACAgent.Guardrails - WARNING - High price burden ratio: 296.207 > 0.3
2025-10-26 00:09:39,604 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:39,604 - EACAgent - INFO - Checkout processed: user=user_43, policy=snap_wic_substitution, recs=0, latency=3.59ms
2025-10-26 00:09:39,609 - EACAgent.Guardrails - WARNING - High price burden ratio: 85.371 > 0.3
2025-10-26 00:09:39,609 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,614 - EACAgent.Guardrails - WARNING - High price burden ratio: 434.402 > 0.3
2025-10-26 00:09:39,614 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:39,614 - EACAgent - INFO - Checkout processed: user=user_45, policy=snap_wic_substitution, recs=0, latency=5.23ms
2025-10-26 00:09:39,617 - EACAgent.Guardrails - WARNING - High price burden ratio: 116.953 > 0.3
2025-10-26 00:09:39,617 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,620 - EACAgent.Guardrails - WARNING - High price burden ratio: 272.597 > 0.3
2025-10-26 00:09:39,620 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,622 - EACAgent.Guardrails - WARNING - High price burden ratio: 135.491 > 0.3
2025-10-26 00:09:39,622 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,626 - EACAgent.Guardrails - WARNING - High price burden ratio: 260.626 > 0.3
2025-10-26 00:09:39,626 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:39,627 - EACAgent - INFO - Checkout processed: user=user_49, policy=snap_wic_substitution, recs=0, latency=4.20ms
2025-10-26 00:09:39,633 - EACAgent.Guardrails - WARNING - High price burden ratio: 324.257 > 0.3
2025-10-26 00:09:39,633 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,637 - EACAgent.Guardrails - WARNING - High price burden ratio: 149.903 > 0.3
2025-10-26 00:09:39,638 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:39,638 - EACAgent - INFO - Checkout processed: user=user_51, policy=snap_wic_substitution, recs=0, latency=4.61ms
2025-10-26 00:09:39,641 - EACAgent.Guardrails - WARNING - High price burden ratio: 257.268 > 0.3
2025-10-26 00:09:39,641 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,646 - EACAgent.Guardrails - WARNING - High price burden ratio: 371.645 > 0.3
2025-10-26 00:09:39,646 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,650 - EACAgent.Guardrails - WARNING - High price burden ratio: 216.967 > 0.3
2025-10-26 00:09:39,650 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,653 - EACAgent.Guardrails - WARNING - High price burden ratio: 236.959 > 0.3
2025-10-26 00:09:39,654 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,658 - EACAgent.Guardrails - WARNING - High price burden ratio: 261.942 > 0.3
2025-10-26 00:09:39,658 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,662 - EACAgent.Guardrails - WARNING - High price burden ratio: 286.787 > 0.3
2025-10-26 00:09:39,662 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,666 - EACAgent.Guardrails - WARNING - High price burden ratio: 127.010 > 0.3
2025-10-26 00:09:39,666 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,671 - EACAgent.Guardrails - WARNING - High price burden ratio: 402.855 > 0.3
2025-10-26 00:09:39,671 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,675 - EACAgent.Guardrails - WARNING - High price burden ratio: 329.800 > 0.3
2025-10-26 00:09:39,675 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,679 - EACAgent.Guardrails - WARNING - High price burden ratio: 225.339 > 0.3
2025-10-26 00:09:39,679 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,683 - EACAgent.Guardrails - WARNING - High price burden ratio: 282.156 > 0.3
2025-10-26 00:09:39,683 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,686 - EACAgent.Guardrails - WARNING - High price burden ratio: 348.087 > 0.3
2025-10-26 00:09:39,686 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:39,686 - EACAgent - INFO - Checkout processed: user=user_63, policy=snap_wic_substitution, recs=1, latency=2.96ms
2025-10-26 00:09:39,689 - EACAgent.Guardrails - WARNING - High price burden ratio: 202.049 > 0.3
2025-10-26 00:09:39,689 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,692 - EACAgent.Guardrails - WARNING - High price burden ratio: 238.976 > 0.3
2025-10-26 00:09:39,692 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,696 - EACAgent.Guardrails - WARNING - High price burden ratio: 424.518 > 0.3
2025-10-26 00:09:39,696 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,700 - EACAgent.Guardrails - WARNING - High price burden ratio: 102.870 > 0.3
2025-10-26 00:09:39,700 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,702 - EACAgent.Guardrails - WARNING - High price burden ratio: 382.598 > 0.3
2025-10-26 00:09:39,702 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,706 - EACAgent.Guardrails - WARNING - High price burden ratio: 156.820 > 0.3
2025-10-26 00:09:39,706 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,709 - EACAgent.Guardrails - WARNING - High price burden ratio: 145.206 > 0.3
2025-10-26 00:09:39,709 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:39,709 - EACAgent - INFO - Checkout processed: user=user_70, policy=snap_wic_substitution, recs=1, latency=3.11ms
2025-10-26 00:09:39,713 - EACAgent.Guardrails - WARNING - High price burden ratio: 150.686 > 0.3
2025-10-26 00:09:39,713 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:39,713 - EACAgent - INFO - Checkout processed: user=user_71, policy=snap_wic_substitution, recs=0, latency=3.94ms
2025-10-26 00:09:39,717 - EACAgent.Guardrails - WARNING - High price burden ratio: 165.299 > 0.3
2025-10-26 00:09:39,718 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:39,718 - EACAgent - INFO - Checkout processed: user=user_72, policy=snap_wic_substitution, recs=1, latency=3.99ms
2025-10-26 00:09:39,720 - EACAgent.Guardrails - WARNING - High price burden ratio: 269.969 > 0.3
2025-10-26 00:09:39,720 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,724 - EACAgent.Guardrails - WARNING - High price burden ratio: 488.758 > 0.3
2025-10-26 00:09:39,725 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 2 SNAP/WIC recommendations
2025-10-26 00:09:39,725 - EACAgent - INFO - Checkout processed: user=user_74, policy=snap_wic_substitution, recs=2, latency=4.11ms
2025-10-26 00:09:39,730 - EACAgent.Guardrails - WARNING - High price burden ratio: 383.042 > 0.3
2025-10-26 00:09:39,730 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,734 - EACAgent.Guardrails - WARNING - High price burden ratio: 170.388 > 0.3
2025-10-26 00:09:39,734 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:39,734 - EACAgent - INFO - Checkout processed: user=user_76, policy=snap_wic_substitution, recs=0, latency=4.07ms
2025-10-26 00:09:39,739 - EACAgent.Guardrails - WARNING - High price burden ratio: 63.759 > 0.3
2025-10-26 00:09:39,739 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,743 - EACAgent.Guardrails - WARNING - High price burden ratio: 195.313 > 0.3
2025-10-26 00:09:39,743 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,746 - EACAgent.Guardrails - WARNING - High price burden ratio: 142.304 > 0.3
2025-10-26 00:09:39,747 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:39,747 - EACAgent - INFO - Checkout processed: user=user_79, policy=snap_wic_substitution, recs=0, latency=3.14ms
2025-10-26 00:09:39,750 - EACAgent.Guardrails - WARNING - High price burden ratio: 495.190 > 0.3
2025-10-26 00:09:39,750 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:39,750 - EACAgent - INFO - Checkout processed: user=user_80, policy=snap_wic_substitution, recs=1, latency=3.56ms
2025-10-26 00:09:39,754 - EACAgent.Guardrails - WARNING - High price burden ratio: 372.120 > 0.3
2025-10-26 00:09:39,754 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,759 - EACAgent.Guardrails - WARNING - High price burden ratio: 181.526 > 0.3
2025-10-26 00:09:39,759 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:39,759 - EACAgent - INFO - Checkout processed: user=user_82, policy=snap_wic_substitution, recs=0, latency=5.04ms
2025-10-26 00:09:39,763 - EACAgent.Guardrails - WARNING - High price burden ratio: 154.835 > 0.3
2025-10-26 00:09:39,763 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,767 - EACAgent.Guardrails - WARNING - High price burden ratio: 231.889 > 0.3
2025-10-26 00:09:39,767 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,772 - EACAgent.Guardrails - WARNING - High price burden ratio: 118.715 > 0.3
2025-10-26 00:09:39,772 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,776 - EACAgent.Guardrails - WARNING - High price burden ratio: 160.189 > 0.3
2025-10-26 00:09:39,776 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:39,776 - EACAgent - INFO - Checkout processed: user=user_86, policy=snap_wic_substitution, recs=0, latency=3.49ms
2025-10-26 00:09:39,779 - EACAgent.Guardrails - WARNING - High price burden ratio: 108.030 > 0.3
2025-10-26 00:09:39,779 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:39,779 - EACAgent - INFO - Checkout processed: user=user_87, policy=snap_wic_substitution, recs=0, latency=3.38ms
2025-10-26 00:09:39,783 - EACAgent.Guardrails - WARNING - High price burden ratio: 212.494 > 0.3
2025-10-26 00:09:39,783 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:39,784 - EACAgent - INFO - Checkout processed: user=user_88, policy=snap_wic_substitution, recs=1, latency=4.09ms
2025-10-26 00:09:39,787 - EACAgent.Guardrails - WARNING - High price burden ratio: 294.471 > 0.3
2025-10-26 00:09:39,788 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:39,788 - EACAgent - INFO - Checkout processed: user=user_89, policy=snap_wic_substitution, recs=0, latency=3.91ms
2025-10-26 00:09:39,792 - EACAgent.Guardrails - WARNING - High price burden ratio: 310.703 > 0.3
2025-10-26 00:09:39,792 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:39,792 - EACAgent - INFO - Checkout processed: user=user_90, policy=snap_wic_substitution, recs=0, latency=4.16ms
2025-10-26 00:09:39,796 - EACAgent.Guardrails - WARNING - High price burden ratio: 179.545 > 0.3
2025-10-26 00:09:39,796 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:39,796 - EACAgent - INFO - Checkout processed: user=user_91, policy=snap_wic_substitution, recs=0, latency=3.95ms
2025-10-26 00:09:39,800 - EACAgent.Guardrails - WARNING - High price burden ratio: 206.749 > 0.3
2025-10-26 00:09:39,800 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:39,801 - EACAgent - INFO - Checkout processed: user=user_92, policy=snap_wic_substitution, recs=0, latency=4.00ms
2025-10-26 00:09:39,804 - EACAgent.Guardrails - WARNING - High price burden ratio: 375.483 > 0.3
2025-10-26 00:09:39,804 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,808 - EACAgent.Guardrails - WARNING - High price burden ratio: 366.955 > 0.3
2025-10-26 00:09:39,808 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,812 - EACAgent.Guardrails - WARNING - High price burden ratio: 245.199 > 0.3
2025-10-26 00:09:39,812 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:39,812 - EACAgent - INFO - Checkout processed: user=user_95, policy=snap_wic_substitution, recs=0, latency=3.84ms
2025-10-26 00:09:39,816 - EACAgent.Guardrails - WARNING - High price burden ratio: 356.833 > 0.3
2025-10-26 00:09:39,817 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,820 - EACAgent.Guardrails - WARNING - High price burden ratio: 253.821 > 0.3
2025-10-26 00:09:39,820 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,822 - EACAgent.Guardrails - WARNING - High price burden ratio: 185.029 > 0.3
2025-10-26 00:09:39,822 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 2 SNAP/WIC recommendations
2025-10-26 00:09:39,822 - EACAgent - INFO - Checkout processed: user=user_98, policy=snap_wic_substitution, recs=2, latency=2.62ms
2025-10-26 00:09:39,825 - EACAgent.Guardrails - WARNING - High price burden ratio: 135.116 > 0.3
2025-10-26 00:09:39,826 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,830 - EACAgent.Guardrails - WARNING - High price burden ratio: 200.959 > 0.3
2025-10-26 00:09:39,830 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:39,830 - EACAgent - INFO - Checkout processed: user=user_0, policy=snap_wic_substitution, recs=0, latency=4.07ms
2025-10-26 00:09:39,835 - EACAgent.Guardrails - WARNING - High price burden ratio: 152.246 > 0.3
2025-10-26 00:09:39,835 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,838 - EACAgent.Guardrails - WARNING - High price burden ratio: 329.974 > 0.3
2025-10-26 00:09:39,838 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:39,838 - EACAgent - INFO - Checkout processed: user=user_2, policy=snap_wic_substitution, recs=0, latency=2.79ms
2025-10-26 00:09:39,886 - EACAgent.Guardrails - WARNING - High price burden ratio: 430.325 > 0.3
2025-10-26 00:09:39,886 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,891 - EACAgent.Guardrails - WARNING - High price burden ratio: 144.417 > 0.3
2025-10-26 00:09:39,891 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,896 - EACAgent.Guardrails - WARNING - High price burden ratio: 208.132 > 0.3
2025-10-26 00:09:39,897 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,901 - EACAgent.Guardrails - WARNING - High price burden ratio: 174.747 > 0.3
2025-10-26 00:09:39,901 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,904 - EACAgent.Guardrails - WARNING - High price burden ratio: 599.786 > 0.3
2025-10-26 00:09:39,904 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,908 - EACAgent.Guardrails - WARNING - High price burden ratio: 139.401 > 0.3
2025-10-26 00:09:39,909 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,913 - EACAgent.Guardrails - WARNING - High price burden ratio: 231.884 > 0.3
2025-10-26 00:09:39,913 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,917 - EACAgent.Guardrails - WARNING - High price burden ratio: 256.817 > 0.3
2025-10-26 00:09:39,917 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,921 - EACAgent.Guardrails - WARNING - High price burden ratio: 453.646 > 0.3
2025-10-26 00:09:39,921 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,925 - EACAgent.Guardrails - WARNING - High price burden ratio: 211.729 > 0.3
2025-10-26 00:09:39,925 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,929 - EACAgent.Guardrails - WARNING - High price burden ratio: 347.602 > 0.3
2025-10-26 00:09:39,929 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,933 - EACAgent.Guardrails - WARNING - High price burden ratio: 430.237 > 0.3
2025-10-26 00:09:39,933 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:39,933 - EACAgent - INFO - Checkout processed: user=user_14, policy=snap_wic_substitution, recs=1, latency=4.00ms
2025-10-26 00:09:39,936 - EACAgent.Guardrails - WARNING - High price burden ratio: 229.573 > 0.3
2025-10-26 00:09:39,936 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,941 - EACAgent.Guardrails - WARNING - High price burden ratio: 394.621 > 0.3
2025-10-26 00:09:39,941 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,946 - EACAgent.Guardrails - WARNING - High price burden ratio: 182.159 > 0.3
2025-10-26 00:09:39,946 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,953 - EACAgent.Guardrails - WARNING - High price burden ratio: 183.576 > 0.3
2025-10-26 00:09:39,953 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,959 - EACAgent.Guardrails - WARNING - High price burden ratio: 181.130 > 0.3
2025-10-26 00:09:39,959 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,962 - EACAgent.Guardrails - WARNING - High price burden ratio: 225.005 > 0.3
2025-10-26 00:09:39,962 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:39,962 - EACAgent - INFO - Checkout processed: user=user_20, policy=snap_wic_substitution, recs=1, latency=2.81ms
2025-10-26 00:09:39,967 - EACAgent.Guardrails - WARNING - High price burden ratio: 74.369 > 0.3
2025-10-26 00:09:39,967 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,970 - EACAgent.Guardrails - WARNING - High price burden ratio: 294.489 > 0.3
2025-10-26 00:09:39,970 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,973 - EACAgent.Guardrails - WARNING - High price burden ratio: 390.964 > 0.3
2025-10-26 00:09:39,973 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 2 SNAP/WIC recommendations
2025-10-26 00:09:39,974 - EACAgent - INFO - Checkout processed: user=user_23, policy=snap_wic_substitution, recs=2, latency=3.57ms
2025-10-26 00:09:39,979 - EACAgent.Guardrails - WARNING - High price burden ratio: 139.070 > 0.3
2025-10-26 00:09:39,980 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:39,980 - EACAgent - INFO - Checkout processed: user=user_24, policy=snap_wic_substitution, recs=1, latency=6.04ms
2025-10-26 00:09:39,984 - EACAgent.Guardrails - WARNING - High price burden ratio: 216.453 > 0.3
2025-10-26 00:09:39,984 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:39,989 - EACAgent.Guardrails - WARNING - High price burden ratio: 200.704 > 0.3
2025-10-26 00:09:39,989 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:39,989 - EACAgent - INFO - Checkout processed: user=user_26, policy=snap_wic_substitution, recs=1, latency=4.41ms
2025-10-26 00:09:39,993 - EACAgent.Guardrails - WARNING - High price burden ratio: 137.116 > 0.3
2025-10-26 00:09:39,993 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:39,993 - EACAgent - INFO - Checkout processed: user=user_27, policy=snap_wic_substitution, recs=1, latency=3.85ms
2025-10-26 00:09:39,998 - EACAgent.Guardrails - WARNING - High price burden ratio: 293.324 > 0.3
2025-10-26 00:09:39,998 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,002 - EACAgent.Guardrails - WARNING - High price burden ratio: 270.061 > 0.3
2025-10-26 00:09:40,002 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:40,002 - EACAgent - INFO - Checkout processed: user=user_29, policy=snap_wic_substitution, recs=0, latency=3.85ms
2025-10-26 00:09:40,006 - EACAgent.Guardrails - WARNING - High price burden ratio: 130.894 > 0.3
2025-10-26 00:09:40,006 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,012 - EACAgent.Guardrails - WARNING - High price burden ratio: 224.159 > 0.3
2025-10-26 00:09:40,012 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,016 - EACAgent.Guardrails - WARNING - High price burden ratio: 288.012 > 0.3
2025-10-26 00:09:40,016 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,020 - EACAgent.Guardrails - WARNING - High price burden ratio: 243.898 > 0.3
2025-10-26 00:09:40,020 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,023 - EACAgent.Guardrails - WARNING - High price burden ratio: 425.731 > 0.3
2025-10-26 00:09:40,023 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:40,023 - EACAgent - INFO - Checkout processed: user=user_34, policy=snap_wic_substitution, recs=0, latency=2.69ms
2025-10-26 00:09:40,029 - EACAgent.Guardrails - WARNING - High price burden ratio: 374.907 > 0.3
2025-10-26 00:09:40,030 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:40,030 - EACAgent - INFO - Checkout processed: user=user_35, policy=snap_wic_substitution, recs=0, latency=6.01ms
2025-10-26 00:09:40,034 - EACAgent.Guardrails - WARNING - High price burden ratio: 192.492 > 0.3
2025-10-26 00:09:40,034 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,038 - EACAgent.Guardrails - WARNING - High price burden ratio: 245.793 > 0.3
2025-10-26 00:09:40,039 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 2 SNAP/WIC recommendations
2025-10-26 00:09:40,039 - EACAgent - INFO - Checkout processed: user=user_37, policy=snap_wic_substitution, recs=2, latency=4.10ms
2025-10-26 00:09:40,045 - EACAgent.Guardrails - WARNING - High price burden ratio: 233.088 > 0.3
2025-10-26 00:09:40,045 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,051 - EACAgent.Guardrails - WARNING - High price burden ratio: 453.910 > 0.3
2025-10-26 00:09:40,051 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,055 - EACAgent.Guardrails - WARNING - High price burden ratio: 230.717 > 0.3
2025-10-26 00:09:40,056 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,062 - EACAgent.Guardrails - WARNING - High price burden ratio: 332.568 > 0.3
2025-10-26 00:09:40,062 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:40,062 - EACAgent - INFO - Checkout processed: user=user_41, policy=snap_wic_substitution, recs=1, latency=6.74ms
2025-10-26 00:09:40,066 - EACAgent.Guardrails - WARNING - High price burden ratio: 278.084 > 0.3
2025-10-26 00:09:40,066 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,070 - EACAgent.Guardrails - WARNING - High price burden ratio: 296.207 > 0.3
2025-10-26 00:09:40,070 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:40,071 - EACAgent - INFO - Checkout processed: user=user_43, policy=snap_wic_substitution, recs=0, latency=3.82ms
2025-10-26 00:09:40,075 - EACAgent.Guardrails - WARNING - High price burden ratio: 85.371 > 0.3
2025-10-26 00:09:40,075 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,079 - EACAgent.Guardrails - WARNING - High price burden ratio: 434.402 > 0.3
2025-10-26 00:09:40,080 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:40,080 - EACAgent - INFO - Checkout processed: user=user_45, policy=snap_wic_substitution, recs=0, latency=4.60ms
2025-10-26 00:09:40,084 - EACAgent.Guardrails - WARNING - High price burden ratio: 116.953 > 0.3
2025-10-26 00:09:40,084 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,086 - EACAgent.Guardrails - WARNING - High price burden ratio: 272.597 > 0.3
2025-10-26 00:09:40,086 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,089 - EACAgent.Guardrails - WARNING - High price burden ratio: 135.491 > 0.3
2025-10-26 00:09:40,090 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,093 - EACAgent.Guardrails - WARNING - High price burden ratio: 260.626 > 0.3
2025-10-26 00:09:40,093 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:40,093 - EACAgent - INFO - Checkout processed: user=user_49, policy=snap_wic_substitution, recs=0, latency=3.49ms
2025-10-26 00:09:40,098 - EACAgent.Guardrails - WARNING - High price burden ratio: 324.257 > 0.3
2025-10-26 00:09:40,098 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,101 - EACAgent.Guardrails - WARNING - High price burden ratio: 149.903 > 0.3
2025-10-26 00:09:40,101 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:40,101 - EACAgent - INFO - Checkout processed: user=user_51, policy=snap_wic_substitution, recs=0, latency=2.98ms
2025-10-26 00:09:40,105 - EACAgent.Guardrails - WARNING - High price burden ratio: 257.268 > 0.3
2025-10-26 00:09:40,105 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,109 - EACAgent.Guardrails - WARNING - High price burden ratio: 371.645 > 0.3
2025-10-26 00:09:40,109 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,114 - EACAgent.Guardrails - WARNING - High price burden ratio: 216.967 > 0.3
2025-10-26 00:09:40,114 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,118 - EACAgent.Guardrails - WARNING - High price burden ratio: 236.959 > 0.3
2025-10-26 00:09:40,118 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,121 - EACAgent.Guardrails - WARNING - High price burden ratio: 261.942 > 0.3
2025-10-26 00:09:40,121 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,125 - EACAgent.Guardrails - WARNING - High price burden ratio: 286.787 > 0.3
2025-10-26 00:09:40,125 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,130 - EACAgent.Guardrails - WARNING - High price burden ratio: 127.010 > 0.3
2025-10-26 00:09:40,130 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,134 - EACAgent.Guardrails - WARNING - High price burden ratio: 402.855 > 0.3
2025-10-26 00:09:40,134 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,137 - EACAgent.Guardrails - WARNING - High price burden ratio: 329.800 > 0.3
2025-10-26 00:09:40,137 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,139 - EACAgent.Guardrails - WARNING - High price burden ratio: 225.339 > 0.3
2025-10-26 00:09:40,139 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,146 - EACAgent.Guardrails - WARNING - High price burden ratio: 282.156 > 0.3
2025-10-26 00:09:40,146 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,153 - EACAgent.Guardrails - WARNING - High price burden ratio: 348.087 > 0.3
2025-10-26 00:09:40,153 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:40,153 - EACAgent - INFO - Checkout processed: user=user_63, policy=snap_wic_substitution, recs=1, latency=6.55ms
2025-10-26 00:09:40,155 - EACAgent.Guardrails - WARNING - High price burden ratio: 202.049 > 0.3
2025-10-26 00:09:40,155 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,158 - EACAgent.Guardrails - WARNING - High price burden ratio: 238.976 > 0.3
2025-10-26 00:09:40,158 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,162 - EACAgent.Guardrails - WARNING - High price burden ratio: 424.518 > 0.3
2025-10-26 00:09:40,162 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,166 - EACAgent.Guardrails - WARNING - High price burden ratio: 102.870 > 0.3
2025-10-26 00:09:40,166 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,171 - EACAgent.Guardrails - WARNING - High price burden ratio: 382.598 > 0.3
2025-10-26 00:09:40,171 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,175 - EACAgent.Guardrails - WARNING - High price burden ratio: 156.820 > 0.3
2025-10-26 00:09:40,175 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,179 - EACAgent.Guardrails - WARNING - High price burden ratio: 145.206 > 0.3
2025-10-26 00:09:40,179 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:40,179 - EACAgent - INFO - Checkout processed: user=user_70, policy=snap_wic_substitution, recs=1, latency=3.85ms
2025-10-26 00:09:40,183 - EACAgent.Guardrails - WARNING - High price burden ratio: 150.686 > 0.3
2025-10-26 00:09:40,183 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:40,183 - EACAgent - INFO - Checkout processed: user=user_71, policy=snap_wic_substitution, recs=0, latency=3.86ms
2025-10-26 00:09:40,186 - EACAgent.Guardrails - WARNING - High price burden ratio: 165.299 > 0.3
2025-10-26 00:09:40,186 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:40,186 - EACAgent - INFO - Checkout processed: user=user_72, policy=snap_wic_substitution, recs=1, latency=2.87ms
2025-10-26 00:09:40,189 - EACAgent.Guardrails - WARNING - High price burden ratio: 269.969 > 0.3
2025-10-26 00:09:40,189 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,192 - EACAgent.Guardrails - WARNING - High price burden ratio: 488.758 > 0.3
2025-10-26 00:09:40,193 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 2 SNAP/WIC recommendations
2025-10-26 00:09:40,193 - EACAgent - INFO - Checkout processed: user=user_74, policy=snap_wic_substitution, recs=2, latency=3.75ms
2025-10-26 00:09:40,196 - EACAgent.Guardrails - WARNING - High price burden ratio: 383.042 > 0.3
2025-10-26 00:09:40,196 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,200 - EACAgent.Guardrails - WARNING - High price burden ratio: 170.388 > 0.3
2025-10-26 00:09:40,200 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:40,200 - EACAgent - INFO - Checkout processed: user=user_76, policy=snap_wic_substitution, recs=0, latency=4.18ms
2025-10-26 00:09:40,204 - EACAgent.Guardrails - WARNING - High price burden ratio: 63.759 > 0.3
2025-10-26 00:09:40,205 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,209 - EACAgent.Guardrails - WARNING - High price burden ratio: 195.313 > 0.3
2025-10-26 00:09:40,209 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,213 - EACAgent.Guardrails - WARNING - High price burden ratio: 142.304 > 0.3
2025-10-26 00:09:40,213 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:40,213 - EACAgent - INFO - Checkout processed: user=user_79, policy=snap_wic_substitution, recs=0, latency=3.96ms
2025-10-26 00:09:40,217 - EACAgent.Guardrails - WARNING - High price burden ratio: 495.190 > 0.3
2025-10-26 00:09:40,217 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:40,217 - EACAgent - INFO - Checkout processed: user=user_80, policy=snap_wic_substitution, recs=1, latency=3.70ms
2025-10-26 00:09:40,220 - EACAgent.Guardrails - WARNING - High price burden ratio: 372.120 > 0.3
2025-10-26 00:09:40,220 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,223 - EACAgent.Guardrails - WARNING - High price burden ratio: 181.526 > 0.3
2025-10-26 00:09:40,223 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:40,224 - EACAgent - INFO - Checkout processed: user=user_82, policy=snap_wic_substitution, recs=0, latency=3.65ms
2025-10-26 00:09:40,228 - EACAgent.Guardrails - WARNING - High price burden ratio: 154.835 > 0.3
2025-10-26 00:09:40,228 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,233 - EACAgent.Guardrails - WARNING - High price burden ratio: 231.889 > 0.3
2025-10-26 00:09:40,233 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,237 - EACAgent.Guardrails - WARNING - High price burden ratio: 118.715 > 0.3
2025-10-26 00:09:40,237 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,246 - EACAgent.Guardrails - WARNING - High price burden ratio: 160.189 > 0.3
2025-10-26 00:09:40,246 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:40,246 - EACAgent - INFO - Checkout processed: user=user_86, policy=snap_wic_substitution, recs=0, latency=8.88ms
2025-10-26 00:09:40,253 - EACAgent.Guardrails - WARNING - High price burden ratio: 108.030 > 0.3
2025-10-26 00:09:40,253 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:40,253 - EACAgent - INFO - Checkout processed: user=user_87, policy=snap_wic_substitution, recs=0, latency=6.29ms
2025-10-26 00:09:40,255 - EACAgent.Guardrails - WARNING - High price burden ratio: 212.494 > 0.3
2025-10-26 00:09:40,255 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:40,255 - EACAgent - INFO - Checkout processed: user=user_88, policy=snap_wic_substitution, recs=1, latency=2.58ms
2025-10-26 00:09:40,259 - EACAgent.Guardrails - WARNING - High price burden ratio: 294.471 > 0.3
2025-10-26 00:09:40,259 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:40,259 - EACAgent - INFO - Checkout processed: user=user_89, policy=snap_wic_substitution, recs=0, latency=3.51ms
2025-10-26 00:09:40,263 - EACAgent.Guardrails - WARNING - High price burden ratio: 310.703 > 0.3
2025-10-26 00:09:40,263 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:40,263 - EACAgent - INFO - Checkout processed: user=user_90, policy=snap_wic_substitution, recs=0, latency=3.74ms
2025-10-26 00:09:40,267 - EACAgent.Guardrails - WARNING - High price burden ratio: 179.545 > 0.3
2025-10-26 00:09:40,267 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:40,267 - EACAgent - INFO - Checkout processed: user=user_91, policy=snap_wic_substitution, recs=0, latency=3.55ms
2025-10-26 00:09:40,271 - EACAgent.Guardrails - WARNING - High price burden ratio: 206.749 > 0.3
2025-10-26 00:09:40,271 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:40,271 - EACAgent - INFO - Checkout processed: user=user_92, policy=snap_wic_substitution, recs=0, latency=4.07ms
2025-10-26 00:09:40,275 - EACAgent.Guardrails - WARNING - High price burden ratio: 375.483 > 0.3
2025-10-26 00:09:40,275 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,280 - EACAgent.Guardrails - WARNING - High price burden ratio: 366.955 > 0.3
2025-10-26 00:09:40,281 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,284 - EACAgent.Guardrails - WARNING - High price burden ratio: 245.199 > 0.3
2025-10-26 00:09:40,284 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:40,284 - EACAgent - INFO - Checkout processed: user=user_95, policy=snap_wic_substitution, recs=0, latency=3.32ms
2025-10-26 00:09:40,288 - EACAgent.Guardrails - WARNING - High price burden ratio: 356.833 > 0.3
2025-10-26 00:09:40,288 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,292 - EACAgent.Guardrails - WARNING - High price burden ratio: 253.821 > 0.3
2025-10-26 00:09:40,292 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,296 - EACAgent.Guardrails - WARNING - High price burden ratio: 185.029 > 0.3
2025-10-26 00:09:40,296 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 2 SNAP/WIC recommendations
2025-10-26 00:09:40,296 - EACAgent - INFO - Checkout processed: user=user_98, policy=snap_wic_substitution, recs=2, latency=3.73ms
2025-10-26 00:09:40,300 - EACAgent.Guardrails - WARNING - High price burden ratio: 135.116 > 0.3
2025-10-26 00:09:40,300 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,303 - EACAgent.Guardrails - WARNING - High price burden ratio: 200.959 > 0.3
2025-10-26 00:09:40,303 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:40,303 - EACAgent - INFO - Checkout processed: user=user_0, policy=snap_wic_substitution, recs=0, latency=2.88ms
2025-10-26 00:09:40,306 - EACAgent.Guardrails - WARNING - High price burden ratio: 152.246 > 0.3
2025-10-26 00:09:40,306 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,312 - EACAgent.Guardrails - WARNING - High price burden ratio: 329.974 > 0.3
2025-10-26 00:09:40,313 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:40,313 - EACAgent - INFO - Checkout processed: user=user_2, policy=snap_wic_substitution, recs=0, latency=6.63ms
2025-10-26 00:09:40,319 - EACAgent.Guardrails - WARNING - High price burden ratio: 430.325 > 0.3
2025-10-26 00:09:40,320 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,325 - EACAgent.Guardrails - WARNING - High price burden ratio: 144.417 > 0.3
2025-10-26 00:09:40,325 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,329 - EACAgent.Guardrails - WARNING - High price burden ratio: 208.132 > 0.3
2025-10-26 00:09:40,329 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,333 - EACAgent.Guardrails - WARNING - High price burden ratio: 174.747 > 0.3
2025-10-26 00:09:40,333 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,336 - EACAgent.Guardrails - WARNING - High price burden ratio: 599.786 > 0.3
2025-10-26 00:09:40,336 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,339 - EACAgent.Guardrails - WARNING - High price burden ratio: 139.401 > 0.3
2025-10-26 00:09:40,339 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,342 - EACAgent.Guardrails - WARNING - High price burden ratio: 231.884 > 0.3
2025-10-26 00:09:40,343 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,346 - EACAgent.Guardrails - WARNING - High price burden ratio: 256.817 > 0.3
2025-10-26 00:09:40,346 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,349 - EACAgent.Guardrails - WARNING - High price burden ratio: 453.646 > 0.3
2025-10-26 00:09:40,350 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,354 - EACAgent.Guardrails - WARNING - High price burden ratio: 211.729 > 0.3
2025-10-26 00:09:40,354 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,358 - EACAgent.Guardrails - WARNING - High price burden ratio: 347.602 > 0.3
2025-10-26 00:09:40,358 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,362 - EACAgent.Guardrails - WARNING - High price burden ratio: 430.237 > 0.3
2025-10-26 00:09:40,363 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:40,363 - EACAgent - INFO - Checkout processed: user=user_14, policy=snap_wic_substitution, recs=1, latency=4.60ms
2025-10-26 00:09:40,367 - EACAgent.Guardrails - WARNING - High price burden ratio: 229.573 > 0.3
2025-10-26 00:09:40,367 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,370 - EACAgent.Guardrails - WARNING - High price burden ratio: 394.621 > 0.3
2025-10-26 00:09:40,371 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,375 - EACAgent.Guardrails - WARNING - High price burden ratio: 182.159 > 0.3
2025-10-26 00:09:40,375 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,379 - EACAgent.Guardrails - WARNING - High price burden ratio: 183.576 > 0.3
2025-10-26 00:09:40,379 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,384 - EACAgent.Guardrails - WARNING - High price burden ratio: 181.130 > 0.3
2025-10-26 00:09:40,384 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,387 - EACAgent.Guardrails - WARNING - High price burden ratio: 225.005 > 0.3
2025-10-26 00:09:40,387 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:40,388 - EACAgent - INFO - Checkout processed: user=user_20, policy=snap_wic_substitution, recs=1, latency=3.37ms
2025-10-26 00:09:40,391 - EACAgent.Guardrails - WARNING - High price burden ratio: 74.369 > 0.3
2025-10-26 00:09:40,392 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,396 - EACAgent.Guardrails - WARNING - High price burden ratio: 294.489 > 0.3
2025-10-26 00:09:40,396 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,399 - EACAgent.Guardrails - WARNING - High price burden ratio: 390.964 > 0.3
2025-10-26 00:09:40,400 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 2 SNAP/WIC recommendations
2025-10-26 00:09:40,400 - EACAgent - INFO - Checkout processed: user=user_23, policy=snap_wic_substitution, recs=2, latency=3.20ms
2025-10-26 00:09:40,402 - EACAgent.Guardrails - WARNING - High price burden ratio: 139.070 > 0.3
2025-10-26 00:09:40,402 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:40,402 - EACAgent - INFO - Checkout processed: user=user_24, policy=snap_wic_substitution, recs=1, latency=2.52ms
2025-10-26 00:09:40,406 - EACAgent.Guardrails - WARNING - High price burden ratio: 216.453 > 0.3
2025-10-26 00:09:40,406 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,409 - EACAgent.Guardrails - WARNING - High price burden ratio: 200.704 > 0.3
2025-10-26 00:09:40,409 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:40,409 - EACAgent - INFO - Checkout processed: user=user_26, policy=snap_wic_substitution, recs=1, latency=2.81ms
2025-10-26 00:09:40,412 - EACAgent.Guardrails - WARNING - High price burden ratio: 137.116 > 0.3
2025-10-26 00:09:40,412 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:40,412 - EACAgent - INFO - Checkout processed: user=user_27, policy=snap_wic_substitution, recs=1, latency=3.30ms
2025-10-26 00:09:40,416 - EACAgent.Guardrails - WARNING - High price burden ratio: 293.324 > 0.3
2025-10-26 00:09:40,416 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,420 - EACAgent.Guardrails - WARNING - High price burden ratio: 270.061 > 0.3
2025-10-26 00:09:40,420 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:40,420 - EACAgent - INFO - Checkout processed: user=user_29, policy=snap_wic_substitution, recs=0, latency=3.94ms
2025-10-26 00:09:40,425 - EACAgent.Guardrails - WARNING - High price burden ratio: 130.894 > 0.3
2025-10-26 00:09:40,425 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,429 - EACAgent.Guardrails - WARNING - High price burden ratio: 224.159 > 0.3
2025-10-26 00:09:40,430 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,449 - EACAgent.Guardrails - WARNING - High price burden ratio: 288.012 > 0.3
2025-10-26 00:09:40,449 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,452 - EACAgent.Guardrails - WARNING - High price burden ratio: 243.898 > 0.3
2025-10-26 00:09:40,452 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,457 - EACAgent.Guardrails - WARNING - High price burden ratio: 425.731 > 0.3
2025-10-26 00:09:40,457 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:40,457 - EACAgent - INFO - Checkout processed: user=user_34, policy=snap_wic_substitution, recs=0, latency=4.47ms
2025-10-26 00:09:40,466 - EACAgent.Guardrails - WARNING - High price burden ratio: 374.907 > 0.3
2025-10-26 00:09:40,466 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:40,466 - EACAgent - INFO - Checkout processed: user=user_35, policy=snap_wic_substitution, recs=0, latency=8.96ms
2025-10-26 00:09:40,474 - EACAgent.Guardrails - WARNING - High price burden ratio: 192.492 > 0.3
2025-10-26 00:09:40,474 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,479 - EACAgent.Guardrails - WARNING - High price burden ratio: 245.793 > 0.3
2025-10-26 00:09:40,479 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 2 SNAP/WIC recommendations
2025-10-26 00:09:40,479 - EACAgent - INFO - Checkout processed: user=user_37, policy=snap_wic_substitution, recs=2, latency=5.20ms
2025-10-26 00:09:40,483 - EACAgent.Guardrails - WARNING - High price burden ratio: 233.088 > 0.3
2025-10-26 00:09:40,483 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,487 - EACAgent.Guardrails - WARNING - High price burden ratio: 453.910 > 0.3
2025-10-26 00:09:40,487 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,490 - EACAgent.Guardrails - WARNING - High price burden ratio: 230.717 > 0.3
2025-10-26 00:09:40,490 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,495 - EACAgent.Guardrails - WARNING - High price burden ratio: 332.568 > 0.3
2025-10-26 00:09:40,495 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:40,495 - EACAgent - INFO - Checkout processed: user=user_41, policy=snap_wic_substitution, recs=1, latency=4.50ms
2025-10-26 00:09:40,499 - EACAgent.Guardrails - WARNING - High price burden ratio: 278.084 > 0.3
2025-10-26 00:09:40,499 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,503 - EACAgent.Guardrails - WARNING - High price burden ratio: 296.207 > 0.3
2025-10-26 00:09:40,503 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:40,503 - EACAgent - INFO - Checkout processed: user=user_43, policy=snap_wic_substitution, recs=0, latency=3.62ms
2025-10-26 00:09:40,506 - EACAgent.Guardrails - WARNING - High price burden ratio: 85.371 > 0.3
2025-10-26 00:09:40,506 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,512 - EACAgent.Guardrails - WARNING - High price burden ratio: 434.402 > 0.3
2025-10-26 00:09:40,512 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:40,512 - EACAgent - INFO - Checkout processed: user=user_45, policy=snap_wic_substitution, recs=0, latency=6.67ms
2025-10-26 00:09:40,517 - EACAgent.Guardrails - WARNING - High price burden ratio: 116.953 > 0.3
2025-10-26 00:09:40,517 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,520 - EACAgent.Guardrails - WARNING - High price burden ratio: 272.597 > 0.3
2025-10-26 00:09:40,520 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,522 - EACAgent.Guardrails - WARNING - High price burden ratio: 135.491 > 0.3
2025-10-26 00:09:40,522 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,525 - EACAgent.Guardrails - WARNING - High price burden ratio: 260.626 > 0.3
2025-10-26 00:09:40,525 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:40,525 - EACAgent - INFO - Checkout processed: user=user_49, policy=snap_wic_substitution, recs=0, latency=2.76ms
2025-10-26 00:09:40,529 - EACAgent.Guardrails - WARNING - High price burden ratio: 324.257 > 0.3
2025-10-26 00:09:40,529 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,534 - EACAgent.Guardrails - WARNING - High price burden ratio: 149.903 > 0.3
2025-10-26 00:09:40,534 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:40,534 - EACAgent - INFO - Checkout processed: user=user_51, policy=snap_wic_substitution, recs=0, latency=4.53ms
2025-10-26 00:09:40,537 - EACAgent.Guardrails - WARNING - High price burden ratio: 257.268 > 0.3
2025-10-26 00:09:40,537 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,540 - EACAgent.Guardrails - WARNING - High price burden ratio: 371.645 > 0.3
2025-10-26 00:09:40,540 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,543 - EACAgent.Guardrails - WARNING - High price burden ratio: 216.967 > 0.3
2025-10-26 00:09:40,543 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,546 - EACAgent.Guardrails - WARNING - High price burden ratio: 236.959 > 0.3
2025-10-26 00:09:40,546 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,553 - EACAgent.Guardrails - WARNING - High price burden ratio: 261.942 > 0.3
2025-10-26 00:09:40,553 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,556 - EACAgent.Guardrails - WARNING - High price burden ratio: 286.787 > 0.3
2025-10-26 00:09:40,556 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,563 - EACAgent.Guardrails - WARNING - High price burden ratio: 127.010 > 0.3
2025-10-26 00:09:40,563 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,566 - EACAgent.Guardrails - WARNING - High price burden ratio: 402.855 > 0.3
2025-10-26 00:09:40,566 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,570 - EACAgent.Guardrails - WARNING - High price burden ratio: 329.800 > 0.3
2025-10-26 00:09:40,570 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,574 - EACAgent.Guardrails - WARNING - High price burden ratio: 225.339 > 0.3
2025-10-26 00:09:40,574 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,579 - EACAgent.Guardrails - WARNING - High price burden ratio: 282.156 > 0.3
2025-10-26 00:09:40,579 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,583 - EACAgent.Guardrails - WARNING - High price burden ratio: 348.087 > 0.3
2025-10-26 00:09:40,583 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:40,584 - EACAgent - INFO - Checkout processed: user=user_63, policy=snap_wic_substitution, recs=1, latency=4.45ms
2025-10-26 00:09:40,588 - EACAgent.Guardrails - WARNING - High price burden ratio: 202.049 > 0.3
2025-10-26 00:09:40,588 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,591 - EACAgent.Guardrails - WARNING - High price burden ratio: 238.976 > 0.3
2025-10-26 00:09:40,591 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,596 - EACAgent.Guardrails - WARNING - High price burden ratio: 424.518 > 0.3
2025-10-26 00:09:40,597 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,600 - EACAgent.Guardrails - WARNING - High price burden ratio: 102.870 > 0.3
2025-10-26 00:09:40,600 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,603 - EACAgent.Guardrails - WARNING - High price burden ratio: 382.598 > 0.3
2025-10-26 00:09:40,603 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,607 - EACAgent.Guardrails - WARNING - High price burden ratio: 156.820 > 0.3
2025-10-26 00:09:40,607 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,612 - EACAgent.Guardrails - WARNING - High price burden ratio: 145.206 > 0.3
2025-10-26 00:09:40,612 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:40,612 - EACAgent - INFO - Checkout processed: user=user_70, policy=snap_wic_substitution, recs=1, latency=4.46ms
2025-10-26 00:09:40,616 - EACAgent.Guardrails - WARNING - High price burden ratio: 150.686 > 0.3
2025-10-26 00:09:40,617 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:40,617 - EACAgent - INFO - Checkout processed: user=user_71, policy=snap_wic_substitution, recs=0, latency=4.64ms
2025-10-26 00:09:40,621 - EACAgent.Guardrails - WARNING - High price burden ratio: 165.299 > 0.3
2025-10-26 00:09:40,621 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:40,621 - EACAgent - INFO - Checkout processed: user=user_72, policy=snap_wic_substitution, recs=1, latency=4.27ms
2025-10-26 00:09:40,626 - EACAgent.Guardrails - WARNING - High price burden ratio: 269.969 > 0.3
2025-10-26 00:09:40,626 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,630 - EACAgent.Guardrails - WARNING - High price burden ratio: 488.758 > 0.3
2025-10-26 00:09:40,631 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 2 SNAP/WIC recommendations
2025-10-26 00:09:40,631 - EACAgent - INFO - Checkout processed: user=user_74, policy=snap_wic_substitution, recs=2, latency=4.12ms
2025-10-26 00:09:40,634 - EACAgent.Guardrails - WARNING - High price burden ratio: 383.042 > 0.3
2025-10-26 00:09:40,634 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,637 - EACAgent.Guardrails - WARNING - High price burden ratio: 170.388 > 0.3
2025-10-26 00:09:40,637 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:40,637 - EACAgent - INFO - Checkout processed: user=user_76, policy=snap_wic_substitution, recs=0, latency=2.43ms
2025-10-26 00:09:40,641 - EACAgent.Guardrails - WARNING - High price burden ratio: 63.759 > 0.3
2025-10-26 00:09:40,641 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,646 - EACAgent.Guardrails - WARNING - High price burden ratio: 195.313 > 0.3
2025-10-26 00:09:40,646 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,649 - EACAgent.Guardrails - WARNING - High price burden ratio: 142.304 > 0.3
2025-10-26 00:09:40,650 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:40,650 - EACAgent - INFO - Checkout processed: user=user_79, policy=snap_wic_substitution, recs=0, latency=3.07ms
2025-10-26 00:09:40,653 - EACAgent.Guardrails - WARNING - High price burden ratio: 495.190 > 0.3
2025-10-26 00:09:40,653 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:40,653 - EACAgent - INFO - Checkout processed: user=user_80, policy=snap_wic_substitution, recs=1, latency=3.14ms
2025-10-26 00:09:40,656 - EACAgent.Guardrails - WARNING - High price burden ratio: 372.120 > 0.3
2025-10-26 00:09:40,656 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,662 - EACAgent.Guardrails - WARNING - High price burden ratio: 181.526 > 0.3
2025-10-26 00:09:40,662 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:40,662 - EACAgent - INFO - Checkout processed: user=user_82, policy=snap_wic_substitution, recs=0, latency=5.72ms
2025-10-26 00:09:40,665 - EACAgent.Guardrails - WARNING - High price burden ratio: 154.835 > 0.3
2025-10-26 00:09:40,666 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,670 - EACAgent.Guardrails - WARNING - High price burden ratio: 231.889 > 0.3
2025-10-26 00:09:40,670 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,675 - EACAgent.Guardrails - WARNING - High price burden ratio: 118.715 > 0.3
2025-10-26 00:09:40,675 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,679 - EACAgent.Guardrails - WARNING - High price burden ratio: 160.189 > 0.3
2025-10-26 00:09:40,679 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:40,679 - EACAgent - INFO - Checkout processed: user=user_86, policy=snap_wic_substitution, recs=0, latency=3.76ms
2025-10-26 00:09:40,683 - EACAgent.Guardrails - WARNING - High price burden ratio: 108.030 > 0.3
2025-10-26 00:09:40,684 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:40,684 - EACAgent - INFO - Checkout processed: user=user_87, policy=snap_wic_substitution, recs=0, latency=4.08ms
2025-10-26 00:09:40,688 - EACAgent.Guardrails - WARNING - High price burden ratio: 212.494 > 0.3
2025-10-26 00:09:40,688 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:40,688 - EACAgent - INFO - Checkout processed: user=user_88, policy=snap_wic_substitution, recs=1, latency=4.39ms
2025-10-26 00:09:40,692 - EACAgent.Guardrails - WARNING - High price burden ratio: 294.471 > 0.3
2025-10-26 00:09:40,692 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:40,692 - EACAgent - INFO - Checkout processed: user=user_89, policy=snap_wic_substitution, recs=0, latency=3.48ms
2025-10-26 00:09:40,695 - EACAgent.Guardrails - WARNING - High price burden ratio: 310.703 > 0.3
2025-10-26 00:09:40,696 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:40,696 - EACAgent - INFO - Checkout processed: user=user_90, policy=snap_wic_substitution, recs=0, latency=3.38ms
2025-10-26 00:09:40,699 - EACAgent.Guardrails - WARNING - High price burden ratio: 179.545 > 0.3
2025-10-26 00:09:40,699 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:40,699 - EACAgent - INFO - Checkout processed: user=user_91, policy=snap_wic_substitution, recs=0, latency=3.36ms
2025-10-26 00:09:40,702 - EACAgent.Guardrails - WARNING - High price burden ratio: 206.749 > 0.3
2025-10-26 00:09:40,702 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:40,702 - EACAgent - INFO - Checkout processed: user=user_92, policy=snap_wic_substitution, recs=0, latency=2.72ms
2025-10-26 00:09:40,705 - EACAgent.Guardrails - WARNING - High price burden ratio: 375.483 > 0.3
2025-10-26 00:09:40,705 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,708 - EACAgent.Guardrails - WARNING - High price burden ratio: 366.955 > 0.3
2025-10-26 00:09:40,708 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,712 - EACAgent.Guardrails - WARNING - High price burden ratio: 245.199 > 0.3
2025-10-26 00:09:40,712 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:40,712 - EACAgent - INFO - Checkout processed: user=user_95, policy=snap_wic_substitution, recs=0, latency=4.05ms
2025-10-26 00:09:40,717 - EACAgent.Guardrails - WARNING - High price burden ratio: 356.833 > 0.3
2025-10-26 00:09:40,717 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,721 - EACAgent.Guardrails - WARNING - High price burden ratio: 253.821 > 0.3
2025-10-26 00:09:40,721 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,725 - EACAgent.Guardrails - WARNING - High price burden ratio: 185.029 > 0.3
2025-10-26 00:09:40,725 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 2 SNAP/WIC recommendations
2025-10-26 00:09:40,725 - EACAgent - INFO - Checkout processed: user=user_98, policy=snap_wic_substitution, recs=2, latency=3.91ms
2025-10-26 00:09:40,730 - EACAgent.Guardrails - WARNING - High price burden ratio: 135.116 > 0.3
2025-10-26 00:09:40,730 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,734 - EACAgent.Guardrails - WARNING - High price burden ratio: 200.959 > 0.3
2025-10-26 00:09:40,734 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:40,734 - EACAgent - INFO - Checkout processed: user=user_0, policy=snap_wic_substitution, recs=0, latency=3.22ms
2025-10-26 00:09:40,737 - EACAgent.Guardrails - WARNING - High price burden ratio: 152.246 > 0.3
2025-10-26 00:09:40,737 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,740 - EACAgent.Guardrails - WARNING - High price burden ratio: 329.974 > 0.3
2025-10-26 00:09:40,741 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:40,741 - EACAgent - INFO - Checkout processed: user=user_2, policy=snap_wic_substitution, recs=0, latency=3.71ms
2025-10-26 00:09:40,747 - EACAgent.Guardrails - WARNING - High price burden ratio: 430.325 > 0.3
2025-10-26 00:09:40,747 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,752 - EACAgent.Guardrails - WARNING - High price burden ratio: 144.417 > 0.3
2025-10-26 00:09:40,753 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,758 - EACAgent.Guardrails - WARNING - High price burden ratio: 208.132 > 0.3
2025-10-26 00:09:40,758 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,762 - EACAgent.Guardrails - WARNING - High price burden ratio: 174.747 > 0.3
2025-10-26 00:09:40,763 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,766 - EACAgent.Guardrails - WARNING - High price burden ratio: 599.786 > 0.3
2025-10-26 00:09:40,766 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,768 - EACAgent.Guardrails - WARNING - High price burden ratio: 139.401 > 0.3
2025-10-26 00:09:40,769 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,771 - EACAgent.Guardrails - WARNING - High price burden ratio: 231.884 > 0.3
2025-10-26 00:09:40,771 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,775 - EACAgent.Guardrails - WARNING - High price burden ratio: 256.817 > 0.3
2025-10-26 00:09:40,775 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,779 - EACAgent.Guardrails - WARNING - High price burden ratio: 453.646 > 0.3
2025-10-26 00:09:40,779 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,782 - EACAgent.Guardrails - WARNING - High price burden ratio: 211.729 > 0.3
2025-10-26 00:09:40,782 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,785 - EACAgent.Guardrails - WARNING - High price burden ratio: 347.602 > 0.3
2025-10-26 00:09:40,785 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,788 - EACAgent.Guardrails - WARNING - High price burden ratio: 430.237 > 0.3
2025-10-26 00:09:40,788 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:40,788 - EACAgent - INFO - Checkout processed: user=user_14, policy=snap_wic_substitution, recs=1, latency=2.86ms
2025-10-26 00:09:40,793 - EACAgent.Guardrails - WARNING - High price burden ratio: 229.573 > 0.3
2025-10-26 00:09:40,793 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,798 - EACAgent.Guardrails - WARNING - High price burden ratio: 394.621 > 0.3
2025-10-26 00:09:40,798 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,802 - EACAgent.Guardrails - WARNING - High price burden ratio: 182.159 > 0.3
2025-10-26 00:09:40,802 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,807 - EACAgent.Guardrails - WARNING - High price burden ratio: 183.576 > 0.3
2025-10-26 00:09:40,807 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,813 - EACAgent.Guardrails - WARNING - High price burden ratio: 181.130 > 0.3
2025-10-26 00:09:40,813 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,817 - EACAgent.Guardrails - WARNING - High price burden ratio: 225.005 > 0.3
2025-10-26 00:09:40,817 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:40,817 - EACAgent - INFO - Checkout processed: user=user_20, policy=snap_wic_substitution, recs=1, latency=4.02ms
2025-10-26 00:09:40,820 - EACAgent.Guardrails - WARNING - High price burden ratio: 74.369 > 0.3
2025-10-26 00:09:40,820 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,825 - EACAgent.Guardrails - WARNING - High price burden ratio: 294.489 > 0.3
2025-10-26 00:09:40,825 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,829 - EACAgent.Guardrails - WARNING - High price burden ratio: 390.964 > 0.3
2025-10-26 00:09:40,829 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 2 SNAP/WIC recommendations
2025-10-26 00:09:40,829 - EACAgent - INFO - Checkout processed: user=user_23, policy=snap_wic_substitution, recs=2, latency=4.17ms
2025-10-26 00:09:40,832 - EACAgent.Guardrails - WARNING - High price burden ratio: 139.070 > 0.3
2025-10-26 00:09:40,832 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:40,832 - EACAgent - INFO - Checkout processed: user=user_24, policy=snap_wic_substitution, recs=1, latency=3.22ms
2025-10-26 00:09:40,835 - EACAgent.Guardrails - WARNING - High price burden ratio: 216.453 > 0.3
2025-10-26 00:09:40,835 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,842 - EACAgent.Guardrails - WARNING - High price burden ratio: 200.704 > 0.3
2025-10-26 00:09:40,842 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:40,842 - EACAgent - INFO - Checkout processed: user=user_26, policy=snap_wic_substitution, recs=1, latency=6.50ms
2025-10-26 00:09:40,847 - EACAgent.Guardrails - WARNING - High price burden ratio: 137.116 > 0.3
2025-10-26 00:09:40,848 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:40,848 - EACAgent - INFO - Checkout processed: user=user_27, policy=snap_wic_substitution, recs=1, latency=5.72ms
2025-10-26 00:09:40,853 - EACAgent.Guardrails - WARNING - High price burden ratio: 293.324 > 0.3
2025-10-26 00:09:40,853 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,888 - EACAgent.Guardrails - WARNING - High price burden ratio: 270.061 > 0.3
2025-10-26 00:09:40,888 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:40,888 - EACAgent - INFO - Checkout processed: user=user_29, policy=snap_wic_substitution, recs=0, latency=34.96ms
2025-10-26 00:09:40,893 - EACAgent.Guardrails - WARNING - High price burden ratio: 130.894 > 0.3
2025-10-26 00:09:40,893 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,897 - EACAgent.Guardrails - WARNING - High price burden ratio: 224.159 > 0.3
2025-10-26 00:09:40,897 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,900 - EACAgent.Guardrails - WARNING - High price burden ratio: 288.012 > 0.3
2025-10-26 00:09:40,900 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,904 - EACAgent.Guardrails - WARNING - High price burden ratio: 243.898 > 0.3
2025-10-26 00:09:40,904 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,908 - EACAgent.Guardrails - WARNING - High price burden ratio: 425.731 > 0.3
2025-10-26 00:09:40,908 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:40,909 - EACAgent - INFO - Checkout processed: user=user_34, policy=snap_wic_substitution, recs=0, latency=4.23ms
2025-10-26 00:09:40,913 - EACAgent.Guardrails - WARNING - High price burden ratio: 374.907 > 0.3
2025-10-26 00:09:40,913 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:40,913 - EACAgent - INFO - Checkout processed: user=user_35, policy=snap_wic_substitution, recs=0, latency=4.20ms
2025-10-26 00:09:40,915 - EACAgent.Guardrails - WARNING - High price burden ratio: 192.492 > 0.3
2025-10-26 00:09:40,915 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,919 - EACAgent.Guardrails - WARNING - High price burden ratio: 245.793 > 0.3
2025-10-26 00:09:40,919 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 2 SNAP/WIC recommendations
2025-10-26 00:09:40,919 - EACAgent - INFO - Checkout processed: user=user_37, policy=snap_wic_substitution, recs=2, latency=3.90ms
2025-10-26 00:09:40,922 - EACAgent.Guardrails - WARNING - High price burden ratio: 233.088 > 0.3
2025-10-26 00:09:40,922 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,925 - EACAgent.Guardrails - WARNING - High price burden ratio: 453.910 > 0.3
2025-10-26 00:09:40,925 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,930 - EACAgent.Guardrails - WARNING - High price burden ratio: 230.717 > 0.3
2025-10-26 00:09:40,930 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,934 - EACAgent.Guardrails - WARNING - High price burden ratio: 332.568 > 0.3
2025-10-26 00:09:40,934 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:40,934 - EACAgent - INFO - Checkout processed: user=user_41, policy=snap_wic_substitution, recs=1, latency=3.82ms
2025-10-26 00:09:40,937 - EACAgent.Guardrails - WARNING - High price burden ratio: 278.084 > 0.3
2025-10-26 00:09:40,937 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,939 - EACAgent.Guardrails - WARNING - High price burden ratio: 296.207 > 0.3
2025-10-26 00:09:40,941 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:40,941 - EACAgent - INFO - Checkout processed: user=user_43, policy=snap_wic_substitution, recs=0, latency=3.73ms
2025-10-26 00:09:40,946 - EACAgent.Guardrails - WARNING - High price burden ratio: 85.371 > 0.3
2025-10-26 00:09:40,946 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,950 - EACAgent.Guardrails - WARNING - High price burden ratio: 434.402 > 0.3
2025-10-26 00:09:40,951 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:40,951 - EACAgent - INFO - Checkout processed: user=user_45, policy=snap_wic_substitution, recs=0, latency=4.63ms
2025-10-26 00:09:40,955 - EACAgent.Guardrails - WARNING - High price burden ratio: 116.953 > 0.3
2025-10-26 00:09:40,955 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,960 - EACAgent.Guardrails - WARNING - High price burden ratio: 272.597 > 0.3
2025-10-26 00:09:40,960 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,963 - EACAgent.Guardrails - WARNING - High price burden ratio: 135.491 > 0.3
2025-10-26 00:09:40,963 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,967 - EACAgent.Guardrails - WARNING - High price burden ratio: 260.626 > 0.3
2025-10-26 00:09:40,968 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:40,968 - EACAgent - INFO - Checkout processed: user=user_49, policy=snap_wic_substitution, recs=0, latency=4.10ms
2025-10-26 00:09:40,972 - EACAgent.Guardrails - WARNING - High price burden ratio: 324.257 > 0.3
2025-10-26 00:09:40,972 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,979 - EACAgent.Guardrails - WARNING - High price burden ratio: 149.903 > 0.3
2025-10-26 00:09:40,979 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:40,979 - EACAgent - INFO - Checkout processed: user=user_51, policy=snap_wic_substitution, recs=0, latency=6.57ms
2025-10-26 00:09:40,985 - EACAgent.Guardrails - WARNING - High price burden ratio: 257.268 > 0.3
2025-10-26 00:09:40,985 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,988 - EACAgent.Guardrails - WARNING - High price burden ratio: 371.645 > 0.3
2025-10-26 00:09:40,988 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,992 - EACAgent.Guardrails - WARNING - High price burden ratio: 216.967 > 0.3
2025-10-26 00:09:40,993 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:40,996 - EACAgent.Guardrails - WARNING - High price burden ratio: 236.959 > 0.3
2025-10-26 00:09:40,996 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,000 - EACAgent.Guardrails - WARNING - High price burden ratio: 261.942 > 0.3
2025-10-26 00:09:41,000 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,003 - EACAgent.Guardrails - WARNING - High price burden ratio: 286.787 > 0.3
2025-10-26 00:09:41,003 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,005 - EACAgent.Guardrails - WARNING - High price burden ratio: 127.010 > 0.3
2025-10-26 00:09:41,005 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,012 - EACAgent.Guardrails - WARNING - High price burden ratio: 402.855 > 0.3
2025-10-26 00:09:41,012 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,017 - EACAgent.Guardrails - WARNING - High price burden ratio: 329.800 > 0.3
2025-10-26 00:09:41,017 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,021 - EACAgent.Guardrails - WARNING - High price burden ratio: 225.339 > 0.3
2025-10-26 00:09:41,021 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,025 - EACAgent.Guardrails - WARNING - High price burden ratio: 282.156 > 0.3
2025-10-26 00:09:41,025 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,029 - EACAgent.Guardrails - WARNING - High price burden ratio: 348.087 > 0.3
2025-10-26 00:09:41,029 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:41,029 - EACAgent - INFO - Checkout processed: user=user_63, policy=snap_wic_substitution, recs=1, latency=4.48ms
2025-10-26 00:09:41,033 - EACAgent.Guardrails - WARNING - High price burden ratio: 202.049 > 0.3
2025-10-26 00:09:41,033 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,037 - EACAgent.Guardrails - WARNING - High price burden ratio: 238.976 > 0.3
2025-10-26 00:09:41,038 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,042 - EACAgent.Guardrails - WARNING - High price burden ratio: 424.518 > 0.3
2025-10-26 00:09:41,042 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,047 - EACAgent.Guardrails - WARNING - High price burden ratio: 102.870 > 0.3
2025-10-26 00:09:41,047 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,052 - EACAgent.Guardrails - WARNING - High price burden ratio: 382.598 > 0.3
2025-10-26 00:09:41,052 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,055 - EACAgent.Guardrails - WARNING - High price burden ratio: 156.820 > 0.3
2025-10-26 00:09:41,055 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,061 - EACAgent.Guardrails - WARNING - High price burden ratio: 145.206 > 0.3
2025-10-26 00:09:41,061 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:41,061 - EACAgent - INFO - Checkout processed: user=user_70, policy=snap_wic_substitution, recs=1, latency=5.72ms
2025-10-26 00:09:41,064 - EACAgent.Guardrails - WARNING - High price burden ratio: 150.686 > 0.3
2025-10-26 00:09:41,065 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:41,065 - EACAgent - INFO - Checkout processed: user=user_71, policy=snap_wic_substitution, recs=0, latency=3.08ms
2025-10-26 00:09:41,068 - EACAgent.Guardrails - WARNING - High price burden ratio: 165.299 > 0.3
2025-10-26 00:09:41,068 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:41,068 - EACAgent - INFO - Checkout processed: user=user_72, policy=snap_wic_substitution, recs=1, latency=3.21ms
2025-10-26 00:09:41,071 - EACAgent.Guardrails - WARNING - High price burden ratio: 269.969 > 0.3
2025-10-26 00:09:41,071 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,075 - EACAgent.Guardrails - WARNING - High price burden ratio: 488.758 > 0.3
2025-10-26 00:09:41,075 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 2 SNAP/WIC recommendations
2025-10-26 00:09:41,076 - EACAgent - INFO - Checkout processed: user=user_74, policy=snap_wic_substitution, recs=2, latency=4.64ms
2025-10-26 00:09:41,081 - EACAgent.Guardrails - WARNING - High price burden ratio: 383.042 > 0.3
2025-10-26 00:09:41,081 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,085 - EACAgent.Guardrails - WARNING - High price burden ratio: 170.388 > 0.3
2025-10-26 00:09:41,085 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:41,085 - EACAgent - INFO - Checkout processed: user=user_76, policy=snap_wic_substitution, recs=0, latency=4.31ms
2025-10-26 00:09:41,091 - EACAgent.Guardrails - WARNING - High price burden ratio: 63.759 > 0.3
2025-10-26 00:09:41,091 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,095 - EACAgent.Guardrails - WARNING - High price burden ratio: 195.313 > 0.3
2025-10-26 00:09:41,095 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,098 - EACAgent.Guardrails - WARNING - High price burden ratio: 142.304 > 0.3
2025-10-26 00:09:41,098 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:41,098 - EACAgent - INFO - Checkout processed: user=user_79, policy=snap_wic_substitution, recs=0, latency=2.72ms
2025-10-26 00:09:41,102 - EACAgent.Guardrails - WARNING - High price burden ratio: 495.190 > 0.3
2025-10-26 00:09:41,102 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:41,102 - EACAgent - INFO - Checkout processed: user=user_80, policy=snap_wic_substitution, recs=1, latency=4.38ms
2025-10-26 00:09:41,108 - EACAgent.Guardrails - WARNING - High price burden ratio: 372.120 > 0.3
2025-10-26 00:09:41,108 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,112 - EACAgent.Guardrails - WARNING - High price burden ratio: 181.526 > 0.3
2025-10-26 00:09:41,112 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:41,113 - EACAgent - INFO - Checkout processed: user=user_82, policy=snap_wic_substitution, recs=0, latency=4.44ms
2025-10-26 00:09:41,117 - EACAgent.Guardrails - WARNING - High price burden ratio: 154.835 > 0.3
2025-10-26 00:09:41,117 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,120 - EACAgent.Guardrails - WARNING - High price burden ratio: 231.889 > 0.3
2025-10-26 00:09:41,121 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,124 - EACAgent.Guardrails - WARNING - High price burden ratio: 118.715 > 0.3
2025-10-26 00:09:41,124 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,129 - EACAgent.Guardrails - WARNING - High price burden ratio: 160.189 > 0.3
2025-10-26 00:09:41,129 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:41,129 - EACAgent - INFO - Checkout processed: user=user_86, policy=snap_wic_substitution, recs=0, latency=4.36ms
2025-10-26 00:09:41,133 - EACAgent.Guardrails - WARNING - High price burden ratio: 108.030 > 0.3
2025-10-26 00:09:41,134 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:41,134 - EACAgent - INFO - Checkout processed: user=user_87, policy=snap_wic_substitution, recs=0, latency=4.87ms
2025-10-26 00:09:41,138 - EACAgent.Guardrails - WARNING - High price burden ratio: 212.494 > 0.3
2025-10-26 00:09:41,138 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:41,138 - EACAgent - INFO - Checkout processed: user=user_88, policy=snap_wic_substitution, recs=1, latency=4.18ms
2025-10-26 00:09:41,142 - EACAgent.Guardrails - WARNING - High price burden ratio: 294.471 > 0.3
2025-10-26 00:09:41,142 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:41,142 - EACAgent - INFO - Checkout processed: user=user_89, policy=snap_wic_substitution, recs=0, latency=3.52ms
2025-10-26 00:09:41,147 - EACAgent.Guardrails - WARNING - High price burden ratio: 310.703 > 0.3
2025-10-26 00:09:41,147 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:41,147 - EACAgent - INFO - Checkout processed: user=user_90, policy=snap_wic_substitution, recs=0, latency=4.80ms
2025-10-26 00:09:41,151 - EACAgent.Guardrails - WARNING - High price burden ratio: 179.545 > 0.3
2025-10-26 00:09:41,152 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:41,152 - EACAgent - INFO - Checkout processed: user=user_91, policy=snap_wic_substitution, recs=0, latency=4.30ms
2025-10-26 00:09:41,154 - EACAgent.Guardrails - WARNING - High price burden ratio: 206.749 > 0.3
2025-10-26 00:09:41,154 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:41,154 - EACAgent - INFO - Checkout processed: user=user_92, policy=snap_wic_substitution, recs=0, latency=2.48ms
2025-10-26 00:09:41,158 - EACAgent.Guardrails - WARNING - High price burden ratio: 375.483 > 0.3
2025-10-26 00:09:41,158 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,162 - EACAgent.Guardrails - WARNING - High price burden ratio: 366.955 > 0.3
2025-10-26 00:09:41,162 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,166 - EACAgent.Guardrails - WARNING - High price burden ratio: 245.199 > 0.3
2025-10-26 00:09:41,166 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:41,166 - EACAgent - INFO - Checkout processed: user=user_95, policy=snap_wic_substitution, recs=0, latency=3.73ms
2025-10-26 00:09:41,170 - EACAgent.Guardrails - WARNING - High price burden ratio: 356.833 > 0.3
2025-10-26 00:09:41,170 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,172 - EACAgent.Guardrails - WARNING - High price burden ratio: 253.821 > 0.3
2025-10-26 00:09:41,172 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,176 - EACAgent.Guardrails - WARNING - High price burden ratio: 185.029 > 0.3
2025-10-26 00:09:41,176 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 2 SNAP/WIC recommendations
2025-10-26 00:09:41,176 - EACAgent - INFO - Checkout processed: user=user_98, policy=snap_wic_substitution, recs=2, latency=3.75ms
2025-10-26 00:09:41,180 - EACAgent.Guardrails - WARNING - High price burden ratio: 135.116 > 0.3
2025-10-26 00:09:41,181 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,187 - EACAgent.Guardrails - WARNING - High price burden ratio: 200.959 > 0.3
2025-10-26 00:09:41,187 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:41,187 - EACAgent - INFO - Checkout processed: user=user_0, policy=snap_wic_substitution, recs=0, latency=5.53ms
2025-10-26 00:09:41,196 - EACAgent.Guardrails - WARNING - High price burden ratio: 152.246 > 0.3
2025-10-26 00:09:41,196 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,204 - EACAgent.Guardrails - WARNING - High price burden ratio: 329.974 > 0.3
2025-10-26 00:09:41,204 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:41,204 - EACAgent - INFO - Checkout processed: user=user_2, policy=snap_wic_substitution, recs=0, latency=7.68ms
2025-10-26 00:09:41,209 - EACAgent.Guardrails - WARNING - High price burden ratio: 430.325 > 0.3
2025-10-26 00:09:41,209 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,213 - EACAgent.Guardrails - WARNING - High price burden ratio: 144.417 > 0.3
2025-10-26 00:09:41,213 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,217 - EACAgent.Guardrails - WARNING - High price burden ratio: 208.132 > 0.3
2025-10-26 00:09:41,217 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,220 - EACAgent.Guardrails - WARNING - High price burden ratio: 174.747 > 0.3
2025-10-26 00:09:41,220 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,224 - EACAgent.Guardrails - WARNING - High price burden ratio: 599.786 > 0.3
2025-10-26 00:09:41,224 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,229 - EACAgent.Guardrails - WARNING - High price burden ratio: 139.401 > 0.3
2025-10-26 00:09:41,230 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,234 - EACAgent.Guardrails - WARNING - High price burden ratio: 231.884 > 0.3
2025-10-26 00:09:41,234 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,237 - EACAgent.Guardrails - WARNING - High price burden ratio: 256.817 > 0.3
2025-10-26 00:09:41,237 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,239 - EACAgent.Guardrails - WARNING - High price burden ratio: 453.646 > 0.3
2025-10-26 00:09:41,240 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,246 - EACAgent.Guardrails - WARNING - High price burden ratio: 211.729 > 0.3
2025-10-26 00:09:41,246 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,252 - EACAgent.Guardrails - WARNING - High price burden ratio: 347.602 > 0.3
2025-10-26 00:09:41,253 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,255 - EACAgent.Guardrails - WARNING - High price burden ratio: 430.237 > 0.3
2025-10-26 00:09:41,255 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:41,255 - EACAgent - INFO - Checkout processed: user=user_14, policy=snap_wic_substitution, recs=1, latency=2.67ms
2025-10-26 00:09:41,259 - EACAgent.Guardrails - WARNING - High price burden ratio: 229.573 > 0.3
2025-10-26 00:09:41,260 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,264 - EACAgent.Guardrails - WARNING - High price burden ratio: 394.621 > 0.3
2025-10-26 00:09:41,264 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,268 - EACAgent.Guardrails - WARNING - High price burden ratio: 182.159 > 0.3
2025-10-26 00:09:41,268 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,271 - EACAgent.Guardrails - WARNING - High price burden ratio: 183.576 > 0.3
2025-10-26 00:09:41,271 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,275 - EACAgent.Guardrails - WARNING - High price burden ratio: 181.130 > 0.3
2025-10-26 00:09:41,275 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,279 - EACAgent.Guardrails - WARNING - High price burden ratio: 225.005 > 0.3
2025-10-26 00:09:41,280 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:41,280 - EACAgent - INFO - Checkout processed: user=user_20, policy=snap_wic_substitution, recs=1, latency=4.63ms
2025-10-26 00:09:41,284 - EACAgent.Guardrails - WARNING - High price burden ratio: 74.369 > 0.3
2025-10-26 00:09:41,284 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,287 - EACAgent.Guardrails - WARNING - High price burden ratio: 294.489 > 0.3
2025-10-26 00:09:41,287 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,295 - EACAgent.Guardrails - WARNING - High price burden ratio: 390.964 > 0.3
2025-10-26 00:09:41,296 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 2 SNAP/WIC recommendations
2025-10-26 00:09:41,296 - EACAgent - INFO - Checkout processed: user=user_23, policy=snap_wic_substitution, recs=2, latency=8.66ms
2025-10-26 00:09:41,302 - EACAgent.Guardrails - WARNING - High price burden ratio: 139.070 > 0.3
2025-10-26 00:09:41,302 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:41,302 - EACAgent - INFO - Checkout processed: user=user_24, policy=snap_wic_substitution, recs=1, latency=6.09ms
2025-10-26 00:09:41,307 - EACAgent.Guardrails - WARNING - High price burden ratio: 216.453 > 0.3
2025-10-26 00:09:41,307 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,314 - EACAgent.Guardrails - WARNING - High price burden ratio: 200.704 > 0.3
2025-10-26 00:09:41,314 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:41,314 - EACAgent - INFO - Checkout processed: user=user_26, policy=snap_wic_substitution, recs=1, latency=6.06ms
2025-10-26 00:09:41,317 - EACAgent.Guardrails - WARNING - High price burden ratio: 137.116 > 0.3
2025-10-26 00:09:41,317 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:41,317 - EACAgent - INFO - Checkout processed: user=user_27, policy=snap_wic_substitution, recs=1, latency=3.16ms
2025-10-26 00:09:41,320 - EACAgent.Guardrails - WARNING - High price burden ratio: 293.324 > 0.3
2025-10-26 00:09:41,320 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,322 - EACAgent.Guardrails - WARNING - High price burden ratio: 270.061 > 0.3
2025-10-26 00:09:41,322 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:41,322 - EACAgent - INFO - Checkout processed: user=user_29, policy=snap_wic_substitution, recs=0, latency=2.70ms
2025-10-26 00:09:41,325 - EACAgent.Guardrails - WARNING - High price burden ratio: 130.894 > 0.3
2025-10-26 00:09:41,325 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,330 - EACAgent.Guardrails - WARNING - High price burden ratio: 224.159 > 0.3
2025-10-26 00:09:41,330 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,334 - EACAgent.Guardrails - WARNING - High price burden ratio: 288.012 > 0.3
2025-10-26 00:09:41,334 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,338 - EACAgent.Guardrails - WARNING - High price burden ratio: 243.898 > 0.3
2025-10-26 00:09:41,338 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,341 - EACAgent.Guardrails - WARNING - High price burden ratio: 425.731 > 0.3
2025-10-26 00:09:41,342 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:41,342 - EACAgent - INFO - Checkout processed: user=user_34, policy=snap_wic_substitution, recs=0, latency=3.52ms
2025-10-26 00:09:41,349 - EACAgent.Guardrails - WARNING - High price burden ratio: 374.907 > 0.3
2025-10-26 00:09:41,349 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:41,349 - EACAgent - INFO - Checkout processed: user=user_35, policy=snap_wic_substitution, recs=0, latency=7.52ms
2025-10-26 00:09:41,352 - EACAgent.Guardrails - WARNING - High price burden ratio: 192.492 > 0.3
2025-10-26 00:09:41,352 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,354 - EACAgent.Guardrails - WARNING - High price burden ratio: 245.793 > 0.3
2025-10-26 00:09:41,355 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 2 SNAP/WIC recommendations
2025-10-26 00:09:41,355 - EACAgent - INFO - Checkout processed: user=user_37, policy=snap_wic_substitution, recs=2, latency=2.58ms
2025-10-26 00:09:41,358 - EACAgent.Guardrails - WARNING - High price burden ratio: 233.088 > 0.3
2025-10-26 00:09:41,359 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,363 - EACAgent.Guardrails - WARNING - High price burden ratio: 453.910 > 0.3
2025-10-26 00:09:41,363 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,367 - EACAgent.Guardrails - WARNING - High price burden ratio: 230.717 > 0.3
2025-10-26 00:09:41,367 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,369 - EACAgent.Guardrails - WARNING - High price burden ratio: 332.568 > 0.3
2025-10-26 00:09:41,370 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:41,370 - EACAgent - INFO - Checkout processed: user=user_41, policy=snap_wic_substitution, recs=1, latency=2.65ms
2025-10-26 00:09:41,372 - EACAgent.Guardrails - WARNING - High price burden ratio: 278.084 > 0.3
2025-10-26 00:09:41,372 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,378 - EACAgent.Guardrails - WARNING - High price burden ratio: 296.207 > 0.3
2025-10-26 00:09:41,379 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:41,379 - EACAgent - INFO - Checkout processed: user=user_43, policy=snap_wic_substitution, recs=0, latency=6.41ms
2025-10-26 00:09:41,386 - EACAgent.Guardrails - WARNING - High price burden ratio: 85.371 > 0.3
2025-10-26 00:09:41,386 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,391 - EACAgent.Guardrails - WARNING - High price burden ratio: 434.402 > 0.3
2025-10-26 00:09:41,392 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:41,392 - EACAgent - INFO - Checkout processed: user=user_45, policy=snap_wic_substitution, recs=0, latency=5.86ms
2025-10-26 00:09:41,397 - EACAgent.Guardrails - WARNING - High price burden ratio: 116.953 > 0.3
2025-10-26 00:09:41,397 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,400 - EACAgent.Guardrails - WARNING - High price burden ratio: 272.597 > 0.3
2025-10-26 00:09:41,400 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,403 - EACAgent.Guardrails - WARNING - High price burden ratio: 135.491 > 0.3
2025-10-26 00:09:41,403 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,405 - EACAgent.Guardrails - WARNING - High price burden ratio: 260.626 > 0.3
2025-10-26 00:09:41,405 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:41,405 - EACAgent - INFO - Checkout processed: user=user_49, policy=snap_wic_substitution, recs=0, latency=2.53ms
2025-10-26 00:09:41,409 - EACAgent.Guardrails - WARNING - High price burden ratio: 324.257 > 0.3
2025-10-26 00:09:41,409 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,416 - EACAgent.Guardrails - WARNING - High price burden ratio: 149.903 > 0.3
2025-10-26 00:09:41,416 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:41,417 - EACAgent - INFO - Checkout processed: user=user_51, policy=snap_wic_substitution, recs=0, latency=7.68ms
2025-10-26 00:09:41,420 - EACAgent.Guardrails - WARNING - High price burden ratio: 257.268 > 0.3
2025-10-26 00:09:41,420 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,424 - EACAgent.Guardrails - WARNING - High price burden ratio: 371.645 > 0.3
2025-10-26 00:09:41,424 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,426 - EACAgent.Guardrails - WARNING - High price burden ratio: 216.967 > 0.3
2025-10-26 00:09:41,426 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,430 - EACAgent.Guardrails - WARNING - High price burden ratio: 236.959 > 0.3
2025-10-26 00:09:41,430 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,433 - EACAgent.Guardrails - WARNING - High price burden ratio: 261.942 > 0.3
2025-10-26 00:09:41,433 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,438 - EACAgent.Guardrails - WARNING - High price burden ratio: 286.787 > 0.3
2025-10-26 00:09:41,438 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,446 - EACAgent.Guardrails - WARNING - High price burden ratio: 127.010 > 0.3
2025-10-26 00:09:41,446 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,450 - EACAgent.Guardrails - WARNING - High price burden ratio: 402.855 > 0.3
2025-10-26 00:09:41,451 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,453 - EACAgent.Guardrails - WARNING - High price burden ratio: 329.800 > 0.3
2025-10-26 00:09:41,453 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,458 - EACAgent.Guardrails - WARNING - High price burden ratio: 225.339 > 0.3
2025-10-26 00:09:41,458 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,463 - EACAgent.Guardrails - WARNING - High price burden ratio: 282.156 > 0.3
2025-10-26 00:09:41,463 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,471 - EACAgent.Guardrails - WARNING - High price burden ratio: 348.087 > 0.3
2025-10-26 00:09:41,471 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:41,471 - EACAgent - INFO - Checkout processed: user=user_63, policy=snap_wic_substitution, recs=1, latency=8.20ms
2025-10-26 00:09:41,475 - EACAgent.Guardrails - WARNING - High price burden ratio: 202.049 > 0.3
2025-10-26 00:09:41,475 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,479 - EACAgent.Guardrails - WARNING - High price burden ratio: 238.976 > 0.3
2025-10-26 00:09:41,479 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,483 - EACAgent.Guardrails - WARNING - High price burden ratio: 424.518 > 0.3
2025-10-26 00:09:41,483 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,487 - EACAgent.Guardrails - WARNING - High price burden ratio: 102.870 > 0.3
2025-10-26 00:09:41,487 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,496 - EACAgent.Guardrails - WARNING - High price burden ratio: 382.598 > 0.3
2025-10-26 00:09:41,496 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,500 - EACAgent.Guardrails - WARNING - High price burden ratio: 156.820 > 0.3
2025-10-26 00:09:41,500 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,504 - EACAgent.Guardrails - WARNING - High price burden ratio: 145.206 > 0.3
2025-10-26 00:09:41,505 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:41,505 - EACAgent - INFO - Checkout processed: user=user_70, policy=snap_wic_substitution, recs=1, latency=4.78ms
2025-10-26 00:09:41,513 - EACAgent.Guardrails - WARNING - High price burden ratio: 150.686 > 0.3
2025-10-26 00:09:41,513 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:41,513 - EACAgent - INFO - Checkout processed: user=user_71, policy=snap_wic_substitution, recs=0, latency=7.82ms
2025-10-26 00:09:41,517 - EACAgent.Guardrails - WARNING - High price burden ratio: 165.299 > 0.3
2025-10-26 00:09:41,517 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:41,518 - EACAgent - INFO - Checkout processed: user=user_72, policy=snap_wic_substitution, recs=1, latency=4.17ms
2025-10-26 00:09:41,521 - EACAgent.Guardrails - WARNING - High price burden ratio: 269.969 > 0.3
2025-10-26 00:09:41,522 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,525 - EACAgent.Guardrails - WARNING - High price burden ratio: 488.758 > 0.3
2025-10-26 00:09:41,526 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 2 SNAP/WIC recommendations
2025-10-26 00:09:41,526 - EACAgent - INFO - Checkout processed: user=user_74, policy=snap_wic_substitution, recs=2, latency=3.90ms
2025-10-26 00:09:41,529 - EACAgent.Guardrails - WARNING - High price burden ratio: 383.042 > 0.3
2025-10-26 00:09:41,529 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,533 - EACAgent.Guardrails - WARNING - High price burden ratio: 170.388 > 0.3
2025-10-26 00:09:41,534 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:41,534 - EACAgent - INFO - Checkout processed: user=user_76, policy=snap_wic_substitution, recs=0, latency=4.40ms
2025-10-26 00:09:41,537 - EACAgent.Guardrails - WARNING - High price burden ratio: 63.759 > 0.3
2025-10-26 00:09:41,537 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,542 - EACAgent.Guardrails - WARNING - High price burden ratio: 195.313 > 0.3
2025-10-26 00:09:41,542 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,546 - EACAgent.Guardrails - WARNING - High price burden ratio: 142.304 > 0.3
2025-10-26 00:09:41,546 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:41,546 - EACAgent - INFO - Checkout processed: user=user_79, policy=snap_wic_substitution, recs=0, latency=3.82ms
2025-10-26 00:09:41,550 - EACAgent.Guardrails - WARNING - High price burden ratio: 495.190 > 0.3
2025-10-26 00:09:41,550 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:41,550 - EACAgent - INFO - Checkout processed: user=user_80, policy=snap_wic_substitution, recs=1, latency=4.43ms
2025-10-26 00:09:41,555 - EACAgent.Guardrails - WARNING - High price burden ratio: 372.120 > 0.3
2025-10-26 00:09:41,555 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,559 - EACAgent.Guardrails - WARNING - High price burden ratio: 181.526 > 0.3
2025-10-26 00:09:41,559 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:41,559 - EACAgent - INFO - Checkout processed: user=user_82, policy=snap_wic_substitution, recs=0, latency=4.20ms
2025-10-26 00:09:41,563 - EACAgent.Guardrails - WARNING - High price burden ratio: 154.835 > 0.3
2025-10-26 00:09:41,563 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,568 - EACAgent.Guardrails - WARNING - High price burden ratio: 231.889 > 0.3
2025-10-26 00:09:41,568 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,572 - EACAgent.Guardrails - WARNING - High price burden ratio: 118.715 > 0.3
2025-10-26 00:09:41,572 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,576 - EACAgent.Guardrails - WARNING - High price burden ratio: 160.189 > 0.3
2025-10-26 00:09:41,577 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:41,577 - EACAgent - INFO - Checkout processed: user=user_86, policy=snap_wic_substitution, recs=0, latency=4.51ms
2025-10-26 00:09:41,582 - EACAgent.Guardrails - WARNING - High price burden ratio: 108.030 > 0.3
2025-10-26 00:09:41,582 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:41,582 - EACAgent - INFO - Checkout processed: user=user_87, policy=snap_wic_substitution, recs=0, latency=5.20ms
2025-10-26 00:09:41,585 - EACAgent.Guardrails - WARNING - High price burden ratio: 212.494 > 0.3
2025-10-26 00:09:41,585 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 1 SNAP/WIC recommendations
2025-10-26 00:09:41,585 - EACAgent - INFO - Checkout processed: user=user_88, policy=snap_wic_substitution, recs=1, latency=2.79ms
2025-10-26 00:09:41,588 - EACAgent.Guardrails - WARNING - High price burden ratio: 294.471 > 0.3
2025-10-26 00:09:41,588 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:41,588 - EACAgent - INFO - Checkout processed: user=user_89, policy=snap_wic_substitution, recs=0, latency=2.88ms
2025-10-26 00:09:41,591 - EACAgent.Guardrails - WARNING - High price burden ratio: 310.703 > 0.3
2025-10-26 00:09:41,592 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:41,592 - EACAgent - INFO - Checkout processed: user=user_90, policy=snap_wic_substitution, recs=0, latency=3.31ms
2025-10-26 00:09:41,596 - EACAgent.Guardrails - WARNING - High price burden ratio: 179.545 > 0.3
2025-10-26 00:09:41,597 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:41,597 - EACAgent - INFO - Checkout processed: user=user_91, policy=snap_wic_substitution, recs=0, latency=4.63ms
2025-10-26 00:09:41,602 - EACAgent.Guardrails - WARNING - High price burden ratio: 206.749 > 0.3
2025-10-26 00:09:41,603 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:41,603 - EACAgent - INFO - Checkout processed: user=user_92, policy=snap_wic_substitution, recs=0, latency=5.62ms
2025-10-26 00:09:41,606 - EACAgent.Guardrails - WARNING - High price burden ratio: 375.483 > 0.3
2025-10-26 00:09:41,607 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,612 - EACAgent.Guardrails - WARNING - High price burden ratio: 366.955 > 0.3
2025-10-26 00:09:41,612 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,616 - EACAgent.Guardrails - WARNING - High price burden ratio: 245.199 > 0.3
2025-10-26 00:09:41,616 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 0 SNAP/WIC recommendations
2025-10-26 00:09:41,616 - EACAgent - INFO - Checkout processed: user=user_95, policy=snap_wic_substitution, recs=0, latency=3.80ms
2025-10-26 00:09:41,620 - EACAgent.Guardrails - WARNING - High price burden ratio: 356.833 > 0.3
2025-10-26 00:09:41,620 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,622 - EACAgent.Guardrails - WARNING - High price burden ratio: 253.821 > 0.3
2025-10-26 00:09:41,622 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
2025-10-26 00:09:41,628 - EACAgent.Guardrails - WARNING - High price burden ratio: 185.029 > 0.3
2025-10-26 00:09:41,629 - EACAgent.Policy.SNAPWICSubstitutionPolicy - INFO - Generated 2 SNAP/WIC recommendations
2025-10-26 00:09:41,629 - EACAgent - INFO - Checkout processed: user=user_98, policy=snap_wic_substitution, recs=2, latency=6.37ms
2025-10-26 00:09:41,633 - EACAgent.Guardrails - WARNING - High price burden ratio: 135.116 > 0.3
2025-10-26 00:09:41,633 - EACAgent - WARNING - Guardrail violation: SNAP/WIC policy requires SNAP payment or high food insecurity
